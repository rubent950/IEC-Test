<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IEC 62443 Quiz</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light bluish-gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* Ensures the body takes full viewport height */
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto; /* Prevent overflow if content is too long */
        }
        .quiz-container, .mode-selection-screen, .quiz-end-screen {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 2.5rem; /* More padding */
            max-width: 95%; /* Adapts better to larger screens like S24 Ultra */
            width: 100%;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Space between sections */
            flex-grow: 1; /* Allow container to grow to fill available space */
            overflow-y: auto; /* Add scrolling if content exceeds container */
        }
        /* Specific adjustment for larger screens (tablets/desktops) */
        @media (min-width: 768px) {
            .quiz-container, .mode-selection-screen, .quiz-end-screen {
                max-width: 800px; /* Maintain a max-width for desktops */
            }
        }

        .quiz-container {
            display: none; /* Hidden by default, shown after mode selection */
        }
        .mode-selection-screen {
            display: flex; /* Shown by default */
            align-items: center;
            justify-content: center;
        }
        .question-text {
            font-size: 1.75rem; /* Larger question text for S24 Ultra */
            font-weight: 600;
            color: #2d3748; /* Darker text for question */
            margin-bottom: 1.5rem;
            line-height: 1.4; /* Improved line height for readability */
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 1rem; /* Space between options */
            margin-bottom: 1.5rem;
        }
        .option-label {
            display: flex;
            align-items: center;
            background-color: #edf2f7; /* Light gray for options */
            padding: 1.25rem 1.5rem; /* Increased padding for larger touch targets */
            border-radius: 0.75rem; /* Rounded options */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: 1px solid #cbd5e0; /* Subtle border */
            text-align: left; /* Align option text to the left */
            font-size: 1.1rem; /* Larger option text for S24 Ultra */
            line-height: 1.5; /* Improved line height */
        }
        .option-label:hover {
            background-color: #e2e8f0; /* Slightly darker on hover */
            transform: translateY(-2px); /* Slight lift on hover */
        }
        .option-label input[type="radio"] {
            margin-right: 1rem;
            accent-color: #4A7C4A; /* Green accent for radio button */
            transform: scale(1.2); /* Slightly larger radio buttons */
        }
        .option-label.correct {
            background-color: #d4edda; /* Light green for correct */
            border-color: #28a745;
        }
        .option-label.incorrect {
            background-color: #f8d7da; /* Light red for incorrect */
            border-color: #dc3545;
        }
        .feedback-message {
            font-size: 1.3rem; /* Larger feedback message */
            font-weight: 500;
            margin-top: 1rem;
            min-height: 2rem; /* Reserve space */
        }
        .feedback-message.correct {
            color: #28a745; /* Green for correct */
        }
        .feedback-message.incorrect {
            color: #dc3545; /* Red for incorrect */
        }
        .explanation-text {
            font-size: 1.1rem; /* Larger explanation text */
            color: #4a5568;
            margin-top: 0.75rem; /* Increased margin */
            text-align: left;
            padding: 0 1rem;
            line-height: 1.6; /* Improved line height */
        }
        .action-button {
            background-color: #4A7C4A; /* Green button */
            color: white;
            padding: 0.85rem 1.75rem; /* Increased padding for larger buttons */
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 1.1rem; /* Larger button text */
        }
        .action-button:hover {
            background-color: #3A6C3A; /* Darker green on hover */
            transform: translateY(-1px);
        }
        .action-button:disabled {
            background-color: #a0aec0; /* Gray when disabled */
            cursor: not-allowed;
            box-shadow: none;
        }
        .score-display {
            font-size: 1.2rem; /* Larger score display */
            font-weight: 500;
            color: #4a5568;
            margin-top: 1rem;
        }
        .quiz-end-screen {
            display: none; /* Hidden by default */
        }
        .mode-selection {
            margin-bottom: 2rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
        }
        .mode-button {
            background-color: #166534; /* Tailwind green-800 */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .mode-button.active {
            background-color: #22c55e; /* Tailwind green-500 */
        }
        .timer-display {
            font-size: 1.3rem; /* Larger timer display */
            font-weight: 600;
            color: #e53e3e; /* Red for timer */
            margin-bottom: 1rem;
        }
        .logo {
            margin-bottom: 1.5rem;
            max-width: 200px; /* Adjust size as needed */
            height: auto;
            border-radius: 0.5rem; /* Slight rounding for the logo */
        }
        .current-mode-display {
            font-size: 1.2rem; /* Larger mode display */
            font-weight: 600;
            color: #4A7C4A; /* Green for the mode display */
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div id="mode-selection-screen" class="mode-selection-screen">
        <div class="text-center">
            <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">IEC 62443 Quiz</h1>
            <p class="text-gray-600 mb-6">Test your knowledge of IEC 62443 standards!</p>
            <p class="text-xl text-gray-700 mb-8">Choose a mode to begin:</p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button id="select-practice-mode-btn" class="action-button">Practice Mode (Infinite)</button>
                <button id="select-exam-mode-btn" class="action-button">Exam Mode (50 Questions, 2 Hours)</button>
                <button id="select-listen-mode-btn" class="action-button">Listen Mode</button>
            </div>
        </div>
    </div>

    <div id="quiz-container" class="quiz-container">
        <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">IEC 62443 Quiz</h1>
        <p class="text-gray-600 mb-6">Test your knowledge of IEC 62443 standards!</p>

        <div id="current-mode-display" class="current-mode-display"></div>
        <div id="timer-display" class="timer-display hidden"></div>

        <div class="question-text" id="question-text"></div>
        <div class="options-container" id="options-container">
            <!-- Options are loaded here by JavaScript -->
        </div>

        <div id="feedback-message" class="feedback-message"></div>
        <div id="explanation-text" class="explanation-text"></div>


        <div class="flex flex-col sm:flex-row justify-center gap-4">
            <button id="submit-btn" class="action-button">Submit Answer</button>
            <button id="next-btn" class="action-button" disabled>Next Question</button>
            <button id="abort-btn" class="action-button bg-red-500 hover:bg-red-700">Abort</button>
        </div>

        <div class="score-display">
            Question <span id="current-q-num">0</span> of <span id="total-q-num">0</span> | Score: <span id="score">0</span>
        </div>
    </div>

    <div id="quiz-end-screen" class="quiz-end-screen">
        <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
        <h2>Quiz Completed!</h2>
        <p>Your final score is: <span id="final-score" class="font-bold text-green-600 text-2xl"></span> / <span id="final-total" class="font-bold text-green-600 text-2xl"></span></p>
        <button id="restart-btn" class="action-button">Restart Quiz</button>
    </div>

    <script>
        const allQuestions = [
            // Section 1: Fundamental Concepts (30 questions)
            {
                question: "What is the primary purpose of the IEC 62443 series of standards?",
                options: [
                    "To standardize IT security protocols for office environments.",
                    "To provide a risk-based framework for securing industrial automation and control systems (IACS).",
                    "To establish guidelines for the development of new industrial control hardware.",
                    "To regulate consumer electronics with embedded industrial components for smart homes."
                ],
                answer: "To provide a risk-based framework for securing industrial automation and control systems (IACS).",
                explanation: "The IEC 62443 series is specifically designed for cybersecurity in industrial automation and control systems (IACS), focusing on a risk-based approach, distinguishing it from general IT or consumer electronics standards."
            },
            {
                question: "For which industry is the IEC 62443 series specifically designed?",
                options: [
                    "Healthcare Information Technology (IT) infrastructure.",
                    "Global Financial Services and banking systems.",
                    "Industrial Automation and Control Systems (IACS).",
                    "Advanced Telecommunications networks and mobile infrastructure."
                ],
                answer: "Industrial Automation and Control Systems (IACS).",
                explanation: "The IEC 62443 standards specifically address the unique security challenges within industrial automation and control systems, such as SCADA, DCS, and PLCs, which are part of Operational Technology (OT)."
            },
            {
                question: "What does IACS stand for in the context of IEC 62443?",
                options: [
                    "International Aviation Control Systems.",
                    "Integrated Asset Compliance Software.",
                    "Industrial Automation and Control Systems.",
                    "Intelligent Access Control Solutions."
                ],
                answer: "Industrial Automation and Control Systems.",
                explanation: "IACS is the acronym used within the IEC 62443 standards to refer to the systems being governed, such as SCADA, DCS, and PLCs, which are part of Operational Technology (OT)."
            },
            {
                question: "Name the four main parts into which the IEC 62443 series is divided.",
                options: [
                    "Hardware, Software, Network, and Data Management.",
                    "General, Policies & Procedures, System, and Component.",
                    "Design, Development, Testing, and Implementation.",
                    "Risk Assessment, Threat Intelligence, Vulnerability, and Controls."
                ],
                answer: "General, Policies & Procedures, System, and Component.",
                explanation: "The IEC 62443 series is structured into four main parts: General (1-x), Policies and Procedures (2-x), System Requirements (3-x), and Component Requirements (4-x)."
            },
            {
                question: "What is a Zone in IEC 62443 terminology?",
                options: [
                    "A designated physical area within a building.",
                    "A logical or physical grouping of assets sharing common security requirements.",
                    "A predefined pathway for emergency exits.",
                    "A specific type of network cabling."
                ],
                answer: "A logical or physical grouping of assets sharing common security requirements.",
                explanation: "Zones are fundamental for network segmentation in IEC 62443, grouping assets with similar security needs to enable targeted security controls and limit the impact of a breach."
            },
            {
                question: "What is a Conduit in IEC 62443 terminology?",
                options: [
                    "A protective casing for electrical wiring.",
                    "A logical or physical grouping of communication paths connecting different Zones.",
                    "A type of advanced industrial sensor.",
                    "A secure, encrypted data storage device."
                ],
                answer: "A logical or physical grouping of communication paths connecting different Zones.",
                explanation: "Conduits regulate the communication between Zones and ensure that traffic occurs in a controlled and secure manner, often involving firewalls or other security devices to enforce policies."
            },
            {
                question: "What is 'Defense-in-Depth' as applied by IEC 62443?",
                options: [
                    "Relying exclusively on a single perimeter security measure.",
                    "Implementing multiple, overlapping layers of security controls.",
                    "Securing only the outermost perimeter of a network.",
                    "Distributing security responsibilities among external partners."
                ],
                answer: "Implementing multiple, overlapping layers of security controls.",
                explanation: "Defense-in-Depth involves applying multiple, overlapping security mechanisms so that if one layer fails, other layers still provide protection, creating a more resilient security posture."
            },
            {
                question: "What is a Security Level (SL) in IEC 62443?",
                options: [
                    "The physical elevation of security infrastructure.",
                    "The total number of security personnel.",
                    "The required rigor and effectiveness of security controls.",
                    "The maximum allowable duration for security log retention."
                ],
                answer: "The required rigor and effectiveness of security controls.",
                explanation: "Security Levels (SLs) define the robustness of security controls needed to protect against specific attackers and their capabilities, ranging from accidental violation to sophisticated attacks."
            },
            {
                question: "How many Security Levels (SLs) are defined in IEC 62443?",
                options: [
                    "Two (SL1, SL2).",
                    "Four (SL1, SL2, SL3, SL4).",
                    "Six (SL0 to SL5).",
                    "Eight (SL1 to SL8)."
                ],
                answer: "Four (SL1, SL2, SL3, SL4).",
                explanation: "There are four security levels defined in IEC 62443: SL1 (prevention of accidental violation), SL2 (prevention of intentional violation with simple means), SL3 (prevention of intentional violation with moderate means), and SL4 (prevention of intentional violation with extended means)."
            },
            {
                question: "What is the key distinction between SL-T and SL-A?",
                options: [
                    "SL-T refers to hardware, SL-A to software.",
                    "SL-T is desired; SL-A is achieved.",
                    "SL-T is for external threats, SL-A for internal.",
                    "SL-T is annual, SL-A is monthly."
                ],
                answer: "SL-T is desired; SL-A is achieved.",
                explanation: "SL-T is the desired or required security level based on risk assessment, while SL-A is the actually implemented and verified security level."
            },
            {
                question: "Which part of IEC 62443-1-x defines general concepts and terminology?",
                options: [
                    "IEC 62443-1-1: Terminology, Concepts, and Models.",
                    "IEC 62443-1-2: Master Cybersecurity Program Requirements.",
                    "IEC 62443-1-3: System Security Requirements.",
                    "IEC 62443-1-4: Component Security Requirements."
                ],
                answer: "IEC 62443-1-1: Terminology, Concepts, and Models.",
                explanation: "IEC 62443-1-1 'Terminology, concepts and models' is the fundamental document that establishes the basic principles and vocabulary for the entire series."
            },
            {
                question: "What is the purpose of the 'Security Lifecycle' in IEC 62443?",
                options: [
                    "To define the operational lifespan of security hardware.",
                    "To outline continuous risk management from design to decommissioning.",
                    "To specify maximum duration for security audits.",
                    "To regulate only software development cycles."
                ],
                answer: "To outline continuous risk management from design to decommissioning.",
                explanation: "The security lifecycle emphasizes that cybersecurity is a continuous process encompassing all phases of an IACS, from conception to decommissioning, ensuring ongoing risk management."
            },
            {
                question: "In IEC 62443, what does 'IACS' primarily refer to?",
                options: [
                    "Information Access Control Systems.",
                    "Industrial Asset Compliance Software.",
                    "Industrial Automation and Control Systems.",
                    "International Audit and Certification Standards."
                ],
                answer: "Industrial Automation and Control Systems.",
                explanation: "IACS is the central term in the IEC 62443 standards and encompasses all systems used for automating and controlling industrial processes, falling under Operational Technology (OT)."
            },
            {
                question: "Which of the following is a core principle of IEC 62443?",
                options: [
                    "Strictly compliance-driven security.",
                    "Technology-first security.",
                    "Risk-based security.",
                    "Cost minimization security."
                ],
                answer: "Risk-based security.",
                explanation: "The IEC 62443 standards are heavily risk-based, meaning that security measures are determined by the identified risks and desired security levels, ensuring efficient and effective resource allocation."
            },
            {
                question: "What is the relationship between Zones and Conduits?",
                options: [
                    "Zones are physical, Conduits are logical segments.",
                    "Zones define communication, Conduits establish policies.",
                    "Zones group assets; Conduits are secured paths between them.",
                    "Zones and Conduits are interchangeable."
                ],
                answer: "Zones group assets; Conduits are secured paths between them.",
                explanation: "Zones and Conduits together form the basis for IACS security architecture, with Zones being logical groupings of assets and Conduits being the secured communication paths between them, enforcing access control and monitoring."
            },
            {
                question: "What does SL-0 mean in terms of Security Levels?",
                options: [
                    "Highest possible security level.",
                    "No specific security requirements beyond typical industrial practices.",
                    "Minimum legally required security level.",
                    "Exclusively for test environments."
                ],
                answer: "No specific security requirements beyond typical industrial practices.",
                explanation: "SL-0 means that there are no specific security controls implemented or required above and beyond standard industrial practices, implying a very low or non-existent security posture against cyber threats."
            },
            {
                question: "Which document provides a comprehensive glossary of terms?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-1-1.",
                    "IEC 62443-4-2."
                ],
                answer: "IEC 62443-1-1.",
                explanation: "IEC 62443-1-1 is the introductory part of the series that defines the terminology, concepts, and models used throughout the standard series, serving as a foundational reference."
            },
            {
                question: "What is the primary goal of 'Defense-in-Depth' in an IACS?",
                options: [
                    "To reduce security personnel.",
                    "To establish multiple, redundant layers of security controls.",
                    "To centralize all security functions.",
                    "To eliminate security audits."
                ],
                answer: "To establish multiple, redundant layers of security controls.",
                explanation: "Defense-in-Depth is a strategy that increases a system's resilience against attacks by implementing layered security mechanisms, ensuring that if one layer is breached, other layers still provide protection."
            },
            {
                question: "Which best describes a 'Threat' in IEC 62443?",
                options: [
                    "A discovered weakness.",
                    "A potential cause of an unwanted incident.",
                    "A specific security control.",
                    "The quantifiable negative consequence."
                ],
                answer: "A potential cause of an unwanted incident.",
                explanation: "A threat is something that has the potential to cause harm to a system, such as a malicious actor, a natural disaster, or an accidental event, which can exploit a vulnerability."
            },
            {
                question: "What is a 'Vulnerability' in IEC 62443?",
                options: [
                    "A malicious entity.",
                    "A potential cause of an incident.",
                    "A weakness or flaw that can be exploited.",
                    "A security policy document."
                ],
                answer: "A weakness or flaw that can be exploited.",
                explanation: "A vulnerability is a weakness in a system, process, or control that can be exploited by a threat to cause harm or compromise security."
            },
            {
                question: "Which standard part defines Security Levels (SLs)?",
                options: [
                    "IEC 62443-1-1.",
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-1-1.",
                explanation: "The concept of Security Levels (SLs) is first defined in IEC 62443-1-1 as a fundamental concept for specifying the robustness of security controls required to counter specific threat scenarios."
            },
            {
                question: "What is the significance of 'Achieved Security Level (SL-A)'?",
                options: [
                    "Theoretical maximum security level.",
                    "Actually implemented and verified security level.",
                    "Desired security level.",
                    "Metric for early design stages."
                ],
                answer: "Actually implemented and verified security level.",
                explanation: "SL-A is the actually measured and validated security level of a system or component after implementing security measures, indicating its real-world security posture."
            },
            {
                question: "What is the main distinction between IT and OT security?",
                options: [
                    "IT focuses on confidentiality; OT on availability, integrity, and safety.",
                    "IT uses firewalls; OT uses physical security.",
                    "IT is for large enterprises; OT for small businesses.",
                    "No significant difference."
                ],
                answer: "IT focuses on confidentiality; OT on availability, integrity, and safety.",
                explanation: "IT security often prioritizes confidentiality, while OT security places a paramount emphasis on the availability of systems and the safety of physical processes, as downtime or disruptions in OT can have direct physical consequences and safety implications."
            },
            {
                question: "Which is NOT a typical characteristic of IACS environments?",
                options: [
                    "Long operational lifespans.",
                    "Real-time operations.",
                    "High tolerance for downtime.",
                    "Interconnectedness with physical processes."
                ],
                answer: "High tolerance for downtime.",
                explanation: "IACS environments typically have a *low* tolerance for downtime and data loss, as this can lead to significant operational, financial, and safety risks, making continuous availability a critical concern."
            },
            {
                question: "What is the primary purpose of a CSMS in IEC 62443?",
                options: [
                    "To automatically generate compliance reports.",
                    "To provide a structured framework for managing IACS cybersecurity risks.",
                    "To fully automate all cybersecurity tasks.",
                    "To eliminate human error in security operations."
                ],
                answer: "To provide a structured framework for managing IACS cybersecurity risks.",
                explanation: "A CSMS (Cybersecurity Management System) provides a structured approach for continuously managing cybersecurity risks within an organization, encompassing policies, procedures, processes, and ongoing improvement."
            },
            {
                question: "What is the role of a 'Security Policy' in IEC 62443?",
                options: [
                    "Detailed task instructions.",
                    "High-level statement of intent and objectives.",
                    "Technical specification document.",
                    "List of approved security vendors."
                ],
                answer: "High-level statement of intent and objectives.",
                explanation: "A security policy is a high-level document that establishes an organization's overall intentions and guidelines regarding cybersecurity, providing the foundation for more detailed procedures and controls."
            },
            {
                question: "Which part of IEC 62443 addresses security for IACS service providers?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-2-4.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-2-4.",
                explanation: "IEC 62443-2-4 'Requirements for IACS service providers' focuses on the security requirements applicable to external parties providing services (e.g., maintenance, integration) to IACS."
            },
            {
                question: "What is the concept of 'Trusted Paths' in IACS security?",
                options: [
                    "Physical pathways for personnel.",
                    "Communication channels protected against unauthorized access.",
                    "Pre-approved data backup routes.",
                    "Secure coding guidelines."
                ],
                answer: "Communication channels protected against unauthorized access.",
                explanation: "Trusted Paths ensure that critical communication within an IACS cannot be intercepted or altered by unauthorized entities, providing a secure medium for data exchange."
            },
            {
                question: "What is the purpose of 'Security Zones' in network segmentation?",
                options: [
                    "To create physical barriers.",
                    "To logically group assets with similar security requirements.",
                    "To define areas for video surveillance.",
                    "To designate areas for public Wi-Fi access."
                ],
                answer: "To logically group assets with similar security requirements.",
                explanation: "Security Zones are a crucial part of network segmentation, limiting the impact of an attack by isolating assets with similar risk profiles and enforcing strict communication policies between zones."
            },
            {
                question: "What is the fundamental role of 'Access Control' in IEC 62443?",
                options: [
                    "To manage physical entry points.",
                    "To restrict who can access specific resources and actions.",
                    "To regulate internet browsing.",
                    "To monitor network bandwidth."
                ],
                answer: "To restrict who can access specific resources and actions.",
                explanation: "Access control mechanisms ensure that only authorized users and systems have access to specific IACS resources and can perform only the actions for which they are authorized, enforcing the principle of least privilege."
            },
            // Section 2: Core Standards and Roles (30 questions)
            {
                question: "Which part of IEC 62443 focuses on general concepts, terminology, and models?",
                options: [
                    "IEC 62443-4-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-1-1.",
                    "IEC 62443-2-4."
                ],
                answer: "IEC 62443-1-1.",
                explanation: "IEC 62443-1-1 is the introductory part that defines the general concepts, terminology, and models that form the basis for the entire standard series."
            },
            {
                question: "Which part of IEC 62443 addresses policies and procedures for a CSMS?",
                options: [
                    "IEC 62443-4-2.",
                    "IEC 62443-2-1.",
                    "IEC 62443-3-2.",
                    "IEC 62443-1-2."
                ],
                answer: "IEC 62443-2-1.",
                explanation: "IEC 62443-2-1 'Master cybersecurity program for IACS owners and operators' provides guidelines for establishing and managing a CSMS."
            },
            {
                question: "Which part of IEC 62443 addresses technical security requirements at the system level?",
                options: [
                    "IEC 62443-1-1.",
                    "IEC 62443-2-3.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-3-3.",
                explanation: "IEC 62443-3-3 'System security requirements and security levels' specifies the technical security requirements for IACS at the system level."
            },
            {
                question: "Which part of IEC 62443 focuses on technical security requirements at the component level?",
                options: [
                    "IEC 62443-3-2.",
                    "IEC 62443-2-1.",
                    "IEC 62443-1-3.",
                    "IEC 62443-4-2."
                ],
                answer: "IEC 62443-4-2.",
                explanation: "IEC 62443-4-2 'Technical security requirements for IACS components' defines the specific technical security requirements for individual components used in IACS."
            },
            {
                question: "What is the primary role of the Asset Owner in IEC 62443?",
                options: [
                    "Developing secure hardware components.",
                    "Designing IACS network architecture.",
                    "Accountable for establishing and overseeing the CSMS.",
                    "Conducting external security audits."
                ],
                answer: "Accountable for establishing and overseeing the CSMS.",
                explanation: "The Asset Owner is ultimately responsible for the security of the IACS and implementing an effective cybersecurity management system, as they own and operate the system."
            },
            {
                question: "What is the key role of the System Integrator in IEC 62443?",
                options: [
                    "Producing control system software.",
                    "Designing, implementing, and deploying IACS to meet security requirements.",
                    "Defining cybersecurity policy.",
                    "Performing ethical hacking."
                ],
                answer: "Designing, implementing, and deploying IACS to meet security requirements.",
                explanation: "The System Integrator is responsible for bringing together various components into a complete IACS and must ensure that the integrated system meets security requirements, often translating the Asset Owner's needs into a secure solution."
            },
            {
                question: "What is the primary role of the Product Supplier in IEC 62443?",
                options: [
                    "Managing day-to-day operations.",
                    "Developing and supplying securely designed IACS components.",
                    "Overseeing incident response.",
                    "Conducting comprehensive risk assessments."
                ],
                answer: "Developing and supplying securely designed IACS components.",
                explanation: "Product suppliers are responsible for securely designing and manufacturing the individual hardware and software components used in IACS, ensuring 'security by design' at the foundational level."
            },
            {
                question: "What constitutes a 'Security Program' by IEC 62443-2-1?",
                options: [
                    "A single software application.",
                    "A comprehensive set of policies, procedures, and practices for managing IACS cybersecurity risks.",
                    "A daily security briefing.",
                    "An exhaustive list of approved security vendors."
                ],
                answer: "A comprehensive set of policies, procedures, and practices for managing IACS cybersecurity risks.",
                explanation: "A security program encompasses the organizational and process-related aspects of cybersecurity management, including governance, risk management, and continuous improvement, as detailed in IEC 62443-2-1."
            },
            {
                question: "What is the core concept of a 'Security Lifecycle' in IEC 62443?",
                options: [
                    "Operational lifespan of a security product.",
                    "Duration of cybersecurity certification.",
                    "Continuous process of managing risks from conception to decommissioning.",
                    "Annual budget allocation cycle."
                ],
                answer: "Continuous process of managing risks from conception to decommissioning.",
                explanation: "The security lifecycle emphasizes that cybersecurity is a continuous process encompassing all phases of an IACS, from conception to decommissioning, ensuring ongoing risk management, not a one-time event."
            },
            {
                question: "Which of the following is NOT a phase of the Security Lifecycle?",
                options: [
                    "Risk Assessment and Requirements Definition.",
                    "Implementation and Commissioning.",
                    "Marketing and Sales Strategy Development.",
                    "Maintenance and Continuous Improvement."
                ],
                answer: "Marketing and Sales Strategy Development.",
                explanation: "Marketing and sales strategy development is a commercial activity and not a direct phase within the technical and organizational security lifecycle of an IACS, which focuses on assessment, implementation, and ongoing maintenance."
            },
            {
                question: "Which IEC 62443 standard guides establishing a master cybersecurity program for IACS owners?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1.",
                    "IEC 62443-1-1."
                ],
                answer: "IEC 62443-2-1.",
                explanation: "IEC 62443-2-1 is specifically aimed at the Asset Owner and the requirements for their cybersecurity management system, providing a framework for developing and maintaining a comprehensive security program."
            },
            {
                question: "What is the primary focus of IEC 62443-3-2?",
                options: [
                    "Defining service provider security requirements.",
                    "Providing methodology for IACS security risk assessments.",
                    "Specifying technical requirements for components.",
                    "Establishing patch management procedures."
                ],
                answer: "Providing methodology for IACS security risk assessments.",
                explanation: "IEC 62443-3-2 'Security risk assessment for IACS' provides a detailed methodology for conducting risk assessments in IACS environments, which is essential for determining the appropriate security measures."
            },
            {
                question: "Which IEC 62443 standard focuses on the secure development lifecycle (SDL)?",
                options: [
                    "IEC 62443-4-1.",
                    "IEC 62443-2-3.",
                    "IEC 62443-3-1.",
                    "IEC 62443-1-2."
                ],
                answer: "IEC 62443-4-1.",
                explanation: "IEC 62443-4-1 'Requirements for secure product development' specifies the processes product suppliers must follow to develop secure IACS components and systems, integrating security from the design phase."
            },
            {
                question: "What is the role of a 'System Integrator' in IACS security?",
                options: [
                    "Solely producing IACS hardware.",
                    "Defining cybersecurity policy.",
                    "Designing, implementing, and deploying IACS solutions to meet security requirements.",
                    "Conducting independent security audits."
                ],
                answer: "Designing, implementing, and deploying IACS solutions to meet security requirements.",
                explanation: "The System Integrator is a crucial link in the implementation of secured IACS, as they are responsible for integrating diverse components into a functional system and ensuring its overall security posture."
            },
            {
                question: "Which part of IEC 62443 addresses technical security requirements for IACS solutions?",
                options: [
                    "IEC 62443-1-1.",
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-2."
                ],
                answer: "IEC 62443-3-3.",
                explanation: "IEC 62443-3-3 defines the technical security requirements for a complete IACS, including the interaction between components and the system's overall security functionality."
            },
            {
                question: "What is the purpose of 'Security Procedures'?",
                options: [
                    "To articulate high-level objectives.",
                    "To provide detailed, step-by-step instructions for implementing policies.",
                    "To serve as legal compliance documents.",
                    "To function as marketing materials."
                ],
                answer: "To provide detailed, step-by-step instructions for implementing policies.",
                explanation: "Security procedures translate abstract security policies into concrete, actionable steps for personnel and systems, ensuring consistent and effective implementation of security measures."
            },
            {
                question: "Which IEC 62443 standard focuses on technical security requirements for control system components?",
                options: [
                    "IEC 62443-3-1.",
                    "IEC 62443-4-2.",
                    "IEC 62443-2-4.",
                    "IEC 62443-1-1."
                ],
                answer: "IEC 62443-4-2.",
                explanation: "IEC 62443-4-2 is specifically focused on the technical security requirements applicable to individual hardware and software components that are part of an IACS, ensuring their inherent security."
            },
            {
                question: "What is the role of the 'Product Supplier' in IACS cybersecurity?",
                options: [
                    "To operate and maintain the IACS.",
                    "To securely develop and deliver IACS components.",
                    "To perform risk assessments for the asset owner.",
                    "To manage incident response."
                ],
                answer: "To securely develop and deliver IACS components.",
                explanation: "Product suppliers are the first link in the supply chain and must ensure their products are inherently securely designed and built, adhering to secure development lifecycles."
            },
            {
                question: "Which IEC 62443 standard provides metrics for security program assessment?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-2-2.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-2-2.",
                explanation: "IEC 62443-2-2 'Metrics for the assessment of security programs' provides guidelines and metrics to evaluate the effectiveness of a CSMS, enabling continuous improvement."
            },
            {
                question: "What is the primary target audience for IEC 62443-2-3?",
                options: [
                    "Manufacturers of IACS components.",
                    "System integrators.",
                    "Service providers specializing in patch management.",
                    "Asset owners and operators."
                ],
                answer: "Service providers specializing in patch management.",
                explanation: "IEC 62443-2-3 'Patch management in IACS' specifically addresses the processes and responsibilities for managing patches and updates in industrial environments, often involving external service providers."
            },
            {
                question: "Which IEC 62443 standard addresses maintenance and support activities?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-2-4.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-2-4.",
                explanation: "IEC 62443-2-4 is focused on the security requirements for external service providers who perform maintenance, installation, or other services on IACS, ensuring secure practices in outsourced operations."
            },
            {
                question: "What is the primary focus of 'IEC 62443-3-1'?",
                options: [
                    "Defining security levels.",
                    "Overviewing security technologies and countermeasures.",
                    "Addressing service provider requirements.",
                    "Specifying component technical requirements."
                ],
                answer: "Overviewing security technologies and countermeasures.",
                explanation: "IEC 62443-3-1 'Security technologies for IACS' provides an overview of various security technologies that can be applied in IACS environments to achieve desired security levels."
            },
            {
                question: "Which role defines and oversees the overall CSMS?",
                options: [
                    "The Product Supplier.",
                    "The System Integrator.",
                    "The Asset Owner.",
                    "An independent Service Provider."
                ],
                answer: "The Asset Owner.",
                explanation: "The Asset Owner is the entity that bears ultimate responsibility for the operation and security of the IACS, and therefore for defining and overseeing the Cybersecurity Management System (CSMS)."
            },
            {
                question: "What is the relationship between IEC 62443-4-1 and IEC 62443-4-2?",
                options: [
                    "4-1 defines product requirements; 4-2 defines system requirements.",
                    "4-1 defines secure development lifecycle processes; 4-2 defines technical requirements for components.",
                    "They are interchangeable standards.",
                    "4-1 is for hardware; 4-2 is for software."
                ],
                answer: "4-1 defines secure development lifecycle processes; 4-2 defines technical requirements for components.",
                explanation: "IEC 62443-4-1 focuses on the processes for securely developing products (the 'how'), while IEC 62443-4-2 specifies the technical security requirements for the components themselves (the 'what')."
            },
            {
                question: "Which IEC 62443 standard addresses patch management complexities?",
                options: [
                    "IEC 62443-2-1.",
                    "IEC 62443-2-3.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-2."
                ],
                answer: "IEC 62443-2-3.",
                explanation: "IEC 62443-2-3 is entirely dedicated to the complexities and best practices of patch management in the unique environments of IACS, considering their criticality and uptime requirements."
            },
            {
                question: "What is the primary purpose of IEC 62443-2-4?",
                options: [
                    "To define security levels.",
                    "To specify security program requirements for IACS service providers.",
                    "To outline risk assessment methodologies.",
                    "To provide technical requirements for components."
                ],
                answer: "To specify security program requirements for IACS service providers.",
                explanation: "This part of the standard is essential for Asset Owners to ensure that external service providers working with their IACS comply with the necessary security standards and practices."
            },
            {
                question: "Which IEC 62443 standard is fundamental for defining system-level security requirements?",
                options: [
                    "IEC 62443-1-1.",
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-3-3.",
                explanation: "IEC 62443-3-3 provides the detailed technical requirements that are necessary to secure an IACS at the system level and achieve the desired security levels."
            },
            {
                question: "What is the role of 'Security Assurance Levels' (SALs)?",
                options: [
                    "To define estimated security costs.",
                    "To measure confidence that a product/system meets security claims.",
                    "To specify minimum security audits.",
                    "To determine incident response speed."
                ],
                answer: "To measure confidence that a product/system meets security claims.",
                explanation: "SALs (Security Assurance Levels) indicate the degree of confidence one can have in the security claims of a product or system, based on the rigor and depth of the evaluation and testing performed."
            },
            {
                question: "Which IEC 62443 standard provides a framework for managing cybersecurity in IACS?",
                options: [
                    "IEC 62443-1-1.",
                    "IEC 62443-2-1.",
                    "IEC 62443-3-3.",
                    "IEC 62443-4-1."
                ],
                answer: "IEC 62443-2-1.",
                explanation: "IEC 62443-2-1 is the core standard for establishing and maintaining a robust cybersecurity management system for IACS, covering policies, procedures, and governance."
            },
            {
                question: "What is the primary focus of 'IEC 62443-3-1'?",
                options: [
                    "Defining security levels.",
                    "Addressing service provider requirements.",
                    "Providing overview of security technologies and countermeasures.",
                    "Specifying component technical requirements."
                ],
                answer: "Providing overview of security technologies and countermeasures.",
                explanation: "IEC 62443-3-1 provides an overview of the different technologies and methods that can be used to enhance the security of IACS, helping implementers choose appropriate solutions."
            },
            // Section 3: Risk Assessment and Requirements (30 questions)
            {
                question: "What is the fundamental principle behind the IEC 62443 approach?",
                options: [
                    "Always implement highest security measures.",
                    "Outsource all cybersecurity.",
                    "A risk-based approach.",
                    "Rely exclusively on physical security."
                ],
                answer: "A risk-based approach.",
                explanation: "The risk-based approach of IEC 62443 ensures that resources are deployed efficiently and that security measures are proportionate to the threats and vulnerabilities faced by the IACS, optimizing protection."
            },
            {
                question: "What are Fundamental Requirements (FRs) in IEC 62443-3-3?",
                options: [
                    "Basic network communication protocols.",
                    "High-level cybersecurity capabilities.",
                    "Specific legal documents.",
                    "Detailed hardware specifications."
                ],
                answer: "High-level cybersecurity capabilities.",
                explanation: "FRs are the overarching security objectives, such as identification and authentication control or data confidentiality, which are further elaborated in specific security requirements (SRs) to achieve a desired Security Level."
            },
            {
                question: "How many Fundamental Requirements (FRs) are defined in IEC 62443-3-3?",
                options: [
                    "3.",
                    "5.",
                    "7.",
                    "10."
                ],
                answer: "7.",
                explanation: "The seven Fundamental Requirements are: Identification and authentication control, Use control, System integrity, Data confidentiality, Restricted data flow, Timely response to events, and Resource availability."
            },
            {
                question: "Which is NOT one of the seven Fundamental Requirements (FRs)?",
                options: [
                    "Identification and authentication control.",
                    "Data confidentiality.",
                    "Social media integration and public outreach.",
                    "Use control."
                ],
                answer: "Social media integration and public outreach.",
                explanation: "Social media integration and public outreach are not direct cybersecurity capabilities of an IACS. The seven FRs focus on core security functions like access control, data protection, and system integrity."
            },
            {
                question: "What is the primary purpose of a Cybersecurity Risk Assessment?",
                options: [
                    "To calculate financial cost of cyber attack.",
                    "To identify, analyze, and evaluate potential cybersecurity risks.",
                    "To develop new security training programs.",
                    "To select new security vendors."
                ],
                answer: "To identify, analyze, and evaluate potential cybersecurity risks.",
                explanation: "A risk assessment is the fundamental step for determining the necessary security measures, by systematically evaluating the probability and consequences of potential cybersecurity incidents."
            },
            {
                question: "What are the two main factors for quantifying risk?",
                options: [
                    "Budget and personnel.",
                    "Hardware and software versions.",
                    "Likelihood and Impact.",
                    "System speed and efficiency."
                ],
                answer: "Likelihood and Impact.",
                explanation: "Risk in IEC 62443 is typically defined as the combination of the likelihood that a threat will exploit a vulnerability and the impact this exploitation would have on the system or organization."
            },
            {
                question: "What is threat modeling?",
                options: [
                    "Creation of physical models.",
                    "Systematic process of identifying threats from an attacker's perspective.",
                    "Development of weather forecasting systems.",
                    "Simulation of system failures."
                ],
                answer: "Systematic process of identifying threats from an attacker's perspective.",
                explanation: "Threat modeling helps proactively identify possible attack vectors and design effective defense mechanisms by understanding how an attacker might target a system, making security more robust from the design phase."
            },
            {
                question: "What is the primary purpose of a Vulnerability Assessment?",
                options: [
                    "To determine market value.",
                    "To identify weaknesses or flaws in an IACS.",
                    "To evaluate physical structural integrity.",
                    "To assess employee performance."
                ],
                answer: "To identify weaknesses or flaws in an IACS.",
                explanation: "A vulnerability assessment focuses on finding the weak points in a system that an attacker could potentially exploit, providing a basis for remediation efforts."
            },
            {
                question: "What is a Security Requirement (SR)?",
                options: [
                    "A broad, general statement.",
                    "A detailed, specific, and verifiable specification of a security control.",
                    "A legal document.",
                    "A marketing slogan."
                ],
                answer: "A detailed, specific, and verifiable specification of a security control.",
                explanation: "SRs are the concrete, measurable requirements that must be implemented to achieve the Fundamental Requirements and a specific Security Level, providing clear guidance for implementation and testing."
            },
            {
                question: "How are SRs related to FRs and SLs?",
                options: [
                    "SRs are independent.",
                    "SRs are derived from FRs, determined by target SL.",
                    "FRs are derived from SRs.",
                    "SRs only apply to SL0."
                ],
                answer: "SRs are derived from FRs, determined by target SL.",
                explanation: "The Fundamental Requirements (FRs) are the overarching goals, and the Security Requirements (SRs) are the specific implementations needed to achieve those FRs at a particular Security Level (SL), ensuring a structured approach."
            },
            {
                question: "What is the primary purpose of IEC 62443-3-2?",
                options: [
                    "To define security levels for components.",
                    "To provide methodology for IACS security risk assessments.",
                    "To specify technical requirements for components.",
                    "To manage software patches."
                ],
                answer: "To provide methodology for IACS security risk assessments.",
                explanation: "IEC 62443-3-2 'Security risk assessment for IACS' provides a structured approach for performing risk assessments, which is essential for determining and prioritizing the appropriate security measures."
            },
            {
                question: "What is a 'Security Target' (ST)?",
                options: [
                    "A specific security product.",
                    "A formal document specifying security objectives, threats, and functions.",
                    "A financial target for investments.",
                    "A training objective."
                ],
                answer: "A formal document specifying security objectives, threats, and functions.",
                explanation: "A Security Target (ST) is a formal specification of a system's security needs, including the threats, assumptions, and desired security level, serving as a blueprint for security implementation and evaluation."
            },
            {
                question: "What does 'Acceptable Risk' mean?",
                options: [
                    "Any risk not eliminated.",
                    "Tolerable risk after controls are implemented.",
                    "Risk transferred to a third party.",
                    "Ignored risk due to constraints."
                ],
                answer: "Tolerable risk after controls are implemented.",
                explanation: "Acceptable risk is the level of risk that an organization is willing to tolerate after implementing risk mitigation measures, acknowledging that not all risks can be entirely eliminated."
            },
            {
                question: "What is the importance of 'Threat Intelligence'?",
                options: [
                    "Helps predict weather patterns.",
                    "Provides up-to-date information on threats to enhance risk assessment.",
                    "Automates risk assessment.",
                    "Replaces vulnerability scans."
                ],
                answer: "Provides up-to-date information on threats to enhance risk assessment.",
                explanation: "Threat intelligence is crucial to keep risk assessments relevant and current, by providing insight into the most recent attack techniques and threat actors, enabling proactive defense."
            },
            {
                question: "What is the purpose of 'Security Requirements' (SRs) in IEC 62443-3-3?",
                options: [
                    "To define broad principles.",
                    "To provide detailed, verifiable specifications for system-level controls.",
                    "To outline organizational structure.",
                    "To list known vulnerabilities."
                ],
                answer: "To provide detailed, verifiable specifications for system-level controls.",
                explanation: "SRs are the concrete, measurable requirements that must be implemented to ensure system security and comply with the Fundamental Requirements and Security Levels, forming the basis for technical implementation."
            },
            {
                question: "What is the role of 'Risk Treatment'?",
                options: [
                    "To identify new risks.",
                    "To analyze risk impact.",
                    "To implement measures to modify, accept, avoid, or transfer risks.",
                    "To continuously monitor risks."
                ],
                answer: "To implement measures to modify, accept, avoid, or transfer risks.",
                explanation: "Risk treatment involves the decisions and actions taken to manage identified risks, such as implementing controls (modifying), accepting the risk, avoiding the activity causing the risk, or transferring the risk (e.g., through insurance)."
            },
            {
                question: "Which is an example of a 'Technical Security Requirement'?",
                options: [
                    "Employee training.",
                    "System enforcing strong password policy.",
                    "Physical access restriction.",
                    "Incident response plan review."
                ],
                answer: "System enforcing strong password policy.",
                explanation: "A strong password policy is a technical control that is directly enforced within the system to enhance authentication security, distinguishing it from procedural or physical controls."
            },
            {
                question: "What is the purpose of 'Security Level Assessment'?",
                options: [
                    "To determine financial cost.",
                    "To evaluate current security posture against target levels.",
                    "To establish new security levels.",
                    "To provide training on security levels."
                ],
                answer: "To evaluate current security posture against target levels.",
                explanation: "Security Level Assessment compares the achieved security level (SL-A) with the desired target security level (SL-T) to identify any discrepancies or areas where further controls are needed."
            },
            {
                question: "What is the relationship between 'Fundamental Requirements' and 'Security Levels'?",
                options: [
                    "FRs only apply to SL-1.",
                    "FRs are capabilities; SLs define implementation rigor.",
                    "SLs are subsets of FRs.",
                    "They are unrelated."
                ],
                answer: "FRs are capabilities; SLs define implementation rigor.",
                explanation: "The Fundamental Requirements describe what needs to be achieved (e.g., access control), while the Security Levels indicate how robust that implementation must be against various attack types and capabilities."
            },
            {
                question: "What is the primary output of a comprehensive cybersecurity risk assessment?",
                options: [
                    "List of all possible cyber attacks.",
                    "Detailed report of vulnerabilities.",
                    "Identified risks, their likelihood, impact, and mitigation measures.",
                    "Financial budget proposal."
                ],
                answer: "Identified risks, their likelihood, impact, and mitigation measures.",
                explanation: "The main goal of a risk assessment is to provide a clear understanding of the risks an IACS faces, along with actionable recommendations for reducing those risks to an acceptable level."
            },
            {
                question: "What is the concept of 'Residual Risk'?",
                options: [
                    "Risk completely eliminated.",
                    "Risk remaining after controls are applied.",
                    "Risk fully transferred.",
                    "Risk intentionally ignored."
                ],
                answer: "Risk remaining after controls are applied.",
                explanation: "Residual risk is the unavoidable risk that remains even after implementing all reasonable security measures, acknowledging that complete elimination of risk is rarely possible."
            },
            {
                question: "What is the role of 'Security Objectives'?",
                options: [
                    "Specific technical controls.",
                    "High-level goals and desired outcomes for IACS security.",
                    "Quantitative measurements for performance.",
                    "Mandatory legal requirements."
                ],
                answer: "High-level goals and desired outcomes for IACS security.",
                explanation: "Security objectives are the general intentions of an organization regarding the protection of their IACS, which then guide the definition of more specific security requirements."
            },
            {
                question: "What is the primary difference between 'Risk Acceptance' and 'Risk Mitigation'?",
                options: [
                    "Acceptance is ignoring; mitigation is eliminating.",
                    "Acceptance is tolerating without action; mitigation is active reduction.",
                    "Acceptance for IT; mitigation for OT.",
                    "No significant difference."
                ],
                answer: "Acceptance is tolerating without action; mitigation is active reduction.",
                explanation: "Risk acceptance is a deliberate decision to tolerate a risk without further action, while risk mitigation involves active steps to reduce the likelihood or impact of a risk through controls."
            },
            {
                question: "What is the purpose of 'Security Zones and Conduits' in risk assessment?",
                options: [
                    "To define physical boundaries.",
                    "To facilitate identification and isolation of assets based on risk.",
                    "To create completely isolated networks.",
                    "To simplify network addressing."
                ],
                answer: "To facilitate identification and isolation of assets based on risk.",
                explanation: "Zones and Conduits help structure the risk assessment by segmenting the IACS into manageable, logical units, simplifying the analysis of threats and vulnerabilities and enabling targeted security measures."
            },
            {
                question: "What is a 'Security Requirement Level' (SRL)?",
                options: [
                    "Total count of requirements.",
                    "Rigor required for an individual security requirement to meet SL-T.",
                    "Broad security guideline.",
                    "Metric for compliance."
                ],
                answer: "Rigor required for an individual security requirement to meet SL-T.",
                explanation: "An SRL (Security Requirement Level) specifies the depth and robustness of the implementation of an individual security requirement, ensuring it contributes adequately to the overall desired Security Level."
            },
            {
                question: "What is the importance of 'Contextualization' in risk assessment?",
                options: [
                    "Speeds up assessment.",
                    "Ensures risks are evaluated within the specific operational environment.",
                    "Enables generic templates.",
                    "Reduces need for expert input."
                ],
                answer: "Ensures risks are evaluated within the specific operational environment.",
                explanation: "Contextualization is crucial because the risks and the effectiveness of controls are highly dependent on the unique operational context, including technology, processes, personnel, and external factors."
            },
            {
                question: "What are 'Security Controls'?",
                options: [
                    "Exclusively technical solutions.",
                    "Measures implemented to reduce risks.",
                    "Mandatory legal regulations.",
                    "Reports on threats."
                ],
                answer: "Measures implemented to reduce risks.",
                explanation: "Security controls are the specific implementations (technical, procedural, or administrative) that are used to reduce identified risks to an acceptable level, forming the core of a security program."
            },
            {
                question: "What is the role of 'Impact Analysis'?",
                options: [
                    "To determine implementation cost.",
                    "To evaluate potential consequences of a cyber attack.",
                    "To identify potential attackers.",
                    "To prioritize training programs."
                ],
                answer: "To evaluate potential consequences of a cyber attack.",
                explanation: "Impact analysis quantifies the harm a successful attack can cause (e.g., financial, operational, reputational, safety), which is essential for understanding the severity of risks and prioritizing mitigation efforts."
            },
            {
                question: "What is 'Risk Prioritization'?",
                options: [
                    "Ignoring low impact risks.",
                    "Ranking risks based on likelihood and impact to guide mitigation.",
                    "Delegating all risk management.",
                    "Eliminating all risks immediately."
                ],
                answer: "Ranking risks based on likelihood and impact to guide mitigation.",
                explanation: "Risk prioritization ensures that the most critical risks, those with the highest likelihood and impact, are addressed first, allowing for efficient allocation of limited resources."
            },
            {
                question: "What is the purpose of 'Security Requirement Specifications'?",
                options: [
                    "To describe general principles.",
                    "To provide detailed, testable requirements for IACS security controls.",
                    "To outline organizational policy.",
                    "To list vulnerabilities."
                ],
                answer: "To provide detailed, testable requirements for IACS security controls.",
                explanation: "Security Requirement Specifications are the blueprint for the implementation of security controls and must be sufficiently detailed to allow for their effective implementation, testing, and verification."
            },
            // Section 4: Implementation and Maintenance (30 questions)
            {
                question: "What is the importance of patch management in IACS?",
                options: [
                    "To improve aesthetic appearance.",
                    "To address known vulnerabilities, preventing exploitation.",
                    "To increase network bandwidth.",
                    "To reduce physical network connections."
                ],
                answer: "To address known vulnerabilities, preventing exploitation.",
                explanation: "Patch management is crucial to protect systems against known vulnerabilities that can be exploited by attackers. While challenging in IACS due to uptime requirements, it's essential for maintaining security."
            },
            {
                question: "Why is network segmentation critical in IEC 62443?",
                options: [
                    "Reduces electrical power consumption.",
                    "Limits attack scope and impact by isolating zones.",
                    "Simplifies network configuration.",
                    "Speeds up data processing."
                ],
                answer: "Limits attack scope and impact by isolating zones.",
                explanation: "By segmenting a network into Zones and Conduits, the spread of an attack can be limited, protecting critical systems even if a portion of the network is compromised, embodying the Defense-in-Depth principle."
            },
            {
                question: "What is the purpose of a DMZ in IACS network architecture?",
                options: [
                    "To provide secure physical storage.",
                    "To act as a buffer separating OT from IT, allowing controlled communication.",
                    "To host non-critical IT services.",
                    "To store archived operational data."
                ],
                answer: "To act as a buffer separating OT from IT, allowing controlled communication.",
                explanation: "A DMZ (Demilitarized Zone) creates a secure boundary between different trust levels, such as between the enterprise IT network and the OT control network, to prevent unauthorized access and control data flow."
            },
            {
                question: "Which is a key consideration for securely managing remote access to IACS?",
                options: [
                    "Relying on generic, shared passwords.",
                    "Disabling all logging and auditing.",
                    "Implementing strong MFA and secure VPNs.",
                    "Allowing unrestricted remote access."
                ],
                answer: "Implementing strong MFA and secure VPNs.",
                explanation: "Remote access to IACS systems poses a significant risk and requires robust security measures such as MFA and encrypted VPN connections to ensure only authorized individuals can access the system securely."
            },
            {
                question: "Why is personnel security important in IEC 62443?",
                options: [
                    "To ensure physical fitness.",
                    "Because human factors are often the weakest link.",
                    "To manage payroll.",
                    "To efficiently schedule work shifts."
                ],
                answer: "Because human factors are often the weakest link.",
                explanation: "Human errors, negligence, or social engineering attacks can lead to serious security incidents, making security awareness training, background checks, and clear roles/responsibilities for personnel crucial."
            },
            {
                question: "What is the role of logging and monitoring in IACS security?",
                options: [
                    "To generate high-level reports only.",
                    "To detect anomalous behavior, identify incidents, and provide forensic data.",
                    "To store historical operational data.",
                    "To automatically perform system backups."
                ],
                answer: "To detect anomalous behavior, identify incidents, and provide forensic data.",
                explanation: "Logging and monitoring are essential for timely detection of suspicious activities, analysis of incidents, and compliance with regulatory requirements, providing visibility into system behavior."
            },
            {
                question: "What is an Incident Response Plan and why is it crucial for IACS?",
                options: [
                    "A plan for social events.",
                    "A documented plan to prepare for, detect, respond to, and recover from cybersecurity incidents.",
                    "A marketing strategy.",
                    "A schedule for equipment maintenance."
                ],
                answer: "A documented plan to prepare for, detect, respond to, and recover from cybersecurity incidents.",
                explanation: "A well-defined and regularly practiced incident response plan is vital to minimize the impact of a cybersecurity incident on IACS operations and safety, ensuring a swift and effective recovery."
            },
            {
                question: "What is the significance of the Secure Development Lifecycle (SDL)?",
                options: [
                    "Focuses on aesthetic design.",
                    "Integrates security from the beginning of development.",
                    "Dictates product pricing.",
                    "Only relevant for non-critical systems."
                ],
                answer: "Integrates security from the beginning of development.",
                explanation: "SDL (Secure Development Lifecycle) ensures that security is proactively built into products and systems, which is significantly more cost-effective and effective than attempting to add security measures later in the lifecycle."
            },
            {
                question: "What is the key difference between a security policy and a security procedure?",
                options: [
                    "Policy for IT, procedure for OT.",
                    "Policy is high-level intent; procedure is detailed instructions.",
                    "Policy is internal; procedure is external.",
                    "Policy is mandatory; procedure is optional."
                ],
                answer: "Policy is high-level intent; procedure is detailed instructions.",
                explanation: "A policy is a statement of what needs to be achieved (the 'what'), while a procedure describes how those goals should be achieved step-by-step (the 'how'), providing actionable guidance."
            },
            {
                question: "How does physical security relate to cybersecurity in IEC 62443?",
                options: [
                    "They are entirely separate.",
                    "Unauthorized physical access can lead to cybersecurity compromise.",
                    "Physical security is only for office buildings.",
                    "Solely concerns fire safety."
                ],
                answer: "Unauthorized physical access can lead to cybersecurity compromise.",
                explanation: "Physical security is a fundamental layer of Defense-in-Depth. If an attacker gains physical access to IACS components, many cybersecurity controls can be bypassed, highlighting their interconnectedness."
            },
            {
                question: "What is the purpose of a 'Cybersecurity Audit' in IACS?",
                options: [
                    "To provide initial training.",
                    "To independently assess effectiveness of controls and verify compliance.",
                    "To determine market trends.",
                    "To manage financial data."
                ],
                answer: "To independently assess effectiveness of controls and verify compliance.",
                explanation: "Audits are essential to verify that security measures are correctly implemented, are operating effectively, and comply with relevant standards and regulations, providing an objective evaluation."
            },
            {
                question: "Why is 'Configuration Management' important for IACS security?",
                options: [
                    "Helps track employee attendance.",
                    "Ensures systems are consistently maintained in a secure state.",
                    "Exclusively for software development.",
                    "Reduces need for security documentation."
                ],
                answer: "Ensures systems are consistently maintained in a secure state.",
                explanation: "Configuration management prevents 'configuration drift' and ensures that systems remain consistent and secure throughout their lifespan, which is essential for the integrity and reliability of IACS."
            },
            {
                question: "What is the role of 'Backup and Recovery' in IACS cybersecurity?",
                options: [
                    "To store non-critical data.",
                    "To ensure operational continuity and data integrity by allowing system restoration.",
                    "To create physical document copies.",
                    "To manage software licenses."
                ],
                answer: "To ensure operational continuity and data integrity by allowing system restoration.",
                explanation: "Backup and recovery are crucial measures for availability and resilience, enabling systems to be quickly restored after an attack or failure, minimizing downtime and data loss."
            },
            {
                question: "What is the primary purpose of 'Security Awareness Training'?",
                options: [
                    "To teach advanced programming.",
                    "To inform personnel about risks and their role in security.",
                    "To improve physical fitness.",
                    "To manage shift schedules."
                ],
                answer: "To inform personnel about risks and their role in security.",
                explanation: "Personnel are often the first line of defense; awareness training helps them recognize risks, understand security policies, and follow best practices, reducing the likelihood of human-induced incidents."
            },
            {
                question: "Why is 'Network Monitoring' crucial in IACS?",
                options: [
                    "To track internet usage.",
                    "To detect anomalous traffic or malicious activities.",
                    "To optimize network speed.",
                    "To manage network device inventory."
                ],
                answer: "To detect anomalous traffic or malicious activities.",
                explanation: "Continuous network monitoring is essential for early detection of threats and anomalous behavior that may indicate a compromise of the IACS, allowing for timely response and mitigation."
            },
            {
                question: "What is the primary purpose of 'Vulnerability Management'?",
                options: [
                    "To intentionally ignore weaknesses.",
                    "To systematically identify, assess, and remediate vulnerabilities.",
                    "To create new vulnerabilities for testing.",
                    "To outsource all security tasks."
                ],
                answer: "To systematically identify, assess, and remediate vulnerabilities.",
                explanation: "Vulnerability management is a continuous process of finding, analyzing, and mitigating weaknesses in systems and applications before they can be exploited by attackers, reducing the attack surface."
            },
            {
                question: "What is 'Secure Disposal' of IACS assets?",
                options: [
                    "Selling old equipment.",
                    "Ensuring sensitive data is securely erased from decommissioned assets.",
                    "Recycling industrial waste.",
                    "Donating old equipment."
                ],
                answer: "Ensuring sensitive data is securely erased from decommissioned assets.",
                explanation: "Secure disposal prevents sensitive operational data or configuration information from falling into the wrong hands when equipment is decommissioned or reused, maintaining data confidentiality and integrity."
            },
            {
                question: "Why is 'Change Management' important in IACS security?",
                options: [
                    "To prevent all modifications.",
                    "To ensure all changes are controlled, documented, and reviewed for security impact.",
                    "To speed up updates.",
                    "To reduce system testing."
                ],
                answer: "To ensure all changes are controlled, documented, and reviewed for security impact.",
                explanation: "Change management is essential to prevent unauthorized or unintended changes that could undermine security, ensuring that all modifications are deliberate, approved, and assessed for risk."
            },
            {
                question: "What is the role of 'Security Patches' in IACS maintenance?",
                options: [
                    "To improve system performance.",
                    "To fix known security vulnerabilities and bugs.",
                    "To introduce new features.",
                    "To modify user interface."
                ],
                answer: "To fix known security vulnerabilities and bugs.",
                explanation: "Security patches are updates released to close specific security loopholes, making systems less vulnerable to attacks and maintaining their security posture against evolving threats."
            },
            {
                question: "What does 'Continuous Improvement' entail in a cybersecurity program?",
                options: [
                    "Implementing new technologies annually.",
                    "Regularly reviewing and adapting controls to evolving threats.",
                    "Automatically increasing budget.",
                    "Automating all security tasks."
                ],
                answer: "Regularly reviewing and adapting controls to evolving threats.",
                explanation: "The threat landscape is constantly changing, so an effective security program must be dynamic and continuously adapted through regular reviews, updates, and learning from incidents to remain relevant and effective."
            },
            {
                question: "What is the purpose of 'Physical Security Controls'?",
                options: [
                    "To monitor employee productivity.",
                    "To prevent unauthorized physical access to critical IACS equipment.",
                    "To regulate building temperature.",
                    "To manage visitor logs."
                ],
                answer: "To prevent unauthorized physical access to critical IACS equipment.",
                explanation: "Physical security, such as locks, surveillance, and access controls, is an essential first line of defense to prevent tampering, theft, or direct compromise of IACS equipment."
            },
            {
                question: "Why is 'Secure Remote Access' crucial for IACS?",
                options: [
                    "To enable unrestricted access.",
                    "To allow authorized personnel secure access while minimizing risks.",
                    "To eliminate on-site personnel.",
                    "To simplify network configuration."
                ],
                answer: "To allow authorized personnel secure access while minimizing risks.",
                explanation: "Secure remote access is necessary for maintenance and management but must be strictly controlled with strong authentication and encryption to prevent it from becoming an easily exploitable attack vector."
            },
            {
                question: "What is the role of 'Security Event Logging'?",
                options: [
                    "To record operational data.",
                    "To capture and store security-relevant events for monitoring and forensics.",
                    "To store performance metrics.",
                    "To securely store user credentials."
                ],
                answer: "To capture and store security-relevant events for monitoring and forensics.",
                explanation: "Security event logs are vital for detecting suspicious activities, investigating incidents, demonstrating compliance, and providing an audit trail of system events."
            },
            {
                question: "What is 'Incident Response Testing'?",
                options: [
                    "Testing new security products.",
                    "Simulating cyber incidents to evaluate and improve response plan effectiveness.",
                    "Testing network connectivity.",
                    "Testing backup integrity."
                ],
                answer: "Simulating cyber incidents to evaluate and improve response plan effectiveness.",
                explanation: "Regularly testing the incident response plan ensures that the team is prepared, the plan is effective, and any weaknesses in the response process are identified and addressed before a real incident occurs."
            },
            {
                question: "Why is 'Least Privilege' important in IACS access control?",
                options: [
                    "To grant all users full administrative rights.",
                    "To restrict users and processes to minimum necessary access rights.",
                    "To simplify user account management.",
                    "To reduce security awareness training."
                ],
                answer: "To restrict users and processes to minimum necessary access rights.",
                explanation: "The principle of least privilege minimizes the potential damage if an account or system is compromised, by limiting the scope of access and actions an unauthorized entity can perform."
            },
            {
                question: "What is the purpose of 'Intrusion Detection Systems (IDS)'?",
                options: [
                    "To prevent all cyber attacks.",
                    "To monitor network traffic for suspicious patterns and generate alerts.",
                    "To manage network devices.",
                    "To optimize network performance."
                ],
                answer: "To monitor network traffic for suspicious patterns and generate alerts.",
                explanation: "IDS (Intrusion Detection Systems) are designed to detect and alert on suspicious or malicious activities by analyzing network traffic or system logs, allowing for rapid response to potential threats."
            },
            {
                question: "What is the role of 'Asset Inventory' in IACS security?",
                options: [
                    "To track financial assets.",
                    "To maintain an accurate list of all hardware, software, and data components.",
                    "To manage spare parts.",
                    "To track employee-assigned assets."
                ],
                answer: "To maintain an accurate list of all hardware, software, and data components.",
                explanation: "A complete and accurate asset inventory is fundamental for risk assessment, vulnerability management, and incident response, as you cannot effectively secure what you do not know and understand."
            },
            {
                question: "What does 'Secure Configuration' entail?",
                options: [
                    "Using default settings.",
                    "Hardening systems by disabling unnecessary functions and applying best practices.",
                    "Encrypting all data.",
                    "Simply installing antivirus."
                ],
                answer: "Hardening systems by disabling unnecessary functions and applying best practices.",
                explanation: "Secure configuration (or 'hardening') reduces a system's attack surface by removing unnecessary functionality, closing potential entry points, and optimizing security settings to minimize vulnerabilities."
            },
            {
                question: "What is the importance of 'Vendor Management' in IACS security?",
                options: [
                    "To select cheapest vendors.",
                    "To ensure external vendors comply with cybersecurity requirements.",
                    "To manage vendor contracts.",
                    "To outsource all cybersecurity."
                ],
                answer: "To ensure external vendors comply with cybersecurity requirements.",
                explanation: "The supply chain is a significant risk. Vendor management ensures that the security practices of third parties align with the organization's own security objectives, mitigating risks introduced by external dependencies."
            },
            {
                question: "What is 'Security Maintenance' in the IACS lifecycle?",
                options: [
                    "Only repairing broken hardware.",
                    "Ongoing activities like patching, scanning, and audits to maintain security posture.",
                    "Developing new security features.",
                    "Only annual security audits."
                ],
                answer: "Ongoing activities like patching, scanning, and audits to maintain security posture.",
                explanation: "Security maintenance is a continuous process to ensure that security controls remain effective and adapt to new threats and vulnerabilities, ensuring the long-term resilience of the IACS."
            },
            // Section 5: Advanced Concepts and Certification (30 questions)
            {
                question: "What is the core concept of 'Security by Design'?",
                options: [
                    "Adding security as an afterthought.",
                    "Integrating security from initial design throughout development.",
                    "Delegating all security tasks.",
                    "Utilizing only off-the-shelf products."
                ],
                answer: "Integrating security from initial design throughout development.",
                explanation: "Security by Design is a proactive approach where security considerations are integrated from the beginning of the development lifecycle, which is significantly more effective and cost-efficient than retrofitting security."
            },
            {
                question: "What is the role of security testing in IEC 62443?",
                options: [
                    "To confirm aesthetic design.",
                    "To verify implemented controls are effective and meet requirements.",
                    "To determine market demand.",
                    "To train sales personnel."
                ],
                answer: "To verify implemented controls are effective and meet requirements.",
                explanation: "Security testing, such as penetration testing and vulnerability scanning, is essential to validate the effectiveness of security controls and identify any weaknesses before deployment."
            },
            {
                question: "What is a 'Security Target' (ST) document?",
                options: [
                    "List of training participants.",
                    "Marketing plan for a product.",
                    "Formal document specifying security objectives, threats, and functions.",
                    "Historical record of incidents."
                ],
                answer: "Formal document specifying security objectives, threats, and functions.",
                explanation: "The Security Target (ST) is a formal document that describes the security needs of a system, including the threats, assumptions, and desired security level, serving as a blueprint for security implementation and evaluation."
            },
            {
                question: "What is a Security Assurance Level (SAL)?",
                options: [
                    "Total financial allocation.",
                    "Measure of confidence that a product/system meets security claims.",
                    "Maximum data encryption speed.",
                    "Number of cybersecurity certifications."
                ],
                answer: "Measure of confidence that a product/system meets security claims.",
                explanation: "SALs (Security Assurance Levels) indicate the degree of confidence one can have in the security claims of a product or system, based on the rigor and depth of the evaluation and testing performed."
            },
            {
                question: "How does IEC 62443 address supply chain security?",
                options: [
                    "By entirely ignoring it.",
                    "By requiring suppliers to implement secure development lifecycles and evaluating their practices.",
                    "By mandating specific logistics providers.",
                    "By focusing solely on final implementation."
                ],
                answer: "By requiring suppliers to implement secure development lifecycles and evaluating their practices.",
                explanation: "IEC 62443 recognizes the importance of the supply chain and places responsibilities on suppliers to deliver secure products and manage their own security practices, mitigating risks introduced by third parties."
            },
            {
                question: "What are the primary benefits of IEC 62443 certification?",
                options: [
                    "Slight, negligible market value increase.",
                    "Demonstrating compliance, increasing trust, reducing risks, and improving posture.",
                    "Eliminating further security measures.",
                    "Guaranteeing zero cyber attacks."
                ],
                answer: "Demonstrating compliance, increasing trust, reducing risks, and improving posture.",
                explanation: "Certification provides independent validation of security practices and products, which enhances customer and partner trust, reduces risk exposure, and drives continuous improvement in cybersecurity."
            },
            {
                question: "How does IEC 62443 relate to NIST CSF?",
                options: [
                    "They are completely incompatible.",
                    "IEC 62443 is sector-specific, often complementary to broader frameworks.",
                    "IEC 62443 replaces other frameworks.",
                    "They address different threats."
                ],
                answer: "IEC 62443 is sector-specific, often complementary to broader frameworks.",
                explanation: "While IEC 62443 is specific to IACS, it shares many principles with general cybersecurity frameworks and can often be used in combination with them to create a comprehensive and tailored security strategy."
            },
            {
                question: "What is a significant challenge implementing IEC 62443 in 'brownfield' IACS?",
                options: [
                    "Excessive budget availability.",
                    "Lack of compatibility with older equipment, operational disruption risks, and difficulty achieving downtime.",
                    "Abundance of documentation.",
                    "Surplus of qualified experts."
                ],
                answer: "Lack of compatibility with older equipment, operational disruption risks, and difficulty achieving downtime.",
                explanation: "Brownfield environments (existing systems) present unique challenges due to outdated technologies, limited compatibility, and the high costs and risks of downtime for updates, making security upgrades complex."
            },
            {
                question: "What is the importance of continuous improvement in a cybersecurity program?",
                options: [
                    "Performed only once every ten years.",
                    "Unnecessary if initial implementation was perfect.",
                    "Cyber threat landscape evolves, necessitating regular reviews and adaptation.",
                    "Primarily for external reporting."
                ],
                answer: "Cyber threat landscape evolves, necessitating regular reviews and adaptation.",
                explanation: "Cybersecurity is not a one-time task. Continuous improvement ensures that the security program remains relevant and effective against new and evolving threats, adapting to changing risks and technologies."
            },
            {
                question: "What is the ultimate goal of implementing IEC 62443?",
                options: [
                    "To increase system complexity.",
                    "To eliminate human interaction.",
                    "To reduce cybersecurity incidents, protect infrastructure, and ensure safety/continuity.",
                    "To focus exclusively on IT networks."
                ],
                answer: "To reduce cybersecurity incidents, protect infrastructure, and ensure safety/continuity.",
                explanation: "The overarching goal of IEC 62443 is to create resilient and secure IACS environments that can withstand cyber attacks, thereby safeguarding critical infrastructure, ensuring operational continuity, and protecting human safety."
            },
            {
                question: "What is the purpose of 'Security Validation'?",
                options: [
                    "To confirm marketing claims.",
                    "To ensure implemented security measures effectively meet requirements.",
                    "To validate financial investments.",
                    "To validate training records."
                ],
                answer: "To ensure implemented security measures effectively meet requirements.",
                explanation: "Validation is the process of confirming that the system or product meets the originally defined security requirements and fulfills its intended security functions, ensuring real-world effectiveness."
            },
            {
                question: "What is 'Certification' in IEC 62443?",
                options: [
                    "A mandatory legal requirement.",
                    "A formal, independent process to confirm compliance with standards.",
                    "An internal audit process.",
                    "A marketing strategy."
                ],
                answer: "A formal, independent process to confirm compliance with standards.",
                explanation: "Certification by an independent third party provides a high degree of assurance that a product or system complies with the security requirements of IEC 62443, enhancing credibility and trust."
            },
            {
                question: "What is the role of 'Threat Modeling' in SDL?",
                options: [
                    "To create visual models.",
                    "To systematically identify threats and vulnerabilities early in design.",
                    "To simulate system performance.",
                    "To automatically generate secure code."
                ],
                answer: "To systematically identify threats and vulnerabilities early in design.",
                explanation: "Threat modeling in the SDL helps developers understand security risks and design mitigation measures before the code is written, making security integration more effective and cost-efficient."
            },
            {
                question: "What is the primary benefit of 'IEC 62443-compliance'?",
                options: [
                    "Reduced operational costs.",
                    "Improved cybersecurity posture, reduced risk, and enhanced resilience.",
                    "Guaranteed increase in performance.",
                    "Elimination of future security audits."
                ],
                answer: "Improved cybersecurity posture, reduced risk, and enhanced resilience.",
                explanation: "Compliance with IEC 62443 helps organizations implement a robust security strategy, significantly reducing the likelihood and impact of successful cyber attacks and improving the overall resilience of their industrial operations."
            },
            {
                question: "What is 'Security Assessment'?",
                options: [
                    "A one-time activity.",
                    "A systematic examination of IACS security posture.",
                    "A process for acquiring new tools.",
                    "A method for training personnel."
                ],
                answer: "A systematic examination of IACS security posture.",
                explanation: "Security assessments are periodic evaluations to measure the effectiveness of implemented security controls, identify new risks, and ensure ongoing compliance with security objectives."
            },
            {
                question: "How does 'Risk Management' relate to IEC 62443?",
                options: [
                    "It is optional.",
                    "It is a core, continuous process integrated throughout the lifecycle.",
                    "Exclusively performed during incident response.",
                    "Focuses solely on financial risks."
                ],
                answer: "It is a core, continuous process integrated throughout the lifecycle.",
                explanation: "Risk management is the guiding principle throughout the entire IEC 62443 standard, with all security activities driven by an understanding of the risks faced by the IACS."
            },
            {
                question: "What is 'Defense-in-Depth' in security architecture?",
                options: [
                    "Relying on a single perimeter defense.",
                    "Implementing multiple, overlapping, and complementary security controls.",
                    "Distributing responsibilities without coordination.",
                    "Focusing exclusively on software security."
                ],
                answer: "Implementing multiple, overlapping, and complementary security controls.",
                explanation: "Defense-in-Depth is an architectural principle that enhances a system's resilience by creating multiple layers of defense, so that a breach in one layer does not directly lead to a complete compromise of the asset."
            },
            {
                question: "What is the importance of 'Security Metrics'?",
                options: [
                    "Only for external reporting.",
                    "Provide measurable indicators of control effectiveness and posture.",
                    "Define financial costs.",
                    "Used to track employee performance."
                ],
                answer: "Provide measurable indicators of control effectiveness and posture.",
                explanation: "Metrics are essential for monitoring the performance of the security program, identifying trends, and supporting data-driven decisions about security investments and improvements."
            },
            {
                question: "What is 'Supply Chain Risk Management'?",
                options: [
                    "Managing logistics.",
                    "Assessing and mitigating cybersecurity risks from third-party products/services.",
                    "Minimizing procurement costs.",
                    "Ensuring timely component delivery."
                ],
                answer: "Assessing and mitigating cybersecurity risks from third-party products/services.",
                explanation: "Supply Chain Risk Management focuses on controlling the security risks arising from reliance on external suppliers and their products or services, ensuring that third-party vulnerabilities do not compromise the IACS."
            },
            {
                question: "What is the role of 'Security Requirements' in the design phase?",
                options: [
                    "Only considered during final testing.",
                    "Guide design and implementation to meet target security levels.",
                    "Primarily for marketing.",
                    "Exclusively define project budget."
                ],
                answer: "Guide design and implementation to meet target security levels.",
                explanation: "Security requirements are the specifications that the design team must follow to ensure that the system is built securely from the ground up and meets the desired Security Levels, making security an integral part of the design."
            },
            {
                question: "What does 'Security by Default' mean?",
                options: [
                    "Leaving all default settings.",
                    "Configuring systems with most secure settings out-of-the-box.",
                    "Relying solely on open-source tools.",
                    "Trusting users to configure settings."
                ],
                answer: "Configuring systems with most secure settings out-of-the-box.",
                explanation: "Security by Default means that products and systems are delivered with the highest security settings by default, reducing the chance of vulnerabilities due to misconfiguration by users or integrators."
            },
            {
                question: "What is the purpose of 'Penetration Testing'?",
                options: [
                    "To assess physical security.",
                    "To simulate cyber attacks to identify vulnerabilities and test defenses.",
                    "To train new analysts.",
                    "To passively monitor network traffic."
                ],
                answer: "To simulate cyber attacks to identify vulnerabilities and test defenses.",
                explanation: "Penetration testing (pentesting) is a proactive method to test the robustness of a system by performing controlled, simulated attacks to discover weaknesses that might be exploited by real attackers."
            },
            {
                question: "What is 'Security Hardening'?",
                options: [
                    "Making policies more stringent.",
                    "Reducing a system's attack surface by eliminating unnecessary functions and applying secure configurations.",
                    "Encrypting all data.",
                    "Installing antivirus."
                ],
                answer: "Reducing a system's attack surface by eliminating unnecessary functions and applying secure configurations.",
                explanation: "Security Hardening is the process of securing a system by configuring it to have as few vulnerabilities as possible, often by disabling unnecessary functionality and optimizing security settings to minimize vulnerabilities."
            },
            {
                question: "What is the role of 'Governance' in a cybersecurity program?",
                options: [
                    "Solely concerns compliance.",
                    "Establishes policies, processes, and responsibilities for objectives and oversight.",
                    "Focuses exclusively on technical implementation.",
                    "Primarily managed by external auditors."
                ],
                answer: "Establishes policies, processes, and responsibilities for objectives and oversight.",
                explanation: "Governance ensures that cybersecurity is an integral part of the business strategy and that clear responsibilities and accountability are in place at all levels of the organization for managing security risks."
            },
            {
                question: "What is the benefit of using 'Standardized Security Controls'?",
                options: [
                    "Always free of charge.",
                    "Provide common basis for security, facilitate interoperability, simplify compliance.",
                    "Eliminate customization.",
                    "Only applicable to IT systems."
                ],
                answer: "Provide common basis for security, facilitate interoperability, simplify compliance.",
                explanation: "Standardized controls promote consistency, reduce complexity, and make it easier to comply with regulations and best practices, fostering a more secure and manageable environment."
            },
            {
                question: "What is 'Continuous Monitoring'?",
                options: [
                    "Monitoring only during business hours.",
                    "Ongoing surveillance and analysis to ensure controls are effective and detect new threats.",
                    "One-time security assessment.",
                    "Monitoring only physical access points."
                ],
                answer: "Ongoing surveillance and analysis to ensure controls are effective and detect new threats.",
                explanation: "Continuous monitoring is essential to respond quickly to evolving threats and to ensure the effectiveness of security measures in real-time, providing ongoing visibility into the security posture."
            },
            {
                question: "What is the primary purpose of 'Security Architecture Design'?",
                options: [
                    "To create visually appealing diagrams.",
                    "To define structure, components, and relationships of security elements to achieve objectives.",
                    "To specify only hardware requirements.",
                    "To manage software licenses."
                ],
                answer: "To define structure, components, and relationships of security elements to achieve objectives.",
                explanation: "A good security architecture design is the foundation for a robust and resilient IACS, ensuring that security is systematically built into the system's structure from the earliest stages."
            },
            {
                question: "What is the role of 'Security Documentation'?",
                options: [
                    "Optional and rarely used.",
                    "Provides comprehensive record of policies, procedures, designs, and assessments.",
                    "Exclusively for legal compliance.",
                    "Replaces security awareness training."
                ],
                answer: "Provides comprehensive record of policies, procedures, designs, and assessments.",
                explanation: "Documentation is crucial for maintaining consistency, training personnel, conducting audits, and demonstrating compliance, serving as a vital knowledge base for the security program."
            },
            {
                question: "What is 'Security Lifecycle Management'?",
                options: [
                    "Managing operational lifespan of products.",
                    "Holistic approach to integrating security throughout IACS lifecycle.",
                    "Only managing incident response.",
                    "Focusing solely on operational phase."
                ],
                answer: "Holistic approach to integrating security throughout IACS lifecycle.",
                explanation: "Lifecycle management ensures that security is not just an initial consideration, but a continuous process that spans the entire lifespan of the IACS, encompassing all phases from design to decommissioning."
            },
            // New questions based on PDF
            {
                question: "Which three basic properties are the building blocks of cybersecurity?",
                options: [
                    "Authorization, Identification, and Integrity.",
                    "Confidentiality, Integrity, and Availability (CIA).",
                    "Authorization, Reliability, and Integrity.",
                    "Confidentiality, Integrity, and Authorization."
                ],
                answer: "Confidentiality, Integrity, and Availability (CIA).",
                explanation: "The CIA triad (Confidentiality, Integrity, Availability) represents the fundamental goals of information security, ensuring data is private, accurate, and accessible when needed."
            },
            {
                question: "What is the biggest security problem if business networks connect directly to industrial control systems?",
                options: [
                    "Excessive business user data requests.",
                    "Unauthorized users, outsiders, and malware can penetrate and disrupt processes.",
                    "Production workers changing business data.",
                    "Increased cybersecurity insurance costs."
                ],
                answer: "Unauthorized users, outsiders, and malware can penetrate and disrupt processes.",
                explanation: "Direct connections between IT and OT networks create a significant attack surface, allowing threats from the less-controlled IT environment to directly impact critical and sensitive OT systems, leading to potential operational disruption or safety incidents."
            },
            {
                question: "'Countermeasures' in cybersecurity are measures taken to:",
                options: [
                    "Completely eliminate system penetration.",
                    "Confuse perimeter intrusion detectors.",
                    "Reduce the system's risk of loss from vulnerabilities and threats.",
                    "Eliminate insider risk."
                ],
                answer: "Reduce the system's risk of loss from vulnerabilities and threats.",
                explanation: "Countermeasures are controls or safeguards implemented to mitigate risks by reducing the likelihood of a threat exploiting a vulnerability or by reducing the impact if an exploitation occurs."
            },
            {
                question: "Why would a company issue security policies for industrial networks?",
                options: [
                    "To inform intruders of consequences.",
                    "To establish department ownership.",
                    "To guide the cybersecurity department on catching violations.",
                    "To communicate responsibilities of users, management, and IT staff."
                ],
                answer: "To communicate responsibilities of users, management, and IT staff.",
                explanation: "Security policies serve as a foundational document to clearly define expectations, roles, and responsibilities for all stakeholders regarding the security of industrial networks, fostering a culture of security."
            },
            {
                question: "A key factor for the success of a cybersecurity program is:",
                options: [
                    "Policies, objectives, and activities that accurately reflect business rationale.",
                    "Strict rules forbidding IT-OT interconnection.",
                    "Exclusive adoption of latest security technologies.",
                    "Continuous hardware upgrades."
                ],
                answer: "Policies, objectives, and activities that accurately reflect business rationale.",
                explanation: "A successful cybersecurity program must be aligned with the organization's overall business objectives and rationale, ensuring that security efforts support and enable the business rather than hinder it."
            },
            {
                question: "One way safety is different from security in industrial plants is that:",
                options: [
                    "Safety considers malicious actions.",
                    "Safety encompasses security.",
                    "Safety concerns human error and natural causes; security involves malicious behavior.",
                    "Safety concerns malicious behavior; security involves human error."
                ],
                answer: "Safety concerns human error and natural causes; security involves malicious behavior.",
                explanation: "Safety traditionally focuses on preventing unintentional harm from accidents or human error, whereas security addresses intentional harm caused by malicious actors. In industrial settings, their convergence is critical."
            },
            {
                question: "Which of the following documents is primarily an IT Security standard?",
                options: [
                    "IEC 61850.",
                    "ISO 27001:2013.",
                    "ISA 95.",
                    "ISA 84."
                ],
                answer: "ISO 27001:2013.",
                explanation: "ISO 27001 is a widely recognized international standard for Information Security Management Systems (ISMS), primarily focused on IT security. The other options are related to industrial automation or functional safety."
            },
            {
                question: "Which of the following is a widely recognized control system security standard?",
                options: [
                    "COBIT 5.",
                    "ISO/IEC 15408:2009.",
                    "ISA/IEC 62443.",
                    "ISO 27001:2013."
                ],
                answer: "ISA/IEC 62443.",
                explanation: "ISA/IEC 62443 is the definitive series of standards for cybersecurity in industrial automation and control systems. COBIT 5 is an IT governance framework, ISO 15408 is for IT security evaluation, and ISO 27001 is for IT ISMS."
            },
            {
                question: "ISA 62443-2-1 belongs in which tier/group of ISA 99 work products?",
                options: [
                    "Component-level.",
                    "System-level.",
                    "General concepts.",
                    "Policies & Procedures."
                ],
                answer: "Policies & Procedures.",
                explanation: "ISA/IEC 62443-2-1, 'Master Cybersecurity Program for IACS Owners and Operators', falls under the 'Policies & Procedures' group (Part 2-x), focusing on the management system aspects of cybersecurity."
            },
            {
                question: "Which is NOT generally considered a requirement of industrial control systems?",
                options: [
                    "Real-time performance.",
                    "High availability.",
                    "Frequent and immediate software updates.",
                    "Health, Safety, and Environmental (HSE) considerations."
                ],
                answer: "Frequent and immediate software updates.",
                explanation: "While updates are necessary, frequent and immediate patching is often challenging and undesirable in IACS due to the need for high availability, real-time operation, and the risk of disrupting critical processes. Updates are typically planned and carefully managed."
            },
            {
                question: "Which formula correctly represents Risk in cybersecurity?",
                options: [
                    "Risk = Threat x Asset x Consequence.",
                    "Risk = Threat x Vulnerability x Cost.",
                    "Risk = Threat x Likelihood x Vulnerability.",
                    "Risk = Threat x Vulnerability x Consequence."
                ],
                answer: "Risk = Threat x Vulnerability x Consequence.",
                explanation: "In many risk assessment methodologies, including those aligned with IEC 62443, Risk is commonly understood as the combination of Threat, Vulnerability, and Consequence (or Impact)."
            },
            {
                question: "Which of the following would NOT be considered a countermeasure?",
                options: [
                    "Replay (of captured network traffic).",
                    "Access Controls.",
                    "Encryption.",
                    "Intrusion Detection Systems (IDS)."
                ],
                answer: "Replay (of captured network traffic).",
                explanation: "Replay is a type of attack or threat, where an attacker captures and re-sends valid data transmissions to gain unauthorized access or effect. Access Controls, Encryption, and IDS are all countermeasures designed to protect against threats."
            },
            {
                question: "A logical grouping of assets sharing common security requirements is called a(n):",
                options: [
                    "Security Model.",
                    "Asset Model.",
                    "Conduit.",
                    "Zone."
                ],
                answer: "Zone.",
                explanation: "In IEC 62443, a Zone is a logical or physical grouping of assets (people, information, technology) that share common security requirements and are separated from other assets by Conduits."
            },
            {
                question: "Which of the following is Layer 4 in the ISO OSI/Reference Model?",
                options: [
                    "Session Layer.",
                    "Network Layer.",
                    "Transport Layer.",
                    "Data Link Layer."
                ],
                answer: "Transport Layer.",
                explanation: "The Transport Layer (Layer 4) in the OSI model is responsible for end-to-end communication, including segmentation, reassembly, and flow control. TCP and UDP operate at this layer."
            },
            {
                question: "ISA/IEC 62443-2-1 is:",
                options: [
                    "A standard for IACS risk management.",
                    "A guideline for OT security architecture.",
                    "A standard for an IACS security management system (CSMS).",
                    "An IT standard for Information Security Management System (ISMS)."
                ],
                answer: "A standard for an IACS security management system (CSMS).",
                explanation: "ISA/IEC 62443-2-1 is specifically titled 'Master Cybersecurity Program for IACS Owners and Operators' and provides requirements for establishing and maintaining a Cybersecurity Management System (CSMS) for industrial automation and control systems."
            },
            {
                question: "TCP (Transmission Control Protocol) is primarily a ______ protocol.",
                options: [
                    "Connectionless, best-effort.",
                    "Layer 3, routing.",
                    "Connection-oriented, reliable.",
                    "Layer 7, application."
                ],
                answer: "Connection-oriented, reliable.",
                explanation: "TCP is a connection-oriented protocol that establishes a connection before transmitting data and ensures reliable delivery through mechanisms like acknowledgments and retransmissions. It operates at Layer 4 (Transport Layer)."
            },
            {
                question: "What is Microsoft's normal scheduled release day for security patches?",
                options: [
                    "When critical patches become available.",
                    "The first Monday of each month.",
                    "The first Friday of each month.",
                    "The second Tuesday of each month (Patch Tuesday)."
                ],
                answer: "The second Tuesday of each month (Patch Tuesday).",
                explanation: "Microsoft typically releases its security patches and updates on the second Tuesday of each month, a day commonly referred to as 'Patch Tuesday'."
            },
            {
                question: "What is the primary purpose of Windows Server Update Services (WSUS)?",
                options: [
                    "To deploy Hyper-V updates.",
                    "To distribute MSUS to clients.",
                    "To enable administrators to manage and deploy Microsoft updates.",
                    "To distribute Windows Software Unified Server."
                ],
                answer: "To enable administrators to manage and deploy Microsoft updates.",
                explanation: "WSUS allows network administrators to manage and distribute updates released through Microsoft Update to computers in a corporate environment, providing centralized control over patching."
            },
            {
                question: "What is the primary function of a firewall?",
                options: [
                    "To block all internet traffic.",
                    "To detect network intrusions.",
                    "To filter network traffic based on rules.",
                    "To authenticate users."
                ],
                answer: "To filter network traffic based on rules.",
                explanation: "A firewall's primary function is to establish a barrier between a trusted internal network and untrusted external networks (like the internet), controlling incoming and outgoing network traffic based on a set of rules."
            },
            {
                question: "What is the first step in a High-Level Risk Assessment?",
                options: [
                    "Identify specific threats.",
                    "Identify critical assets and consequences.",
                    "Define methodology.",
                    "Analyze threats."
                ],
                answer: "Identify critical assets and consequences.",
                explanation: "Before assessing threats or vulnerabilities, it's crucial to understand what assets are critical to the organization and what the impact would be if those assets were compromised. This sets the scope and priorities for the assessment."
            },
            {
                question: "What is the desired outcome of initiating a CSMS program activity?",
                options: [
                    "Conceptual diagrams of AD forest attacks.",
                    "Obtaining leadership commitment, support, and funding.",
                    "Identifying software agents for attacks.",
                    "Selecting and implementing countermeasures."
                ],
                answer: "Obtaining leadership commitment, support, and funding.",
                explanation: "For any cybersecurity program, especially a comprehensive CSMS, strong leadership commitment, support, and adequate funding are foundational and the desired initial outcome to ensure its success and sustainability."
            },
            {
                question: "Which organization bridges the gap between IEC 62443 standards and their implementation?",
                options: [
                    "NIST.",
                    "IEC.",
                    "ENISA.",
                    "ISA Security Compliance Institute (ISCI)."
                ],
                answer: "ISA Security Compliance Institute (ISCI).",
                explanation: "The ISA Security Compliance Institute (ISCI) is an organization that specifically develops and manages certification programs based on the ISA/IEC 62443 series of standards, bridging the gap between the standards and their real-world implementation and validation."
            },
            {
                question: "System Robustness Testing includes which of the following?",
                options: [
                    "Fuzz testing.",
                    "Network traffic load testing.",
                    "Vulnerability scanning.",
                    "All of the above."
                ],
                answer: "All of the above.",
                explanation: "System robustness testing aims to ensure a system can withstand unexpected or malicious inputs and conditions. Fuzz testing, network load testing, and vulnerability scanning are all methods used to assess different aspects of system robustness."
            },
            {
                question: "What are the three main phases of the ISA/IEC 62443 Cybersecurity Lifecycle?",
                options: [
                    "Assess, Develop and Implement, Maintain.",
                    "Assess, Integrate, Maintain.",
                    "Analyze, Develop and Implement, Maintain.",
                    "Analyze, Integrate, Maintain."
                ],
                answer: "Analyze, Integrate, Maintain.",
                explanation: "The three main phases of the ISA/IEC 62443 Cybersecurity Lifecycle are: Analyze (risk assessment, requirements definition), Integrate (design, implementation, commissioning), and Maintain (operations, monitoring, patch management, continuous improvement)."
            }
        ];

        let questions = []; // Questions for the current mode
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let quizMode = ''; // Will be set by the mode selection screen
        let examQuestions = []; // Subset of questions for the exam mode
        let examTimer;
        let timeLeft = 0; // in seconds
        const EXAM_DURATION_MINUTES = 120; // 2 hours
        const EXAM_QUESTION_COUNT = 50;

        // For practice mode to prevent immediate repetition
        let recentlyAskedQuestions = [];
        const RECENTLY_ASKED_LIMIT = 10; // Number of questions to remember

        // DOM Elements
        const modeSelectionScreen = document.getElementById('mode-selection-screen');
        const quizContainer = document.getElementById('quiz-container');
        const quizEndScreen = document.getElementById('quiz-end-screen');

        const selectPracticeModeBtn = document.getElementById('select-practice-mode-btn');
        const selectExamModeBtn = document.getElementById('select-exam-mode-btn');
        const selectListenModeBtn = document.getElementById('select-listen-mode-btn'); // New listen mode button

        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackMessage = document.getElementById('feedback-message');
        const explanationText = document.getElementById('explanation-text');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentQNumSpan = document.getElementById('current-q-num');
        const totalQNumSpan = document.getElementById('total-q-num');
        const scoreSpan = document.getElementById('score');
        const timerDisplay = document.getElementById('timer-display');
        const abortBtn = document.getElementById('abort-btn');
        const finalScoreSpan = document.getElementById('final-score');
        const finalTotalSpan = document.getElementById('final-total');
        const currentModeDisplay = document.getElementById('current-mode-display');

        /**
         * Shuffles an array in place using the Fisher-Yates (Knuth) algorithm.
         * @param {Array} array The array to shuffle.
         * @returns {Array} The shuffled array.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Initializes the quiz based on the selected mode.
         */
        function initializeQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = null;
            feedbackMessage.textContent = '';
            explanationText.textContent = '';
            feedbackMessage.className = 'feedback-message';
            timerDisplay.classList.add('hidden');
            clearInterval(examTimer); // Cancel any running timer
            window.speechSynthesis.cancel(); // Stop any ongoing speech

            modeSelectionScreen.style.display = 'none';
            quizContainer.style.display = 'flex';
            quizEndScreen.style.display = 'none';

            if (quizMode === 'practice') {
                questions = shuffleArray([...allQuestions]);
                recentlyAskedQuestions = [];
                totalQNumSpan.textContent = "";
                submitBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
                currentModeDisplay.textContent = "You are in: Practice Mode";
                loadQuestion();
            } else if (quizMode === 'exam') {
                examQuestions = shuffleArray([...allQuestions]).slice(0, EXAM_QUESTION_COUNT);
                questions = examQuestions;
                totalQNumSpan.textContent = EXAM_QUESTION_COUNT;
                submitBtn.classList.remove('hidden');
                nextBtn.classList.add('hidden');
                currentModeDisplay.textContent = "You are in: Exam Mode";
                startExamTimer();
                loadQuestion();
            } else if (quizMode === 'listen') {
                questions = shuffleArray([...allQuestions]);
                recentlyAskedQuestions = [];
                totalQNumSpan.textContent = "";
                submitBtn.classList.add('hidden'); // Hide submit
                nextBtn.classList.add('hidden'); // Hide next (auto-advances)
                currentModeDisplay.textContent = "You are in: Listen Mode";
                loadQuestion();
            }
        }

        /**
         * Starts the exam timer.
         */
        function startExamTimer() {
            timeLeft = EXAM_DURATION_MINUTES * 60;
            timerDisplay.classList.remove('hidden');
            updateTimerDisplay();

            examTimer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(examTimer);
                    endQuiz();
                }
            }, 1000);
        }

        /**
         * Updates the timer display.
         */
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `Time Remaining: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        /**
         * Loads the current question and options into the quiz interface.
         */
        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endQuiz();
                return;
            }

            feedbackMessage.textContent = '';
            explanationText.textContent = '';
            feedbackMessage.className = 'feedback-message';
            selectedAnswer = null;
            optionsContainer.innerHTML = '';

            currentQNumSpan.textContent = currentQuestionIndex + 1;
            scoreSpan.textContent = score;

            const currentQuestion = questions[currentQuestionIndex];
            questionText.textContent = currentQuestion.question;

            // Enable radio buttons and submit/next buttons based on mode
            const enableInteraction = quizMode !== 'listen';

            shuffleArray([...currentQuestion.options]).forEach((option, index) => {
                const label = document.createElement('label');
                label.className = 'option-label';
                label.innerHTML = `
                    <input type="radio" name="answer" value="${option}" data-index="${index}" ${enableInteraction ? '' : 'disabled'}>
                    <span>${option}</span>
                `;
                if (enableInteraction) {
                    label.addEventListener('click', () => {
                        document.querySelectorAll('.option-label').forEach(lbl => {
                            lbl.classList.remove('selected-option');
                        });
                        label.classList.add('selected-option');
                        selectedAnswer = option;

                        if (quizMode === 'practice') {
                            checkAnswer();
                        }
                    });
                }
                optionsContainer.appendChild(label);
            });

            if (quizMode === 'practice') {
                submitBtn.disabled = false;
                nextBtn.disabled = true;
            } else if (quizMode === 'exam') {
                submitBtn.disabled = false;
            } else if (quizMode === 'listen') {
                submitBtn.disabled = true;
                nextBtn.disabled = true;
                // In listen mode, automatically reveal answer and speak
                setTimeout(() => {
                    revealAnswerAndSpeak();
                }, 1000); // Small delay before revealing and speaking
            }
        }

        /**
         * Reveals the correct answer and explanation, then triggers speech.
         */
        function revealAnswerAndSpeak() {
            const currentQuestion = questions[currentQuestionIndex];
            const correctAnswer = currentQuestion.answer;
            const explanation = currentQuestion.explanation;

            // Highlight correct option
            document.querySelectorAll('input[name="answer"]').forEach(radio => {
                const parentLabel = radio.closest('.option-label');
                if (radio.value === correctAnswer) {
                    parentLabel.classList.add('correct');
                }
                radio.disabled = true; // Disable all options
            });

            feedbackMessage.textContent = `Correct Answer: ${correctAnswer}`;
            feedbackMessage.className = 'feedback-message correct';
            explanationText.textContent = explanation;

            speakQuestionAndAnswer(currentQuestion);
        }

        /**
         * Uses Web Speech API to read out the question, correct answer, and explanation.
         * @param {object} questionObj The current question object.
         */
        function speakQuestionAndAnswer(questionObj) {
            if (!('speechSynthesis' in window)) {
                feedbackMessage.textContent = "Text-to-speech not supported in this browser.";
                feedbackMessage.className = 'feedback-message incorrect';
                console.error("SpeechSynthesis API not supported.");
                // Fallback to auto-advance if speech not supported
                setTimeout(nextQuestion, 5000); // Auto-advance after a fixed delay
                return;
            }

            const textToSpeak = `Question: ${questionObj.question}. Correct Answer: ${questionObj.answer}. Explanation: ${questionObj.explanation}`;
            const utterance = new SpeechSynthesisUtterance(textToSpeak);

            utterance.lang = 'en-US'; // Set language to English
            utterance.rate = 0.9; // Slightly slower speech for clarity

            utterance.onend = () => {
                console.log("Speech finished, advancing to next question.");
                nextQuestion(); // Automatically advance after speech ends
            };

            utterance.onerror = (event) => {
                console.error('Speech synthesis error:', event.error);
                feedbackMessage.textContent = "Error speaking. Advancing to next question.";
                feedbackMessage.className = 'feedback-message incorrect';
                setTimeout(nextQuestion, 3000); // Auto-advance even on error
            };

            window.speechSynthesis.speak(utterance);
        }


        /**
         * Checks the user's selected answer against the correct answer.
         * Provides feedback and updates the score.
         */
        function checkAnswer() {
            const radioButtons = document.querySelectorAll('input[name="answer"]');
            let userAnswer = null;

            radioButtons.forEach(radio => {
                if (radio.checked) {
                    userAnswer = radio.value;
                }
            });

            if (userAnswer === null) {
                feedbackMessage.textContent = "Please select an answer!";
                feedbackMessage.className = 'feedback-message incorrect';
                explanationText.textContent = '';
                return;
            }

            const currentQuestion = questions[currentQuestionIndex];
            const correctAnswer = currentQuestion.answer;
            const explanation = currentQuestion.explanation;

            submitBtn.disabled = true;
            radioButtons.forEach(radio => radio.disabled = true);

            if (userAnswer === correctAnswer) {
                score++;
                feedbackMessage.textContent = "Correct!";
                feedbackMessage.className = 'feedback-message correct';
                explanationText.textContent = explanation;
            } else {
                feedbackMessage.textContent = `Incorrect. The correct answer was: ${correctAnswer}`;
                feedbackMessage.className = 'feedback-message incorrect';
                explanationText.textContent = explanation;
            }
            scoreSpan.textContent = score;

            radioButtons.forEach(radio => {
                const parentLabel = radio.closest('.option-label');
                if (radio.value === correctAnswer) {
                    parentLabel.classList.add('correct');
                } else if (radio.value === userAnswer && radio.value !== correctAnswer) {
                    parentLabel.classList.add('incorrect');
                }
            });

            if (quizMode === 'practice') {
                nextBtn.disabled = false;
            } else if (quizMode === 'exam') {
                setTimeout(nextQuestion, 1500);
            }
        }

        /**
         * Proceeds to the next question or ends the quiz if all questions have been answered.
         */
        function nextQuestion() {
            if (quizMode === 'practice' || quizMode === 'listen') {
                recentlyAskedQuestions.push(questions[currentQuestionIndex]);
                if (recentlyAskedQuestions.length > RECENTLY_ASKED_LIMIT) {
                    recentlyAskedQuestions.shift();
                }

                let nextQ;
                let attempts = 0;
                do {
                    currentQuestionIndex = Math.floor(Math.random() * allQuestions.length);
                    nextQ = allQuestions[currentQuestionIndex];
                    attempts++;
                } while (recentlyAskedQuestions.includes(nextQ) && attempts < allQuestions.length * 2);

                if (attempts >= allQuestions.length * 2) {
                    questions = shuffleArray([...allQuestions]);
                    recentlyAskedQuestions = [];
                    currentQuestionIndex = 0;
                }
                loadQuestion();

            } else if (quizMode === 'exam') {
                currentQuestionIndex++;
                if (currentQuestionIndex < questions.length) {
                    loadQuestion();
                } else {
                    endQuiz();
                }
            }
        }

        /**
         * Ends the quiz, displays the final score, and resets for restart.
         */
        function endQuiz() {
            clearInterval(examTimer);
            window.speechSynthesis.cancel(); // Stop speech on quiz end
            quizContainer.style.display = 'none';
            quizEndScreen.style.display = 'flex';
            finalScoreSpan.textContent = score;
            finalTotalSpan.textContent = quizMode === 'exam' ? EXAM_QUESTION_COUNT : questions.length;
        }

        /**
         * Resets the quiz to the initial state (mode selection).
         */
        function restartQuiz() {
            console.log("Restarting quiz and returning to mode selection screen.");
            clearInterval(examTimer);
            window.speechSynthesis.cancel(); // Stop speech on restart
            quizEndScreen.style.display = 'none';
            modeSelectionScreen.style.display = 'flex';
            quizContainer.style.display = 'none';
            quizMode = '';
            currentModeDisplay.textContent = "";
            timerDisplay.classList.add('hidden');
        }

        // Event listeners for initial mode selection
        selectPracticeModeBtn.addEventListener('click', () => {
            quizMode = 'practice';
            initializeQuiz();
        });

        selectExamModeBtn.addEventListener('click', () => {
            quizMode = 'exam';
            initializeQuiz();
        });

        selectListenModeBtn.addEventListener('click', () => {
            quizMode = 'listen';
            initializeQuiz();
        });

        // Event listeners for quiz actions
        submitBtn.addEventListener('click', checkAnswer);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', restartQuiz);
        abortBtn.addEventListener('click', restartQuiz);

        // Initial state: show mode selection screen
        window.onload = () => {
            modeSelectionScreen.style.display = 'flex';
            quizContainer.style.display = 'none';
            quizEndScreen.style.display = 'none';

            // Service Worker registration for PWA functionality
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('service-worker.js')
                        .then(registration => {
                            console.log('Service Worker registered:', registration);
                        })
                        .catch(error => {
                            console.error('Service Worker registration failed:', error);
                        });
                });
            }
        };
    </script>
</body>
</html>

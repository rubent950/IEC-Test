<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IEC 62443 Test Ap</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light bluish-gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* Ensures the body takes full viewport height */
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto; /* Prevent overflow if content is too long */
        }
        .quiz-container, .mode-selection-screen, .quiz-end-screen {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 2.5rem; /* More padding */
            max-width: 95%; /* Adapts better to larger screens like S24 Ultra */
            width: 100%;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Space between sections */
            flex-grow: 1; /* Allow container to grow to fill available space */
            overflow-y: auto; /* Add scrolling if content exceeds container */
        }
        /* Specific adjustment for larger screens (tablets/desktops) */
        @media (min-width: 768px) {
            .quiz-container, .mode-selection-screen, .quiz-end-screen {
                max-width: 800px; /* Maintain a max-width for desktops */
            }
        }

        .quiz-container {
            display: none; /* Hidden by default, shown after mode selection */
        }
        .mode-selection-screen {
            display: flex; /* Shown by default */
            align-items: center;
            justify-content: center;
        }
        .question-text {
            font-size: 1.5rem; /* Larger question text */
            font-weight: 600;
            color: #2d3748; /* Darker text for question */
            margin-bottom: 1.5rem;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 1rem; /* Space between options */
            margin-bottom: 1.5rem;
        }
        .option-label {
            display: flex;
            align-items: center;
            background-color: #edf2f7; /* Light gray for options */
            padding: 1rem 1.5rem;
            border-radius: 0.75rem; /* Rounded options */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: 1px solid #cbd5e0; /* Subtle border */
            text-align: left; /* Align option text to the left */
        }
        .option-label:hover {
            background-color: #e2e8f0; /* Slightly darker on hover */
            transform: translateY(-2px); /* Slight lift on hover */
        }
        .option-label input[type="radio"] {
            margin-right: 1rem;
            accent-color: #4A7C4A; /* Green accent for radio button */
        }
        .option-label.correct {
            background-color: #d4edda; /* Light green for correct */
            border-color: #28a745;
        }
        .option-label.incorrect {
            background-color: #f8d7da; /* Light red for incorrect */
            border-color: #dc3545;
        }
        .feedback-message {
            font-size: 1.2rem;
            font-weight: 500;
            margin-top: 1rem;
            min-height: 2rem; /* Reserve space */
        }
        .feedback-message.correct {
            color: #28a745; /* Green for correct */
        }
        .feedback-message.incorrect {
            color: #dc3545; /* Red for incorrect */
        }
        .explanation-text {
            font-size: 1rem;
            color: #4a5568;
            margin-top: 0.5rem;
            text-align: left;
            padding: 0 1rem;
        }
        .action-button {
            background-color: #4A7C4A; /* Green button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .action-button:hover {
            background-color: #3A6C3A; /* Darker green on hover */
            transform: translateY(-1px);
        }
        .action-button:disabled {
            background-color: #a0aec0; /* Gray when disabled */
            cursor: not-allowed;
            box-shadow: none;
        }
        .score-display {
            font-size: 1.1rem;
            font-weight: 500;
            color: #4a5568;
            margin-top: 1rem;
        }
        .quiz-end-screen {
            display: none; /* Hidden by default */
        }
        .mode-selection {
            margin-bottom: 2rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
        }
        .mode-button {
            /* Darker green button for inactive state (now default) */
            background-color: #166534; /* Tailwind green-800 */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Add shadow for consistency */
        }
        .mode-button.active {
            /* Lighter, clearer green for active state */
            background-color: #22c55e; /* Tailwind green-500 */
        }
        .timer-display {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e53e3e; /* Red for timer */
            margin-bottom: 1rem;
        }
        .logo {
            margin-bottom: 1.5rem;
            max-width: 200px; /* Adjust size as needed */
            height: auto;
            border-radius: 0.5rem; /* Slight rounding for the logo */
        }
        .current-mode-display {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4A7C4A; /* Green for the mode display */
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div id="mode-selection-screen" class="mode-selection-screen">
        <div class="text-center">
            <!-- Adjust 'src' here to the correct path on GitHub, e.g., "image_8d4b28.png" or "images/image_8d4b28.png" -->
            <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">IEC 62443 Quiz</h1>
            <p class="text-gray-600 mb-6">Test your knowledge of IEC 62443 standards!</p>
            <p class="text-xl text-gray-700 mb-8">Choose a mode to begin:</p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button id="select-practice-mode-btn" class="action-button">Practice Mode (Infinite)</button>
                <button id="select-exam-mode-btn" class="action-button">Exam Mode (50 Questions, 2 Hours)</button>
            </div>
        </div>
    </div>

    <div id="quiz-container" class="quiz-container">
        <!-- Adjust 'src' here to the correct path on GitHub, e.g., "image_8d4b28.png" or "images/image_8d4b28.png" -->
        <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">IEC 62443 Quiz</h1>
        <p class="text-gray-600 mb-6">Test your knowledge of IEC 62443 standards!</p>

        <!-- Mode selection buttons are now hidden in the quiz container -->
        <div class="mode-selection hidden">
            <button id="practice-mode-btn" class="mode-button">Practice Mode</button>
            <button id="exam-mode-btn" class="mode-button">Exam Mode</button>
        </div>

        <div id="current-mode-display" class="current-mode-display"></div> <!-- New display for current mode -->
        <div id="timer-display" class="timer-display hidden"></div>

        <div class="question-text" id="question-text"></div>
        <div class="options-container" id="options-container">
            <!-- Options are loaded here by JavaScript -->
        </div>

        <div id="feedback-message" class="feedback-message"></div>
        <div id="explanation-text" class="explanation-text"></div>


        <div class="flex flex-col sm:flex-row justify-center gap-4">
            <button id="submit-btn" class="action-button">Submit Answer</button>
            <button id="next-btn" class="action-button" disabled>Next Question</button>
            <button id="abort-btn" class="action-button bg-red-500 hover:bg-red-700">Abort</button> <!-- New abort button -->
        </div>

        <div class="score-display">
            Question <span id="current-q-num">0</span> of <span id="total-q-num">0</span> | Score: <span id="score">0</span>
        </div>
    </div>

    <div id="quiz-end-screen" class="quiz-end-screen">
        <!-- Adjust 'src' here to the correct path on GitHub, e.g., "image_8d4b28.png" or "images/image_8d4b28.png" -->
        <img src="image_8d4b28.png" alt="ISA/IEC 62443 Cybersecurity Fundamentals Specialist Logo" class="logo mx-auto" onerror="this.onerror=null; this.src='https://placehold.co/200x80/4A7C4A/ffffff?text=Logo+Error'; this.alt='Logo not loaded';">
        <h2>Quiz Completed!</h2>
        <p>Your final score is: <span id="final-score" class="font-bold text-green-600 text-2xl"></span> / <span id="final-total" class="font-bold text-green-600 text-2xl"></span></p>
        <button id="restart-btn" class="action-button">Restart Quiz</button>
    </div>

    <script>
        // Array of quiz questions (150 unique questions)
        const allQuestions = [
            // Section 1: Fundamental Concepts (30 questions)
            {
                question: "What is the primary purpose of the IEC 62443 series of standards?",
                options: [
                    "To standardize IT security protocols for offices.",
                    "To provide a structured approach to securing industrial automation and control systems (IACS).",
                    "To develop new industrial control hardware.",
                    "To regulate the production of consumer electronics."
                ],
                answer: "To provide a structured approach to securing industrial automation and control systems (IACS).",
                explanation: "The IEC 62443 series is specifically designed to provide a comprehensive framework for cybersecurity in industrial automation and control systems (IACS), not for general IT or consumer electronics."
            },
            {
                question: "For which industry is the IEC 62443 series specifically designed?",
                options: [
                    "Healthcare IT",
                    "Financial services",
                    "Industrial Automation and Control Systems (IACS)",
                    "Telecommunications"
                ],
                answer: "Industrial Automation and Control Systems (IACS)",
                explanation: "The IEC 62443 standards specifically address the unique security challenges within industrial automation and control systems, such as SCADA, DCS, and PLCs."
            },
            {
                question: "What does IACS stand for in the context of IEC 62443?",
                options: [
                    "International Aviation Control Systems",
                    "Industrial Asset Compliance Software",
                    "Industrial Automation and Control Systems",
                    "Integrated Access Control Solutions"
                ],
                answer: "Industrial Automation and Control Systems",
                explanation: "IACS is the acronym used within the IEC 62443 standards to refer to the systems being governed, such as SCADA, DCS, and PLCs."
            },
            {
                question: "Name the four main parts (or general topics) into which the IEC 62443 series is divided.",
                options: [
                    "Hardware, Software, Network, Data",
                    "General, Policies and Procedures, System Requirements, Component Requirements",
                    "Design, Development, Testing, Implementation",
                    "Risk, Threat, Vulnerability, Control"
                ],
                answer: "General, Policies and Procedures, System Requirements, Component Requirements",
                explanation: "The IEC 62443 series is structured into four main parts: General (1-x), Policies and Procedures (2-x), System Requirements (3-x), and Component Requirements (4-x)."
            },
            {
                question: "What is a Zone in IEC 62443 terminology?",
                options: [
                    "A physical area within a building with a specific temperature.",
                    "A logical or physical grouping of assets sharing common security requirements and communicating.",
                    "A designated area for emergency exits.",
                    "A type of network cabling."
                ],
                answer: "A logical or physical grouping of assets sharing common security requirements and communicating.",
                explanation: "Zones are fundamental to network segmentation in IEC 62443, grouping assets with similar security needs to enable targeted security controls."
            },
            {
                question: "What is a Conduit in IEC 62443 terminology?",
                options: [
                    "A pipe for electrical wiring.",
                    "A logical or physical grouping of communication paths connecting Zones.",
                    "A type of industrial sensor.",
                    "A secure data storage device."
                ],
                answer: "A logical or physical grouping of communication paths connecting Zones.",
                explanation: "Conduits regulate communication between Zones, ensuring that traffic occurs in a controlled and secure manner, often involving firewalls or other security devices."
            },
            {
                question: "What is the concept of 'Defense-in-Depth' in cybersecurity, as applied by IEC 62443?",
                options: [
                    "Relying on a single, very strong security measure.",
                    "Implementing multiple layers of security controls to protect an asset.",
                    "Securing only the outermost perimeter of a network.",
                    "Sharing security responsibilities with external partners."
                ],
                answer: "Implementing multiple layers of security controls to protect an asset.",
                explanation: "Defense-in-Depth involves applying multiple, overlapping security mechanisms so that if one layer fails, other layers still provide protection."
            },
            {
                question: "What is a Security Level (SL) in IEC 62443?",
                options: [
                    "The physical height of a security fence.",
                    "The number of security guards employed.",
                    "The required rigor of security controls to protect against a specific set of attack types.",
                    "The duration for which security logs are kept."
                ],
                answer: "The required rigor of security controls to protect against a specific set of attack types.",
                explanation: "Security Levels (SLs) define the robustness of security controls needed to protect against specific attackers and their capabilities."
            },
            {
                question: "How many Security Levels (SLs) are defined in IEC 62443?",
                options: [
                    "2",
                    "4",
                    "6",
                    "8"
                ],
                answer: "4",
                explanation: "There are four security levels defined in IEC 62443: SL1 (prevention of accidental violation), SL2 (prevention of intentional violation with simple means), SL3 (prevention of intentional violation with moderate means), and SL4 (prevention of intentional violation with extended means)."
            },
            {
                question: "What is the difference between a Target Security Level (SL-T) and an Achieved Security Level (SL-A)?",
                options: [
                    "SL-T is for hardware, SL-A is for software.",
                    "SL-T is the desired level; SL-A is the actually implemented and verified level.",
                    "SL-T is for external threats; SL-A is for internal threats.",
                    "SL-T is measured annually; SL-A is measured monthly."
                ],
                answer: "SL-T is the desired level; SL-A is the actually implemented and verified level.",
                explanation: "SL-T is the security level a system or component should achieve based on the risk assessment, while SL-A is the level that has actually been implemented and verified through testing and audits."
            },
            {
                question: "Which part of IEC 62443-1-x defines the general concepts and models?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-1-2",
                    "IEC 62443-1-3",
                    "IEC 62443-1-4"
                ],
                answer: "IEC 62443-1-1",
                explanation: "IEC 62443-1-1 'Terminology, concepts and models' is the fundamental document that establishes the basic principles and vocabulary for the entire series."
            },
            {
                question: "What is the purpose of the 'Security Lifecycle' in IEC 62443?",
                options: [
                    "To define the lifespan of security hardware.",
                    "To outline the continuous process of managing cybersecurity risks throughout the existence of an IACS.",
                    "To specify the duration of security audits.",
                    "To regulate software development cycles only."
                ],
                answer: "To outline the continuous process of managing cybersecurity risks throughout the existence of an IACS.",
                explanation: "The security lifecycle emphasizes that cybersecurity is a continuous process encompassing all phases of an IACS, from conception to decommissioning."
            },
            {
                question: "In IEC 62443, what does 'IACS' primarily refer to?",
                options: [
                    "Information Access Control Systems",
                    "Industrial Asset Compliance Software",
                    "Industrial Automation and Control Systems",
                    "International Audit and Compliance Standards"
                ],
                answer: "Industrial Automation and Control Systems",
                explanation: "IACS is the central term in the IEC 62443 standards and encompasses all systems used for automating and controlling industrial processes."
            },
            {
                question: "Which of the following is a core principle of the IEC 62443 approach to cybersecurity?",
                options: [
                    "Compliance-driven security",
                    "Technology-first security",
                    "Risk-based security",
                    "Cost minimization security"
                ],
                answer: "Risk-based security",
                explanation: "The IEC 62443 standards are heavily risk-based, meaning that security measures are determined by the identified risks and desired security levels."
            },
            {
                question: "What is the relationship between Zones and Conduits in the IEC 62443 architecture?",
                options: [
                    "Zones are physical locations, Conduits are logical segments.",
                    "Zones are communication paths, Conduits are security policies.",
                    "Zones group assets with common security requirements; Conduits control communication between Zones.",
                    "Zones and Conduits are interchangeable terms."
                ],
                answer: "Zones group assets with common security requirements; Conduits control communication between Zones.",
                explanation: "Zones and Conduits together form the basis for IACS security architecture, with Zones being logical groupings and Conduits being the secured communication paths between them."
            },
            {
                question: "What does SL-0 mean in terms of Security Levels?",
                options: [
                    "Highest security level",
                    "No specific security requirements or countermeasures",
                    "Minimum legally required security level",
                    "Security level only for test environments"
                ],
                answer: "No specific security requirements or countermeasures",
                explanation: "SL-0 means that no specific security controls are implemented or required beyond standard industry practices."
            },
            {
                question: "Which document in the IEC 62443 series provides a glossary of terms?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-1-1",
                    "IEC 62443-4-2"
                ],
                answer: "IEC 62443-1-1",
                explanation: "IEC 62443-1-1 is the introductory part of the series that defines the terminology, concepts, and models used throughout the standard series."
            },
            {
                question: "What is the primary goal of implementing 'Defense-in-Depth' in an IACS?",
                options: [
                    "To reduce the number of security personnel.",
                    "To create multiple layers of security controls to prevent or delay attacks.",
                    "To centralize all security functions into a single system.",
                    "To eliminate the need for regular security audits."
                ],
                answer: "To create multiple layers of security controls to prevent or delay attacks.",
                explanation: "Defense-in-Depth is a strategy that increases a system's resilience against attacks by implementing layered security mechanisms."
            },
            {
                question: "Which of the following best describes a 'Threat' in the IEC 62443 context?",
                options: [
                    "A weakness in a system.",
                    "A potential cause of an unwanted incident.",
                    "A security control mechanism.",
                    "The impact of a security breach."
                ],
                answer: "A potential cause of an unwanted incident.",
                explanation: "A threat is something that can cause harm to a system, such as a malicious actor or a natural disaster, which can exploit a vulnerability."
            },
            {
                question: "What is a 'Vulnerability' in the IEC 62443 context?",
                options: [
                    "A malicious actor.",
                    "A potential cause of an unwanted incident.",
                    "A weakness in a system that can be exploited.",
                    "A security policy document."
                ],
                answer: "A weakness in a system that can be exploited.",
                explanation: "A vulnerability is a weakness in a system, process, or control that can be exploited by a threat to cause harm."
            },
            {
                question: "Which standard part introduces the concept of Security Levels?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-1-1",
                explanation: "The concept of Security Levels (SLs) is first defined in IEC 62443-1-1 as a fundamental concept for specifying the robustness of security controls."
            },
            {
                question: "What is the meaning of the 'Achieved Security Level (SL-A)'?",
                options: [
                    "It is the maximum possible security level.",
                    "It represents the security level that has been implemented and verified.",
                    "It is the desired security level for a system.",
                    "It is only relevant during the design phase."
                ],
                answer: "It represents the security level that has been implemented and verified.",
                explanation: "SL-A is the actually measured and validated security level of a system or component after implementing security measures."
            },
            {
                question: "What is the main difference between IT and OT security?",
                options: [
                    "IT focuses on data confidentiality; OT focuses on availability and safety.",
                    "IT uses firewalls; OT uses antivirus.",
                    "IT is for large organizations; OT is for small businesses.",
                    "There is no significant difference."
                ],
                answer: "IT focuses on data confidentiality; OT focuses on availability and safety.",
                explanation: "IT security often prioritizes confidentiality, while OT security emphasizes the availability of systems and the safety of physical processes, as downtime or disruptions in OT can have direct physical consequences."
            },
            {
                question: "Which of the following is NOT a characteristic of IACS environments that makes them unique for cybersecurity?",
                options: [
                    "Long operational lifespan of equipment.",
                    "Real-time and deterministic operations.",
                    "High tolerance for downtime and data loss.",
                    "Interconnectedness with physical processes."
                ],
                answer: "High tolerance for downtime and data loss.",
                explanation: "IACS environments typically have a *low* tolerance for downtime and data loss, as this can lead to significant operational and safety risks."
            },
            {
                question: "What is the primary purpose of a Cybersecurity Management System (CSMS) in IEC 62443?",
                options: [
                    "To generate compliance reports.",
                    "To provide a framework for continuously managing cybersecurity risks.",
                    "To automate all security tasks.",
                    "To eliminate human error in security operations."
                ],
                answer: "To provide a framework for continuously managing cybersecurity risks.",
                explanation: "A CSMS (Cybersecurity Management System) provides a structured approach to managing cybersecurity risks within an organization, including policies, procedures, and processes."
            },
            {
                question: "What is the role of a 'Security Policy' in the IEC 62443 framework?",
                options: [
                    "A detailed set of instructions for security tasks.",
                    "A high-level statement of an organization's intent and direction regarding security.",
                    "A technical specification for security hardware.",
                    "A list of approved security vendors."
                ],
                answer: "A high-level statement of an organization's intent and direction regarding security.",
                explanation: "A security policy is a high-level document that establishes an organization's overall intentions and guidelines regarding cybersecurity."
            },
            {
                question: "Which part of IEC 62443 addresses security for IACS service providers?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-2-4",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-2-4",
                explanation: "IEC 62443-2-4 'Requirements for IACS service providers' focuses on the security requirements applicable to external parties providing services to IACS."
            },
            {
                question: "What is the concept of 'Trusted Paths' in IACS security?",
                options: [
                    "Physical paths for security personnel.",
                    "Communication channels protected from unauthorized access and manipulation.",
                    "Pre-approved routes for data backup.",
                    "Secure coding guidelines."
                ],
                answer: "Communication channels protected from unauthorized access and manipulation.",
                explanation: "Trusted Paths ensure that critical communication within an IACS cannot be intercepted or altered by unauthorized entities."
            },
            {
                question: "What is the purpose of 'Security Zones' in network segmentation?",
                options: [
                    "To create physical barriers around equipment.",
                    "To group assets with similar security requirements and control traffic between them.",
                    "To define areas for camera surveillance.",
                    "To designate areas for public Wi-Fi access."
                ],
                answer: "To group assets with similar security requirements and control traffic between them.",
                explanation: "Security Zones are a crucial part of network segmentation, limiting the impact of an attack by isolating assets with similar risk profiles."
            },
            {
                question: "What is the role of 'Access Control' in IEC 62443?",
                options: [
                    "To manage physical access to buildings.",
                    "To restrict who can access resources and what actions they can perform.",
                    "To regulate internet browsing.",
                    "To monitor network bandwidth."
                ],
                answer: "To restrict who can access resources and what actions they can perform.",
                explanation: "Access control mechanisms ensure that only authorized users and systems can access specific IACS resources and perform only the actions for which they are authorized."
            },
            // Section 2: Core Standards and Roles (30 questions)
            {
                question: "Which part of IEC 62443 focuses on general concepts and models?",
                options: [
                    "IEC 62443-4-1",
                    "IEC 62443-3-3",
                    "IEC 62443-1-1",
                    "IEC 62443-2-4"
                ],
                answer: "IEC 62443-1-1",
                explanation: "IEC 62443-1-1 is the introductory part that defines the general concepts, terminology, and models that form the basis for the entire standard series."
            },
            {
                question: "Which part of IEC 62443 addresses policies and procedures for IACS security?",
                options: [
                    "IEC 62443-4-2",
                    "IEC 62443-2-1",
                    "IEC 62443-3-2",
                    "IEC 62443-1-2"
                ],
                answer: "IEC 62443-2-1",
                explanation: "IEC 62443-2-1 'Master cybersecurity program for IACS owners and operators' provides guidelines for establishing and managing a CSMS."
            },
            {
                question: "Which part of IEC 62443 addresses system-level security requirements?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-2-3",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-3-3",
                explanation: "IEC 62443-3-3 'System security requirements and security levels' specifies the technical security requirements for IACS at the system level."
            },
            {
                question: "Which part of IEC 62443 focuses on component-level security requirements?",
                options: [
                    "IEC 62443-3-2",
                    "IEC 62443-2-1",
                    "IEC 62443-1-3",
                    "IEC 62443-4-2"
                ],
                answer: "IEC 62443-4-2",
                explanation: "IEC 62443-4-2 'Technical security requirements for IACS components' defines the specific technical security requirements for individual components used in IACS."
            },
            {
                question: "What role does the Asset Owner play in an IEC 62443 cybersecurity program?",
                options: [
                    "Primarily developing secure hardware components.",
                    "Designing and implementing the IACS network architecture.",
                    "Establishing and maintaining the overall IACS cybersecurity management system.",
                    "Conducting external security audits."
                ],
                answer: "Establishing and maintaining the overall IACS cybersecurity management system.",
                explanation: "The Asset Owner is ultimately responsible for the security of the IACS and implementing an effective cybersecurity management system."
            },
            {
                question: "What role does the System Integrator play in an IEC 62443 cybersecurity program?",
                options: [
                    "Producing control system software.",
                    "Designing, implementing, and deploying the IACS, ensuring system security.",
                    "Defining the organization's overarching security policy.",
                    "Performing ethical hacking exercises."
                ],
                answer: "Designing, implementing, and deploying the IACS, ensuring system security.",
                explanation: "The System Integrator is responsible for bringing together various components into a complete IACS and must ensure that the integrated system meets security requirements."
            },
            {
                question: "What role does the Product Supplier (or Component Supplier) play in an IEC 62443 cybersecurity program?",
                options: [
                    "Managing the operational environment of the IACS.",
                    "Developing and supplying IACS components that meet specified security requirements.",
                    "Overseeing incident response for the entire system.",
                    "Performing risk assessments for the end-user."
                ],
                answer: "Developing and supplying IACS components that meet specified security requirements.",
                explanation: "Product suppliers are responsible for securely designing and manufacturing the individual hardware and software components used in IACS."
            },
            {
                question: "What is a Security Program as defined by IEC 62443-2-1?",
                options: [
                    "A single software application for security monitoring.",
                    "A comprehensive set of policies, procedures, and practices for managing IACS cybersecurity risks.",
                    "A daily security briefing for personnel.",
                    "A list of approved security vendors."
                ],
                answer: "A comprehensive set of policies, procedures, and practices for managing IACS cybersecurity risks.",
                explanation: "A security program encompasses the organizational and procedural aspects of cybersecurity management, as laid out in IEC 62443-2-1."
            },
            {
                question: "What is a Security Lifecycle in the context of IEC 62443?",
                options: [
                    "The lifespan of a security product.",
                    "The duration of a security certification.",
                    "The continuous process of managing cybersecurity risks throughout the entire lifespan of an IACS.",
                    "The annual cycle of budget allocation for security."
                ],
                answer: "The continuous process of managing cybersecurity risks throughout the entire lifespan of an IACS.",
                explanation: "The security lifecycle is a holistic concept that ensures security is considered and managed from initial design to decommissioning of an IACS."
            },
            {
                question: "Which of the following is typically NOT a phase of the Security Lifecycle?",
                options: [
                    "Assessment",
                    "Implementation",
                    "Marketing",
                    "Maintenance"
                ],
                answer: "Marketing",
                explanation: "Marketing is not part of the security lifecycle, which focuses on the technical and organizational aspects of cybersecurity, not commercial activities."
            },
            {
                question: "Which IEC 62443 standard provides guidelines for security program requirements for IACS owners?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1",
                    "IEC 62443-1-1"
                ],
                answer: "IEC 62443-2-1",
                explanation: "IEC 62443-2-1 is specifically aimed at the Asset Owner and the requirements for their cybersecurity management system."
            },
            {
                question: "What is the primary focus of IEC 62443-3-2?",
                options: [
                    "Security for IACS service providers.",
                    "Security risk assessment for IACS.",
                    "Technical security requirements for IACS components.",
                    "Patch management procedures."
                ],
                answer: "Security risk assessment for IACS.",
                explanation: "IEC 62443-3-2 'Security risk assessment for IACS' provides a detailed methodology for conducting risk assessments in IACS environments."
            },
            {
                question: "Which IEC 62443 standard focuses on the secure development lifecycle (SDL) for IACS products?",
                options: [
                    "IEC 62443-4-1",
                    "IEC 62443-2-3",
                    "IEC 62443-3-1",
                    "IEC 62443-1-2"
                ],
                answer: "IEC 62443-4-1",
                explanation: "IEC 62443-4-1 'Requirements for secure product development' specifies the processes product suppliers must follow to develop secure IACS components and systems."
            },
            {
                question: "What is the role of a 'System Integrator' in the context of IACS security?",
                options: [
                    "To produce IACS components.",
                    "To define the organization's cybersecurity policy.",
                    "To design, implement, and deploy IACS solutions, ensuring security requirements are met.",
                    "To perform independent security audits."
                ],
                answer: "To design, implement, and deploy IACS solutions, ensuring security requirements are met.",
                explanation: "The System Integrator is a crucial link in the implementation of secured IACS, as they are responsible for integrating diverse components and ensuring overall system security."
            },
            {
                question: "Which part of IEC 62443 addresses security requirements for IACS solutions?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-4-2"
                ],
                answer: "IEC 62443-3-3",
                explanation: "IEC 62443-3-3 defines the technical security requirements for a complete IACS, including the interaction between components."
            },
            {
                question: "What is the purpose of 'Security Procedures' in an IEC 62443 security program?",
                options: [
                    "High-level security objectives.",
                    "Detailed, step-by-step instructions for implementing security policies.",
                    "Legal compliance documents.",
                    "Marketing materials for security products."
                ],
                answer: "Detailed, step-by-step instructions for implementing security policies.",
                explanation: "Security procedures translate abstract security policies into concrete, actionable steps for personnel and systems."
            },
            {
                question: "Which IEC 62443 standard focuses on technical security requirements for control system components?",
                options: [
                    "IEC 62443-3-1",
                    "IEC 62443-4-2",
                    "IEC 62443-2-4",
                    "IEC 62443-1-1"
                ],
                answer: "IEC 62443-4-2",
                explanation: "IEC 62443-4-2 is specifically focused on the technical security requirements applicable to individual hardware and software components that are part of an IACS."
            },
            {
                question: "What is the role of the 'Product Supplier' in ensuring IACS cybersecurity?",
                options: [
                    "To operate and maintain the IACS.",
                    "To develop and supply secure IACS components and systems.",
                    "To perform risk assessments for the asset owner.",
                    "To manage incident response for the entire system."
                ],
                answer: "To develop and supply secure IACS components and systems.",
                explanation: "Product suppliers are the first link in the supply chain and must ensure their products are inherently securely designed and built."
            },
            {
                question: "Which IEC 62443 standard provides metrics for the assessment of security programs?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-2-2",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-2-2",
                explanation: "IEC 62443-2-2 'Metrics for the assessment of security programs' provides guidelines and metrics to evaluate the effectiveness of a CSMS."
            },
            {
                question: "What is the primary target audience for IEC 62443-2-3?",
                options: [
                    "Component manufacturers.",
                    "System integrators.",
                    "Patch management service providers.",
                    "Asset owners."
                ],
                answer: "Patch management service providers.",
                explanation: "IEC 62443-2-3 'Patch management in IACS' specifically addresses the processes and responsibilities for managing patches and updates in industrial environments."
            },
            {
                question: "Which IEC 62443 standard addresses security for IACS maintenance?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-2-4",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-2-4",
                explanation: "IEC 62443-2-4 is focused on the security requirements for external service providers who perform maintenance, installation, or other services on IACS."
            },
            {
                question: "What is the meaning of 'IEC 62443-3-1'?",
                options: [
                    "It defines security levels.",
                    "It provides security technologies for IACS.",
                    "It addresses security for IACS service providers.",
                    "It specifies technical security requirements for control system components."
                ],
                answer: "It provides security technologies for IACS.",
                explanation: "IEC 62443-3-1 'Security technologies for IACS' provides an overview of various security technologies that can be applied in IACS environments."
            },
            {
                question: "Which role is responsible for defining the overall cybersecurity management system (CSMS)?",
                options: [
                    "Product Supplier",
                    "System Integrator",
                    "Asset Owner",
                    "Service Provider"
                ],
                answer: "Asset Owner",
                explanation: "The Asset Owner is the entity that bears ultimate responsibility for the operation and security of the IACS, and thus for the CSMS."
            },
            {
                question: "What is the relationship between IEC 62443-4-1 and IEC 62443-4-2?",
                options: [
                    "4-1 defines product requirements, 4-2 defines system requirements.",
                    "4-1 defines secure development lifecycle, 4-2 defines technical component requirements.",
                    "They are interchangeable standards.",
                    "4-1 is for hardware, 4-2 is for software."
                ],
                answer: "4-1 defines secure development lifecycle, 4-2 defines technical component requirements.",
                explanation: "IEC 62443-4-1 focuses on the processes for securely developing products, while IEC 62443-4-2 specifies the technical security requirements for the components themselves."
            },
            {
                question: "Which IEC 62443 standard specifically addresses patch management in IACS?",
                options: [
                    "IEC 62443-2-1",
                    "IEC 62443-2-3",
                    "IEC 62443-3-3",
                    "IEC 62443-4-2"
                ],
                answer: "IEC 62443-2-3",
                explanation: "IEC 62443-2-3 is entirely dedicated to the complexities and best practices of patch management in the unique environments of IACS."
            },
            {
                question: "What is the primary purpose of IEC 62443-2-4?",
                options: [
                    "To define security levels for IACS.",
                    "To specify security program requirements for IACS service providers.",
                    "To outline methodologies for security risk assessment.",
                    "To provide technical security requirements for components."
                ],
                answer: "To specify security program requirements for IACS service providers.",
                explanation: "This part of the standard is essential for Asset Owners to ensure that external service providers working with their IACS comply with the necessary security standards."
            },
            {
                question: "Which IEC 62443 standard is fundamental for defining system-level security requirements?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-3-3",
                explanation: "IEC 62443-3-3 provides the detailed technical requirements needed to secure an IACS and achieve the desired security levels."
            },
            {
                question: "What is the role of 'Security Assurance Levels' (SALs) in IEC 62443?",
                options: [
                    "To define the cost of security implementation.",
                    "To measure the confidence that security requirements have been met.",
                    "To specify the number of required security audits.",
                    "To determine the speed of incident response."
                ],
                answer: "To measure the confidence that security requirements have been met.",
                explanation: "SALs indicate how confident one can be that a product or system actually meets the stated security requirements, based on the rigor of the evaluation."
            },
            {
                question: "Which IEC 62443 standard provides a framework for managing cybersecurity in IACS?",
                options: [
                    "IEC 62443-1-1",
                    "IEC 62443-2-1",
                    "IEC 62443-3-3",
                    "IEC 62443-4-1"
                ],
                answer: "IEC 62443-2-1",
                explanation: "IEC 62443-2-1 is the core standard for establishing and maintaining a robust cybersecurity management system for IACS."
            },
            {
                question: "What is the primary purpose of IEC 62443-3-1?",
                options: [
                    "To define security levels.",
                    "To address security for IACS service providers.",
                    "To provide security technologies for IACS.",
                    "To specify technical security requirements for control system components."
                ],
                answer: "To provide security technologies for IACS.",
                explanation: "IEC 62443-3-1 provides an overview of the various technologies and methods that can be used to enhance the security of IACS."
            },
            // Section 3: Risk Assessment and Requirements (30 questions)
            {
                question: "What is the fundamental principle behind the IEC 62443 approach to cybersecurity?",
                options: [
                    "Always implement the maximum possible security.",
                    "Outsource all security responsibilities.",
                    "A risk-based approach, where security measures are proportionate to identified risks.",
                    "Relying solely on physical security."
                ],
                answer: "A risk-based approach, where security measures are proportionate to identified risks.",
                explanation: "The risk-based approach of IEC 62443 ensures that resources are deployed efficiently and that security measures are proportionate to the threats and vulnerabilities."
            },
            {
                question: "What are Fundamental Requirements (FRs) in IEC 62443-3-3?",
                options: [
                    "Basic network protocols.",
                    "High-level cybersecurity capabilities that an IACS or component must possess.",
                    "Regulatory documents.",
                    "Hardware specifications for industrial control systems."
                ],
                answer: "High-level cybersecurity capabilities that an IACS or component must possess.",
                explanation: "FRs are the overarching security objectives, such as access control or data confidentiality, which are further elaborated in specific security requirements (SRs)."
            },
            {
                question: "How many Fundamental Requirements (FRs) are there in IEC 62443-3-3?",
                options: [
                    "3",
                    "5",
                    "7",
                    "10"
                ],
                answer: "7",
                explanation: "The seven Fundamental Requirements are: Identification and authentication control, Use control, System integrity, Data confidentiality, Restricted data flow, Timely response to events, and Resource availability."
            },
            {
                question: "Which of the following is NOT one of the Fundamental Requirements (FRs)?",
                options: [
                    "Identification and authentication control",
                    "Data confidentiality",
                    "Social media integration",
                    "Use control"
                ],
                answer: "Social media integration",
                explanation: "Social media integration has no direct relation to the core security capabilities of an IACS as defined by the IEC 62443 standard."
            },
            {
                question: "What is the purpose of a Cybersecurity Risk Assessment in the context of IEC 62443?",
                options: [
                    "To calculate the exact cost of a cyber attack.",
                    "To identify, analyze, and evaluate potential cybersecurity risks for an IACS.",
                    "To train new security personnel.",
                    "To choose a new security vendor."
                ],
                answer: "To identify, analyze, and evaluate potential cybersecurity risks for an IACS.",
                explanation: "A risk assessment is the basis for determining the necessary security measures, by evaluating the likelihood and impact of potential incidents."
            },
            {
                question: "What are the two main factors considered in a risk assessment according to IEC 62443?",
                options: [
                    "Budget and personnel",
                    "Hardware and software",
                    "Likelihood and impact",
                    "Speed and efficiency"
                ],
                answer: "Likelihood and impact",
                explanation: "Risk in IEC 62443 is defined as the combination of the likelihood that a threat will exploit a vulnerability and the impact this has on the system."
            },
            {
                question: "What is threat modeling and why is it important in IEC 62443?",
                options: [
                    "Creating physical models of industrial equipment.",
                    "Identifying potential threats and vulnerabilities from an attacker's perspective to design countermeasures.",
                    "Developing new weather forecasting systems.",
                    "Simulating failures in control systems."
                ],
                answer: "Identifying potential threats and vulnerabilities from an attacker's perspective to design countermeasures.",
                explanation: "Threat modeling helps proactively identify potential attack vectors and design effective defense mechanisms before a system is implemented."
            },
            {
                question: "What is the purpose of a Vulnerability Assessment?",
                options: [
                    "To determine the market value of an asset.",
                    "To identify weaknesses or flaws in an IACS that can be exploited by threats.",
                    "To assess the physical strength of a building.",
                    "To evaluate employee performance."
                ],
                answer: "To identify weaknesses or flaws in an IACS that can be exploited by threats.",
                explanation: "A vulnerability assessment focuses on finding the weak points in a system that an attacker could exploit."
            },
            {
                question: "What is a Security Requirement (SR)?",
                options: [
                    "A general statement about desired security.",
                    "A detailed and verifiable specification of a security control or function.",
                    "A legal document from a government agency.",
                    "A marketing slogan for a security product."
                ],
                answer: "A detailed and verifiable specification of a security control or function.",
                explanation: "SRs are the concrete requirements that must be implemented to achieve the Fundamental Requirements and a specific Security Level."
            },
            {
                question: "How are Security Requirements related to Fundamental Requirements and Security Levels?",
                options: [
                    "SRs are independent of FRs and SLs.",
                    "SRs are derived from FRs, with specific instances determined by the target SL.",
                    "FRs are derived from SRs, and SLs are irrelevant.",
                    "SRs are only applicable to SL0."
                ],
                answer: "SRs are derived from FRs, with specific instances determined by the target SL.",
                explanation: "The Fundamental Requirements (FRs) are the overarching goals, and the Security Requirements (SRs) are the specific implementations needed to achieve those FRs at a given Security Level (SL)."
            },
            {
                question: "What is the primary purpose of IEC 62443-3-2?",
                options: [
                    "To define security levels.",
                    "To provide guidelines for security risk assessment for IACS.",
                    "To specify technical security requirements for components.",
                    "To manage patch implementation."
                ],
                answer: "To provide guidelines for security risk assessment for IACS.",
                explanation: "IEC 62443-3-2 provides a structured approach to conducting risk assessments, which is essential for determining the appropriate security measures."
            },
            {
                question: "What is a 'Security Target' (ST) in the context of IEC 62443?",
                options: [
                    "A specific security product.",
                    "A document that specifies the security objectives and requirements for an IACS.",
                    "A financial goal for security investments.",
                    "A training objective for security personnel."
                ],
                answer: "A document that specifies the security objectives and requirements for an IACS.",
                explanation: "A Security Target (ST) is a formal specification of a system's security needs, including the threats, assumptions, and desired security level."
            },
            {
                question: "What does 'Acceptable Risk' mean in IEC 62443?",
                options: [
                    "Any risk that is not eliminated.",
                    "Risk that remains after controls have been implemented and is deemed acceptable by the organization.",
                    "Risk that is transferred to a third party."
                ],
                answer: "Risk that remains after controls have been implemented and is deemed acceptable by the organization.",
                explanation: "Acceptable risk is the level of risk an organization is willing to tolerate after implementing risk mitigation measures."
            },
            {
                question: "What is the importance of 'Threat Intelligence' in a risk assessment?",
                options: [
                    "It helps predict weather patterns.",
                    "It provides information about current and emerging threats to better assess risks.",
                    "It automates the entire risk assessment process.",
                    "It replaces the need for vulnerability scans."
                ],
                answer: "It provides information about current and emerging threats to better assess risks.",
                explanation: "Threat intelligence is crucial to keep risk assessments relevant and up-to-date, by providing insight into the latest attack techniques and threat actors."
            },
            {
                question: "What is the purpose of 'Security Requirements' (SRs) in IEC 62443-3-3?",
                options: [
                    "To define general security principles.",
                    "To provide detailed, verifiable specifications for system-level security controls.",
                    "To outline organizational security policies.",
                    "To list security vulnerabilities."
                ],
                answer: "To provide detailed, verifiable specifications for system-level security controls.",
                explanation: "SRs are the concrete, measurable requirements that must be implemented to ensure system security and comply with the Fundamental Requirements and Security Levels."
            },
            {
                question: "What is the role of 'Risk Treatment' in the cybersecurity lifecycle?",
                options: [
                    "Identify new risks.",
                    "Analyze the impact of risks.",
                    "Implement measures to modify, accept, avoid, or transfer risks.",
                    "Monitor existing risks."
                ],
                answer: "Implement measures to modify, accept, avoid, or transfer risks.",
                explanation: "Risk treatment involves the decisions and actions taken to manage identified risks, such as implementing controls (modifying), accepting the risk, avoiding the activity causing the risk, or transferring the risk (e.g., through insurance)."
            },
            {
                question: "Which of the following is an example of a 'Technical Security Requirement'?",
                options: [
                    "All employees must undergo security training annually.",
                    "The system must enforce a strong password policy.",
                    "Physical access to the control room must be restricted.",
                    "Incident response plans must be reviewed quarterly."
                ],
                answer: "The system must enforce a strong password policy.",
                explanation: "A strong password policy is a technical control directly enforced within the system to enhance authentication security."
            },
            {
                question: "What is the purpose of 'Security Level Assessment'?",
                options: [
                    "To determine the cost of achieving a security level.",
                    "To evaluate the current security posture against target security levels.",
                    "To define new security levels.",
                    "To train personnel on security levels."
                ],
                answer: "To evaluate the current security posture against target security levels.",
                explanation: "Security Level Assessment compares the achieved security level (SL-A) with the desired target security level (SL-T) to identify any gaps."
            },
            {
                question: "What is the relationship between 'Fundamental Requirements' and 'Security Levels'?",
                options: [
                    "FRs are only applicable to SL-1.",
                    "FRs are high-level capabilities, and SLs define the rigor of their implementation.",
                    "SLs are subsets of FRs.",
                    "They are unrelated concepts."
                ],
                answer: "FRs are high-level capabilities, and SLs define the rigor of their implementation.",
                explanation: "The Fundamental Requirements describe what needs to be achieved (e.g., access control), while the Security Levels indicate how robust that implementation needs to be against different attack types."
            },
            {
                question: "What is the primary output of a cybersecurity risk assessment?",
                options: [
                    "A list of all possible cyber attacks.",
                    "A detailed report of vulnerabilities.",
                    "Identified risks, their likelihood, impact, and recommended mitigation measures.",
                    "A budget proposal for security tools."
                ],
                answer: "Identified risks, their likelihood, impact, and recommended mitigation measures.",
                explanation: "The main goal of a risk assessment is to gain a clear understanding of the risks and to make concrete recommendations for reducing them."
            },
            {
                question: "What is the concept of 'Residual Risk'?",
                options: [
                    "Risk that has been completely eliminated.",
                    "Risk that remains after all security controls have been implemented.",
                    "Risk that is transferred to an insurance company.",
                    "Risk that is ignored by the organization."
                ],
                answer: "Risk that remains after all security controls have been implemented.",
                explanation: "Residual risk is the unavoidable risk that remains even after implementing all reasonable security measures."
            },
            {
                question: "What is the role of 'Security Objectives' in IEC 62443?",
                options: [
                    "Specific technical controls.",
                    "High-level goals for the security of an IACS.",
                    "Metrics for security performance.",
                    "Legal compliance requirements."
                ],
                answer: "High-level goals for the security of an IACS.",
                explanation: "Security objectives are an organization's general intentions regarding the protection of their IACS, which are then translated into specific requirements."
            },
            {
                question: "What is the difference between 'Risk Acceptance' and 'Risk Mitigation'?",
                options: [
                    "Acceptance means ignoring risk; mitigation means eliminating it.",
                    "Acceptance means tolerating risk; mitigation means reducing it.",
                    "Acceptance is for IT; mitigation is for OT.",
                    "There is no difference."
                ],
                answer: "Acceptance means tolerating risk; mitigation means reducing it.",
                explanation: "Risk acceptance is a conscious decision to tolerate a risk without further action, while risk mitigation involves active steps to reduce the likelihood or impact of a risk."
            },
            {
                question: "What is the purpose of 'Security Zones and Conduits' in risk assessment?",
                options: [
                    "To define physical boundaries.",
                    "To facilitate the identification of assets, communication paths, and applicable security requirements.",
                    "To create isolated networks without communication.",
                    "To simplify network addressing schemes."
                ],
                answer: "To facilitate the identification of assets, communication paths, and applicable security requirements.",
                explanation: "Zones and Conduits help structure the risk assessment by dividing the IACS into manageable, logical segments, simplifying the analysis of threats and vulnerabilities."
            },
            {
                question: "What is a 'Security Requirement Level' (SRL)?",
                options: [
                    "The number of security requirements.",
                    "The specific level of rigor required for a security requirement to meet a target SL.",
                    "A general security guideline.",
                    "A measure of compliance."
                ],
                answer: "The specific level of rigor required for a security requirement to meet a target SL.",
                explanation: "An SRL (Security Requirement Level) specifies the depth and robustness of the implementation of an individual security requirement, depending on the desired Security Level."
            },
            {
                question: "What is the importance of 'Contextualization' in risk assessment?",
                options: [
                    "It makes the assessment faster.",
                    "It ensures that risks are evaluated within the specific operational environment of the IACS.",
                    "It enables generic risk assessments.",
                    "It reduces the need for expert input."
                ],
                answer: "It ensures that risks are evaluated within the specific operational environment of the IACS.",
                explanation: "Contextualization is crucial because the risks and effectiveness of controls are highly dependent on the unique operational context, including technology, processes, and personnel."
            },
            {
                question: "What are 'Security Controls'?",
                options: [
                    "Only technical solutions.",
                    "Measures or safeguards that reduce risks.",
                    "Legal regulations for cybersecurity.",
                    "Threat intelligence reports."
                ],
                answer: "Measures or safeguards that reduce risks.",
                explanation: "Security controls are the specific implementations (technical, procedural, or administrative) used to reduce identified risks to an acceptable level."
            },
            {
                question: "What is the role of 'Impact Analysis' in risk assessment?",
                options: [
                    "To determine the cost of implementing security controls.",
                    "To evaluate the potential consequences of a successful attack.",
                    "To identify potential attackers.",
                    "To prioritize security training."
                ],
                answer: "To evaluate the potential consequences of a successful attack.",
                explanation: "Impact analysis quantifies the damage a successful attack can cause (financial, operational, reputational, safety), which is essential for risk prioritization."
            },
            {
                question: "What is 'Risk Prioritization'?",
                options: [
                    "Ignoring low-impact risks.",
                    "Ranking risks based on their likelihood and impact to focus mitigation efforts.",
                    "Delegating all risks to external parties.",
                    "Eliminating all risks immediately."
                ],
                answer: "Ranking risks based on their likelihood and impact to focus mitigation efforts.",
                explanation: "Risk prioritization ensures that the most critical risks are addressed first, allocating resources effectively."
            },
            {
                question: "What is the purpose of 'Security Requirement Specifications'?",
                options: [
                    "To describe general security principles.",
                    "To provide detailed, testable requirements for IACS security.",
                    "To outline the organization's security policy.",
                    "To list security vulnerabilities."
                ],
                answer: "To provide detailed, testable requirements for IACS security.",
                explanation: "Security Requirement Specifications are the blueprint for implementing security controls and must be detailed enough to be tested and verified."
            },
            // Section 4: Implementation and Maintenance (30 questions)
            {
                question: "What is the importance of patch management in an IACS environment?",
                options: [
                    "To improve the aesthetics of control panels.",
                    "To address known vulnerabilities in software and firmware, preventing exploitation.",
                    "To increase network bandwidth.",
                    "To reduce the number of physical connections."
                ],
                answer: "To address known vulnerabilities in software and firmware, preventing exploitation.",
                explanation: "Patch management is crucial to protect systems from known vulnerabilities that can be exploited by attackers, although it can be more complex in IACS environments due to the need for continuous operations."
            },
            {
                question: "Why is segmentation an important security control in IEC 62443?",
                options: [
                    "It reduces the need for electricity.",
                    "It limits the scope of a cyber attack by isolating network zones.",
                    "It simplifies network configuration.",
                    "It speeds up data processing."
                ],
                answer: "It limits the scope of a cyber attack by isolating network zones.",
                explanation: "By segmenting a network into Zones and Conduits, the spread of an attack can be limited, protecting critical systems even if part of the network is compromised."
            },
            {
                question: "What is the purpose of a Demilitarized Zone (DMZ) in an IACS network architecture?",
                options: [
                    "To provide a secure space for storing physical documents.",
                    "To act as a buffer network separating the control network from the enterprise network.",
                    "To host non-critical IT services.",
                    "To store archived operational data."
                ],
                answer: "To act as a buffer network separating the control network from the enterprise network.",
                explanation: "A DMZ (Demilitarized Zone) creates a secure boundary between different levels of trust, such as between the enterprise IT network and the OT control network, to prevent unauthorized access."
            },
            {
                question: "Which of the following is an important consideration for securing remote access to IACS?",
                options: [
                    "Using generic, shared passwords.",
                    "Disabling all logging for remote sessions.",
                    "Strong multi-factor authentication and secure VPNs.",
                    "Allowing unrestricted access for all employees."
                ],
                answer: "Strong multi-factor authentication and secure VPNs.",
                explanation: "Remote access to IACS systems poses a significant risk and requires robust security measures such as MFA and encrypted VPN connections to prevent unauthorized access."
            },
            {
                question: "Why is personnel security an important aspect of IEC 62443?",
                options: [
                    "To ensure employees are physically fit for the job.",
                    "Because human factors are often the weakest link in cybersecurity.",
                    "To manage employee payroll.",
                    "To schedule work shifts."
                ],
                answer: "Because human factors are often the weakest link in cybersecurity.",
                explanation: "Human errors, negligence, or social engineering attacks can lead to serious security incidents, making training and awareness crucial."
            },
            {
                question: "What is the role of logging and monitoring in maintaining IACS security?",
                options: [
                    "To generate reports for management only.",
                    "To detect anomalous behavior and provide forensic data for incident response.",
                    "To store historical operational data for analysis.",
                    "To perform system backups."
                ],
                answer: "To detect anomalous behavior and provide forensic data for incident response.",
                explanation: "Logging and monitoring are essential for timely detection of suspicious activities, analysis of incidents, and compliance with regulatory requirements."
            },
            {
                question: "What is an Incident Response Plan and why is it crucial for IACS?",
                options: [
                    "A plan for employee social events.",
                    "A document describing how to prepare for and respond to cybersecurity incidents, crucial for minimizing impact.",
                    "A marketing strategy for new products.",
                    "A schedule for routine maintenance."
                ],
                answer: "A document describing how to prepare for and respond to cybersecurity incidents, crucial for minimizing impact.",
                explanation: "A well-defined and practiced incident response plan is vital to minimize the impact of a cybersecurity incident on IACS operations and safety."
            },
            {
                question: "What is the significance of the secure development lifecycle (SDL) for IACS components and systems?",
                options: [
                    "It focuses solely on aesthetic design.",
                    "It integrates security considerations from the very beginning of the design and development process.",
                    "It dictates component pricing.",
                    "It is only relevant for non-critical systems."
                ],
                answer: "It integrates security considerations from the very beginning of the design and development process.",
                explanation: "SDL (Secure Development Lifecycle) ensures that security is proactively built in, which is significantly cheaper and more effective than adding security measures afterward."
            },
            {
                question: "What is the difference between a security policy and a security procedure?",
                options: [
                    "Policy is for IT, procedure is for OT.",
                    "Policy is high-level intent; procedure is detailed, step-by-step implementation instruction.",
                    "Policy is internal; procedure is external.",
                    "Policy is mandatory; procedure is optional."
                ],
                answer: "Policy is high-level intent; procedure is detailed, step-by-step implementation instruction.",
                explanation: "A policy is a statement of what needs to be achieved, while a procedure describes how those goals should be achieved step-by-step."
            },
            {
                question: "How does physical security relate to cybersecurity in IEC 62443?",
                options: [
                    "It is completely separate and unrelated.",
                    "Unauthorized physical access can lead to direct compromise of cybersecurity.",
                    "Physical security is only for office buildings, not for IACS.",
                    "It only concerns fire safety."
                ],
                answer: "Unauthorized physical access can lead to direct compromise of cybersecurity.",
                explanation: "Physical security is a fundamental layer of Defense-in-Depth. If an attacker gains physical access, many cybersecurity controls can be bypassed."
            },
            {
                question: "What is the purpose of a 'Cybersecurity Audit' in IACS?",
                options: [
                    "To train new employees.",
                    "To assess the effectiveness of implemented security controls and compliance with policies.",
                    "To determine market trends.",
                    "To manage financial data."
                ],
                answer: "To assess the effectiveness of implemented security controls and compliance with policies.",
                explanation: "Audits are essential to verify that security measures are correctly implemented and effective, and to meet regulatory requirements."
            },
            {
                question: "Why is 'Configuration Management' important for IACS security?",
                options: [
                    "It helps track employee attendance.",
                    "It ensures that systems are implemented and maintained in a secure, consistent state.",
                    "It is only for software development.",
                    "It reduces the need for documentation."
                ],
                answer: "It ensures that systems are implemented and maintained in a secure, consistent state.",
                explanation: "Configuration management prevents 'configuration drift' and ensures that systems remain consistent and secure throughout their lifespan, which is essential for IACS integrity."
            },
            {
                question: "What is the role of 'Backup and Recovery' in IACS cybersecurity?",
                options: [
                    "To store non-critical data.",
                    "To ensure operational continuity and data integrity in case of a cyber incident or system failure.",
                    "To make copies of physical documents.",
                    "To manage software licenses."
                ],
                answer: "To ensure operational continuity and data integrity in case of a cyber incident or system failure.",
                explanation: "Backup and recovery are crucial measures for availability and resilience, allowing systems to be quickly restored after an attack or failure."
            },
            {
                question: "What is the purpose of 'Security Awareness Training' for IACS personnel?",
                options: [
                    "To teach programming skills.",
                    "To inform personnel about cybersecurity risks and their role in maintaining security.",
                    "To improve physical fitness.",
                    "To manage shift schedules."
                ],
                answer: "To inform personnel about cybersecurity risks and and their role in maintaining security.",
                explanation: "Personnel are often the first line of defense; awareness training helps them recognize risks and follow best practices."
            },
            {
                question: "Why is 'Network Monitoring' crucial in an IACS environment?",
                options: [
                    "To track internet usage.",
                    "To detect anomalous traffic patterns or malicious activities that may indicate a cyber attack.",
                    "To optimize network speed for office IT.",
                    "To manage network hardware inventory."
                ],
                answer: "To detect anomalous traffic patterns or malicious activities that may indicate a cyber attack.",
                explanation: "Continuous network monitoring is essential for early detection of threats and anomalous behavior that may indicate a compromise of the IACS."
            },
            {
                question: "What is the primary purpose of 'Vulnerability Management'?",
                options: [
                    "Ignoring known weaknesses.",
                    "To identify, assess, and remediate security vulnerabilities in systems and components.",
                    "To create new vulnerabilities for testing.",
                    "To outsource security tasks."
                ],
                answer: "To identify, assess, and remediate security vulnerabilities in systems and components.",
                explanation: "Vulnerability management is a continuous process of finding, analyzing, and mitigating weaknesses before they can be exploited by attackers."
            },
            {
                question: "What is 'Secure Disposal' of IACS assets?",
                options: [
                    "Selling old equipment.",
                    "Ensuring sensitive data is securely erased from decommissioned or replaced assets.",
                    "Recycling industrial waste.",
                    "Donating old equipment to charity."
                ],
                answer: "Ensuring sensitive data is securely erased from decommissioned or replaced assets.",
                explanation: "Secure disposal prevents sensitive operational data or configuration information from falling into the wrong hands when equipment is decommissioned or reused."
            },
            {
                question: "Why is 'Change Management' important in IACS security?",
                options: [
                    "To prevent all changes to the system.",
                    "To ensure that all changes to the IACS are controlled, documented, and reviewed for security impact.",
                    "To speed up system updates.",
                    "To reduce the need for testing."
                ],
                answer: "To ensure that all changes to the IACS are controlled, documented, and reviewed for security impact.",
                explanation: "Change management is essential to prevent and control unauthorized or unintended changes that could undermine security."
            },
            {
                question: "What is the role of 'Security Patches' in IACS maintenance?",
                options: [
                    "To improve system performance.",
                    "To fix known security vulnerabilities and bugs in software and firmware.",
                    "To add new features to the system.",
                    "To change the user interface."
                ],
                answer: "To fix known security vulnerabilities and bugs in software and firmware.",
                explanation: "Security patches are updates released to close specific security loopholes, making systems less vulnerable to attacks."
            },
            {
                question: "What is 'Continuous Improvement' in an IACS cybersecurity program?",
                options: [
                    "Implementing new technologies every year.",
                    "Regularly reviewing and updating security controls and processes to adapt to evolving threats.",
                    "Increasing the annual security budget.",
                    "Automating all security tasks."
                ],
                answer: "Regularly reviewing and updating security controls and processes to adapt to evolving threats.",
                explanation: "The threat landscape is constantly changing, so an effective security program must be dynamic and continuously adapted to remain relevant."
            },
            {
                question: "What is the purpose of 'Physical Security Controls' in an IACS environment?",
                options: [
                    "To monitor employee productivity.",
                    "To prevent unauthorized physical access to critical IACS equipment and areas.",
                    "To regulate building temperature.",
                    "To manage visitor logs."
                ],
                answer: "To prevent unauthorized physical access to critical IACS equipment and areas.",
                explanation: "Physical security, such as locks, surveillance, and access controls, is an essential first line of defense to prevent tampering or theft of IACS equipment."
            },
            {
                question: "Why is 'Secure Remote Access' a crucial aspect of IACS security?",
                options: [
                    "To allow anyone to access the system from any location.",
                    "To allow authorized personnel to securely access the IACS from outside the control network.",
                    "To reduce the need for on-site personnel.",
                    "To simplify network configuration."
                ],
                answer: "To allow authorized personnel to securely access the IACS from outside the control network.",
                explanation: "Secure remote access is necessary for maintenance and management but must be strictly controlled to prevent it from becoming an attack vector."
            },
            {
                question: "What is the role of 'Security Event Logging'?",
                options: [
                    "To record all operational data.",
                    "To record security-relevant events for monitoring, auditing, and forensic analysis.",
                    "To store system performance data.",
                    "To store user login credentials."
                ],
                answer: "To record security-relevant events for monitoring, auditing, and forensic analysis.",
                explanation: "Security event logs are vital for detecting suspicious activities, investigating incidents, and demonstrating compliance."
            },
            {
                question: "What is 'Incident Response Testing'?",
                options: [
                    "Testing new security products.",
                    "Periodically simulating cyber incidents to evaluate the effectiveness of the incident response plan.",
                    "Testing network connectivity.",
                    "Testing system backups."
                ],
                answer: "Periodically simulating cyber incidents to evaluate the effectiveness of the incident response plan.",
                explanation: "Regularly testing the incident response plan ensures that the team is prepared and that the plan is effective in a real emergency."
            },
            {
                question: "Why is 'Least Privilege' an important principle in IACS access control?",
                options: [
                    "To grant all users full administrative rights.",
                    "To restrict users and processes to only the minimum access rights necessary to perform their tasks.",
                    "To simplify user management.",
                    "To reduce the number of security policies."
                ],
                answer: "To restrict users and processes to only the minimum access rights necessary to perform their tasks.",
                explanation: "The principle of least privilege minimizes potential damage if an account or system is compromised, by limiting the scope of access."
            },
            {
                question: "What is the purpose of 'Intrusion Detection Systems (IDS)' in IACS?",
                options: [
                    "To prevent all cyber attacks.",
                    "To monitor network traffic and system activities for suspicious patterns or known attack signatures.",
                    "To manage network devices.",
                    "To optimize data flow."
                ],
                answer: "To monitor network traffic and system activities for suspicious patterns or known attack signatures.",
                explanation: "IDS (Intrusion Detection Systems) are designed to detect and alert on suspicious or malicious activities, allowing for a rapid response to potential threats."
            },
            {
                question: "What is the role of 'Asset Inventory' in IACS security?",
                options: [
                    "To track financial assets.",
                    "To maintain an accurate and up-to-date list of all hardware and software components within an IACS.",
                    "To manage spare parts.",
                    "To track employee assets."
                ],
                answer: "To maintain an accurate and up-to-date list of all hardware and software components within an IACS.",
                explanation: "A complete and up-to-date inventory of all assets is fundamental for risk assessment, vulnerability management, and incident response, as you cannot secure what you do not know."
            },
            {
                question: "What is 'Secure Configuration'?",
                options: [
                    "Using default settings for all systems.",
                    "Securing systems by disabling unnecessary services, closing unused ports, and applying security best practices.",
                    "Encrypting all data on a system.",
                    "Installing antivirus software."
                ],
                answer: "Securing systems by disabling unnecessary services, closing unused ports, and applying security best practices.",
                explanation: "Secure configuration (or 'hardening') reduces a system's attack surface by removing unnecessary functionality and optimizing security settings."
            },
            {
                question: "What is the importance of 'Vendor Management' in IACS security?",
                options: [
                    "To select the cheapest vendors.",
                    "To ensure that external vendors and their products comply with the organization's security requirements.",
                    "To manage vendor contracts.",
                    "To outsource all security responsibilities to vendors."
                ],
                answer: "To ensure that external vendors and their products comply with the organization's security requirements.",
                explanation: "The supply chain is a significant risk. Vendor management ensures that third-party security practices align with the organization's own security objectives."
            },
            {
                question: "What is 'Security Maintenance' in the IACS lifecycle?",
                options: [
                    "Only repairing broken hardware.",
                    "Ongoing activities such as patching, vulnerability scanning, and reviewing security controls to maintain the security posture.",
                    "Developing new security features.",
                    "Only performing annual security audits."
                ],
                answer: "Ongoing activities such as patching, vulnerability scanning, and reviewing security controls to maintain the security posture.",
                explanation: "Security maintenance is a continuous process to ensure that security controls remain effective and adapt to new threats and vulnerabilities."
            },
            // Section 5: Advanced Concepts and Certification (30 questions)
            {
                question: "What is the concept of 'Security by Design'?",
                options: [
                    "Adding security features after the product is completed.",
                    "Building security into the product or system from the initial design phase.",
                    "Delegating all security tasks to a third party.",
                    "Using off-the-shelf security products without customization."
                ],
                answer: "Building security into the product or system from the initial design phase.",
                explanation: "Security by Design is a proactive approach where security considerations are integrated from the beginning of the development lifecycle, rather than being added afterwards."
            },
            {
                question: "What is the role of security testing in the IEC 62443 lifecycle?",
                options: [
                    "To confirm aesthetic design choices.",
                    "To verify that implemented controls are effective and meet the required security levels.",
                    "To determine market demand for a product.",
                    "To train new sales personnel."
                ],
                answer: "To verify that implemented controls are effective and meet the required security levels.",
                explanation: "Security testing, such as penetration testing and vulnerability scanning, is essential to validate the effectiveness of security controls and identify any weaknesses."
            },
            {
                question: "What is a 'Security Target' (ST) document?",
                options: [
                    "A list of security training attendees.",
                    "A marketing plan for a new security product.",
                    "A detailed specification of security objectives, threats, and required security functions for an IACS.",
                    "A historical record of past security incidents."
                ],
                answer: "A detailed specification of security objectives, threats, and required security functions for an IACS.",
                explanation: "The Security Target is a formal document that describes the security needs of a system and serves as a basis for the development and evaluation of security functions."
            },
            {
                question: "What is a Security Assurance Level (SAL)?",
                options: [
                    "The amount of money allocated to security.",
                    "A measure of confidence that security requirements have been met and that the system is as secure as claimed.",
                    "The speed of data encryption.",
                    "The number of security certifications an individual holds."
                ],
                answer: "A measure of confidence that security requirements have been met and that the system is as secure as claimed.",
                explanation: "SALs (Security Assurance Levels) indicate the degree of confidence one can have in the security claims of a product or system, based on the thoroughness of the evaluation."
            },
            {
                question: "How does IEC 62443 address supply chain security?",
                options: [
                    "By ignoring it, as it falls outside the scope.",
                    "By requiring product suppliers to implement secure development lifecycles and evaluating supplier security practices.",
                    "By mandating specific logistics service providers.",
                    "By focusing only on the final implementation phase."
                ],
                answer: "By requiring product suppliers to implement secure development lifecycles and evaluating supplier security practices.",
                explanation: "IEC 62443 recognizes the importance of the supply chain and imposes responsibilities on suppliers to deliver secure products and manage their own security practices."
            },
            {
                question: "What are the benefits of achieving IEC 62443 certification?",
                options: [
                    "Only a slight increase in market value.",
                    "Demonstrating compliance, increasing trust, reducing risks, and improving cybersecurity posture.",
                    "Eliminating the need for further security measures.",
                    "Guaranteeing zero cyber attacks."
                ],
                answer: "Demonstrating compliance, increasing trust, reducing risks, and improving cybersecurity posture.",
                explanation: "Certification provides independent validation of security practices and products, which increases customer and partner trust and improves overall security posture."
            },
            {
                question: "How does IEC 62443 relate to other cybersecurity frameworks like NIST CSF?",
                options: [
                    "They are completely incompatible and cannot be used together.",
                    "IEC 62443 is a sector-specific standard for IACS, often complementary to general frameworks like NIST CSF.",
                    "IEC 62443 replaces all other cybersecurity frameworks.",
                    "They address entirely different types of threats."
                ],
                answer: "IEC 62443 is a sector-specific standard for IACS, often complementary to general frameworks like NIST CSF.",
                explanation: "Although IEC 62443 is specific to IACS, it shares many principles with general cybersecurity frameworks and can often be used in conjunction with them to create a comprehensive security strategy."
            },
            {
                question: "What is one of the main challenges in implementing IEC 62443 in existing 'brownfield' IACS environments?",
                options: [
                    "Too much available budget.",
                    "Lack of compatibility with older equipment and potential operational disruption risks when patching without downtime.",
                    "Abundance of detailed documentation.",
                    "Too many qualified cybersecurity experts available."
                ],
                answer: "Lack of compatibility with older equipment and potential operational disruption risks when patching without downtime.",
                explanation: "Brownfield environments (existing systems) present unique challenges due to outdated technologies, limited compatibility, and the high costs and risks of downtime for updates."
            },
            {
                question: "What is the importance of continuous improvement in an IEC 62443 security program?",
                options: [
                    "It is only done once every ten years.",
                    "It is unnecessary if the initial implementation was perfect.",
                    "The threat landscape is constantly evolving, requiring regular reviews, updates, and adaptation of security controls.",
                    "It is primarily for external audit purposes only."
                ],
                answer: "The threat landscape is constantly evolving, requiring regular reviews, updates, and adaptation of security controls.",
                explanation: "Cybersecurity is not a one-time task. Continuous improvement ensures that the security program remains relevant and effective against new and evolving threats."
            },
            {
                question: "What is the ultimate goal of implementing the IEC 62443 series of standards?",
                options: [
                    "To increase the complexity of industrial systems.",
                    "To eliminate all human interaction with IACS.",
                    "To reduce the risk of cybersecurity incidents in IACS, protect critical infrastructure, and ensure operational continuity.",
                    "To focus solely on IT network security."
                ],
                answer: "To reduce the risk of cybersecurity incidents in IACS, protect critical infrastructure, and ensure operational continuity.",
                explanation: "The overarching goal of IEC 62443 is to create resilient and secure IACS environments that can withstand cyber attacks and ensure the safety and continuity of industrial processes."
            },
            {
                question: "What is the purpose of 'Security Validation' in the IEC 62443 lifecycle?",
                options: [
                    "To confirm marketing claims.",
                    "To ensure that the implemented security measures meet the specified requirements and are effective.",
                    "To validate financial investments in security.",
                    "To validate employee training records."
                ],
                answer: "To ensure that the implemented security measures meet the specified requirements and are effective.",
                explanation: "Validation is the process of confirming that the system or product meets the originally defined security requirements and fulfills its intended security functions."
            },
            {
                question: "What is 'Certification' in the context of IEC 62443?",
                options: [
                    "A mandatory legal requirement for all IACS.",
                    "A formal process to confirm that a product, system, or process complies with specified IEC 62443 standards.",
                    "An internal audit conducted by the asset owner.",
                    "A marketing strategy for security vendors."
                ],
                answer: "A formal process to confirm that a product, system, or process complies with specified IEC 62443 standards.",
                explanation: "Certification by an independent third party provides a high degree of assurance that a product or system complies with the security requirements of IEC 62443."
            },
            {
                question: "What is the role of 'Threat Modeling' in the secure development lifecycle (SDL)?",
                options: [
                    "To create visual models of the system.",
                    "To identify potential threats and vulnerabilities early in the design phase.",
                    "To simulate system performance.",
                    "To automatically generate code."
                ],
                answer: "To identify potential threats and vulnerabilities early in the design phase.",
                explanation: "Threat modeling in the SDL helps developers understand security risks and design mitigation measures before code is written, which is more cost-effective."
            },
            {
                question: "What is the primary benefit of 'IEC 62443 compliance' for organizations?",
                options: [
                    "Reduced operational costs.",
                    "Improved cybersecurity posture and reduced risk of incidents.",
                    "Increased system performance.",
                    "Elimination of all security audits."
                ],
                answer: "Improved cybersecurity posture and reduced risk of incidents.",
                explanation: "Compliance with IEC 62443 helps organizations implement a robust security strategy, significantly reducing the likelihood and impact of successful cyber attacks."
            },
            {
                question: "What is 'Security Assessment' in the context of IEC 62443?",
                options: [
                    "A one-time activity at the start of a project.",
                    "A systematic examination of an IACS's security posture to identify weaknesses and risks.",
                    "A process for acquiring new security tools.",
                    "A method for training security personnel."
                ],
                answer: "A systematic examination of an IACS's security posture to identify weaknesses and risks.",
                explanation: "Security assessments are periodic evaluations to measure the effectiveness of implemented security controls and identify new risks."
            },
            {
                question: "How does 'Risk Management' relate to IEC 62443?",
                options: [
                    "It is an optional activity.",
                    "It is a core, continuous process integrated throughout the entire IEC 62443 lifecycle to identify, assess, and treat risks.",
                    "It is only performed during incident response.",
                    "It focuses solely on financial risks."
                ],
                answer: "It is a core, continuous process integrated throughout the entire IEC 62443 lifecycle to identify, assess, and treat risks.",
                explanation: "Risk management is the common thread throughout the entire IEC 62443 standard, with all security activities guided by an understanding of the risks."
            },
            {
                question: "What is the concept of 'Defense-in-Depth' in relation to security architecture?",
                options: [
                    "Relying on a single strong perimeter defense.",
                    "Implementing multiple, overlapping security controls to protect assets.",
                    "Distributing security responsibilities across multiple teams.",
                    "Focusing only on software security."
                ],
                answer: "Implementing multiple, overlapping security controls to protect assets.",
                explanation: "Defense-in-Depth is an architectural principle that enhances a system's resilience by creating multiple layers of defense, so that a breach in one layer does not directly lead to a complete compromise."
            },
            {
                question: "What is the importance of 'Security Metrics' in an IEC 62443 program?",
                options: [
                    "They are only used for external reporting.",
                    "They provide measurable indicators of the effectiveness of security controls and the overall security posture.",
                    "They define the cost of security incidents.",
                    "They are used to track employee performance."
                ],
                answer: "They provide measurable indicators of the effectiveness of security controls and the overall security posture.",
                explanation: "Metrics are essential for monitoring the performance of the security program, identifying trends, and supporting decisions about security investments."
            },
            {
                question: "What is 'Supply Chain Risk Management' in IEC 62443?",
                options: [
                    "Managing logistics for product delivery.",
                    "Assessing and mitigating cybersecurity risks associated with third-party products and services.",
                    "Minimizing procurement costs.",
                    "Ensuring timely delivery of components."
                ],
                answer: "Assessing and mitigating cybersecurity risks associated with third-party products and services.",
                explanation: "Supply Chain Risk Management focuses on controlling the security risks arising from reliance on external suppliers and their products or services."
            },
            {
                question: "What is the role of 'Security Requirements' in the design phase?",
                options: [
                    "They are only considered during testing.",
                    "They guide the design and implementation of security controls to meet target security levels.",
                    "They are used for marketing purposes.",
                    "They define the project budget."
                ],
                answer: "They guide the design and implementation of security controls to meet target security levels.",
                explanation: "Security requirements are the specifications that the design team must follow to ensure that the system is built securely from the ground up and meets the desired Security Levels."
            },
            {
                question: "What is 'Security by Default'?",
                options: [
                    "Leaving all default settings as they are.",
                    "Configuring systems and products with the most secure settings out-of-the-box.",
                    "Using only open-source security tools.",
                    "Relying on users to configure their own security."
                ],
                answer: "Configuring systems and products with the most secure settings out-of-the-box.",
                explanation: "Security by Default means that products and systems are delivered with the highest security settings by default, reducing the chance of vulnerabilities due to misconfiguration."
            },
            {
                question: "What is the purpose of 'Penetration Testing' in IACS security?",
                options: [
                    "To assess physical security controls.",
                    "To simulate realistic attacks to identify vulnerabilities and test the effectiveness of defenses.",
                    "To train new security analysts.",
                    "To passively monitor network traffic."
                ],
                answer: "To simulate realistic attacks to identify vulnerabilities and test the effectiveness of defenses.",
                explanation: "Penetration testing (pentesting) is a proactive method to test a system's robustness by performing controlled, simulated attacks to discover weaknesses."
            },
            {
                question: "What is the meaning of 'IEC 62443-4-1'?",
                options: [
                    "It defines security levels.",
                    "It specifies the requirements for the secure product development lifecycle.",
                    "It outlines methodologies for security risk assessment.",
                    "It provides technical security requirements for components."
                ],
                answer: "It specifies the requirements for the secure product development lifecycle.",
                explanation: "IEC 62443-4-1 focuses on the processes and best practices that product suppliers must follow to develop secure IACS components and systems."
            },
            {
                question: "What is 'Security Hardening'?",
                options: [
                    "Making security policies stricter.",
                    "Reducing a system's attack surface by eliminating unnecessary functions, services, and ports.",
                    "Encrypting all data on a system.",
                    "Installing antivirus software."
                ],
                answer: "Reducing a system's attack surface by eliminating unnecessary functions, services, and ports.",
                explanation: "Security Hardening is the process of securing a system by configuring it to have as few vulnerabilities as possible, often by disabling unnecessary functionality."
            },
            {
                question: "What is the role of 'Governance' in an IEC 62443 cybersecurity program?",
                options: [
                    "It only concerns legal compliance.",
                    "It establishes the framework for determining cybersecurity objectives, making decisions, and assigning responsibilities.",
                    "It focuses solely on technical implementation.",
                    "It is managed by external auditors."
                ],
                answer: "It establishes the framework for determining cybersecurity objectives, making decisions, and assigning responsibilities.",
                explanation: "Governance ensures that cybersecurity is an integral part of the business strategy and that clear responsibilities are in place at all levels of the organization."
            },
            {
                question: "What is the benefit of using 'Standardized Security Controls'?",
                options: [
                    "They are always free.",
                    "They provide a common basis for security and facilitate interoperability and compliance.",
                    "They eliminate the need for customization.",
                    "They only apply to IT systems."
                ],
                answer: "They provide a common basis for security and facilitate interoperability and compliance.",
                explanation: "Standardized controls promote consistency, reduce complexity, and make it easier to comply with regulations and best practices."
            },
            {
                question: "What is 'Continuous Monitoring' in cybersecurity?",
                options: [
                    "Monitoring systems only during office hours.",
                    "Ongoing surveillance to ensure security controls are effective and to detect new threats or vulnerabilities.",
                    "A one-time security assessment.",
                    "Monitoring only physical access points."
                ],
                answer: "Ongoing surveillance to ensure security controls are effective and to detect new threats or vulnerabilities.",
                explanation: "Continuous monitoring is essential to respond quickly to evolving threats and to ensure the effectiveness of security measures in real-time."
            },
            {
                question: "What is the primary purpose of 'Security Architecture Design' in IACS?",
                options: [
                    "To create visually appealing network diagrams.",
                    "To define the structure and relationships of security components to achieve security objectives.",
                    "To specify hard requirements.",
                    "To manage software licenses."
                ],
                answer: "To define the structure and relationships of security components to achieve security objectives.",
                explanation: "A good security architecture design is the foundation for a robust and resilient IACS, with security built in from the start."
            },
            {
                question: "What is the role of 'Security Documentation' in IEC 62443?",
                options: [
                    "It is optional and rarely used.",
                    "It provides a clear record of security policies, procedures, designs, and assessments for audit and operational purposes.",
                    "It is only for legal compliance.",
                    "It replaces the need for security training."
                ],
                answer: "It provides a clear record of security policies, procedures, designs, and assessments for audit and operational purposes.",
                explanation: "Documentation is crucial for maintaining consistency, training personnel, conducting audits, and demonstrating compliance."
            },
            {
                question: "What is 'Security Lifecycle Management'?",
                options: [
                    "Managing the lifespan of security products.",
                    "A holistic approach to integrating security throughout the entire lifecycle of an IACS, from design to decommissioning.",
                    "Only managing security incidents.",
                    "Only focusing on the operational phase of security."
                ],
                answer: "A holistic approach to integrating security throughout the entire lifecycle of an IACS, from design to decommissioning.",
                explanation: "Lifecycle management ensures that security is not just an initial consideration, but a continuous process that spans the entire lifespan of the IACS."
            },
            // General/Mixed Topics (30 questions)
            {
                question: "Which of the following is a major challenge in securing older IACS environments?",
                options: [
                    "Too many available security updates.",
                    "Lack of vendor support, outdated operating systems, and difficulty patching without downtime.",
                    "Excessive documentation.",
                    "Too many qualified cybersecurity experts."
                ],
                answer: "Lack of vendor support, outdated operating systems, and difficulty patching without downtime.",
                explanation: "Older (brownfield) IACS environments often suffer from outdated hardware and software for which updates are no longer available, making them vulnerable."
            },
            {
                question: "What is the 'Purdue Enterprise Reference Architecture' often used for in IACS security?",
                options: [
                    "To design office networks.",
                    "To provide a hierarchical model for industrial control systems, supporting network segmentation.",
                    "To manage supply chain logistics.",
                    "To develop new industrial protocols."
                ],
                answer: "To provide a hierarchical model for industrial control systems, supporting network segmentation.",
                explanation: "The Purdue architecture provides a standardized reference model for the different levels of an IACS, which helps in designing effective network segmentation and zone and conduit strategies."
            },
            {
                question: "What is the difference between 'Authentication' and 'Authorization'?",
                options: [
                    "Authentication is for users, authorization is for systems.",
                    "Authentication verifies identity; authorization grants permissions.",
                    "They are interchangeable terms.",
                    "Authentication is for IT, authorization is for OT."
                ],
                answer: "Authentication verifies identity; authorization grants permissions.",
                explanation: "Authentication confirms 'who you are,' while authorization determines 'what you are allowed to do' after your identity has been verified."
            },
            {
                question: "What is the concept of 'Network Segregation'?",
                options: [
                    "Connecting all devices to a single network.",
                    "Dividing a network into smaller, isolated segments to limit the spread of attacks.",
                    "Using only wireless connections.",
                    "Increasing network bandwidth."
                ],
                answer: "Dividing a network into smaller, isolated segments to limit the spread of attacks.",
                explanation: "Network segregation is a fundamental security measure that limits the impact of an attack by isolating critical systems from less critical or more exposed parts of the network."
            },
            {
                question: "What is 'Industrial Demilitarized Zone (IDMZ)'?",
                options: [
                    "A zone for physical security.",
                    "A buffer zone between the enterprise IT network and the operational technology (OT) network.",
                    "A zone for public internet access.",
                    "A zone for data archiving."
                ],
                answer: "A buffer zone between the enterprise IT network and the operational technology (OT) network.",
                explanation: "The IDMZ is a crucial element in IACS network architecture, similar to a traditional DMZ, but specifically designed to enable secure communication between IT and OT networks while protecting the OT environment."
            },
            {
                question: "What is the importance of 'Least Functionality' in IACS security?",
                options: [
                    "To limit system capabilities to save costs.",
                    "To configure systems to provide only the essential functions, thereby reducing the attack surface.",
                    "To ensure maximum system performance.",
                    "To allow all functions by default."
                ],
                answer: "To configure systems to provide only the essential functions, thereby reducing the attack surface.",
                explanation: "By enabling only strictly necessary functionality, the number of potential vulnerabilities and attack vectors is significantly reduced."
            },
            {
                question: "What is 'Cyber-Physical System (CPS) Security'?",
                options: [
                    "Security only for physical buildings.",
                    "Security that addresses the convergence of IT and OT, focusing on the interaction between cyber and physical components.",
                    "Security for cloud-based systems.",
                    "Security only for traditional IT networks."
                ],
                answer: "Security that addresses the convergence of IT and OT, focusing on the interaction between cyber and physical components.",
                explanation: "CPS security recognizes that attacks in the cyber world can have direct physical consequences in industrial environments, and focuses on protecting these integrated systems."
            },
            {
                question: "What is the role of 'Secure Communication Protocols' in IACS?",
                options: [
                    "To speed up data transfer.",
                    "To protect data integrity and confidentiality during transfer between IACS components.",
                    "To allow unencrypted communication.",
                    "To simplify network configuration."
                ],
                answer: "To protect data integrity and confidentiality during transfer between IACS components.",
                explanation: "The use of secure protocols, such as encrypted communication, is essential to prevent eavesdropping, tampering, and replay attacks."
            },
            {
                question: "What is 'Asset Identification' in cybersecurity?",
                options: [
                    "Identifying financial assets.",
                    "The process of discovering and documenting all hardware and software assets within an environment.",
                    "Identifying security personnel.",
                    "Identifying potential attackers."
                ],
                answer: "The process of discovering and documenting all hardware and software assets within an environment.",
                explanation: "An accurate and up-to-date asset inventory is the foundation for any security strategy, as you can only secure what you know and understand."
            },
            {
                question: "What is 'Network Intrusion Detection System (NIDS)'?",
                options: [
                    "A system that prevents all network attacks.",
                    "A system that monitors network traffic for suspicious activities or policy violations.",
                    "A system that manages network devices.",
                    "A system that optimizes network performance."
                ],
                answer: "A system that monitors network traffic for suspicious activities or policy violations.",
                explanation: "NIDS (Network Intrusion Detection Systems) analyze network traffic to detect and alert on intrusion attempts, malicious activities, or policy violations."
            },
            {
                question: "What is 'Endpoint Security' in an IACS context?",
                options: [
                    "Security for network routers.",
                    "Security measures applied to individual devices (endpoints) such as HMI workstations, PLCs, and servers.",
                    "Security for cloud endpoints.",
                    "Security only for external network connections."
                ],
                answer: "Security measures applied to individual devices (endpoints) such as HMI workstations, PLCs, and servers.",
                explanation: "Endpoint Security focuses on securing the individual devices within the IACS, which are often vulnerable to direct attacks."
            },
            {
                question: "What is the purpose of 'Whitelisting' in application control?",
                options: [
                    "To allow all applications to run.",
                    "To allow only explicitly approved applications to execute, blocking all others.",
                    "To block known malicious applications.",
                    "To monitor application usage."
                ],
                answer: "To allow only explicitly approved applications to execute, blocking all others.",
                explanation: "Whitelisting is a very effective security measure, especially in IACS, as it only allows known and approved software to run, preventing malware execution."
            },
            {
                question: "What is 'Secure Boot'?",
                options: [
                    "A method for faster system startup.",
                    "A security standard that ensures only trusted software can load during a device's boot process.",
                    "A secure way to shut down a system.",
                    "A method for remote system access."
                ],
                answer: "A security standard that ensures only trusted software can load during a device's boot process.",
                explanation: "Secure Boot prevents malicious or unauthorized software from being loaded during the boot process, ensuring system integrity from the start."
            },
            {
                question: "What is the role of 'Digital Certificates' in IACS security?",
                options: [
                    "To prove physical ownership of devices.",
                    "To establish trust and verify the identity of devices, users, or applications in secure communication.",
                    "To track software licenses.",
                    "To manage system configurations."
                ],
                answer: "To establish trust and verify the identity of devices, users, or applications in secure communication.",
                explanation: "Digital certificates are used for authentication, encryption, and ensuring the integrity of communication in IACS, similar to their use in IT systems."
            },
            {
                question: "What is 'Security Information and Event Management (SIEM)'?",
                options: [
                    "A tool for physical security monitoring.",
                    "A system for collecting, analyzing, and reporting security-related data from various sources.",
                    "A system for managing security policies.",
                    "A system for automating security tasks."
                ],
                answer: "A system for collecting, analyzing, and reporting security-related data from various sources.",
                explanation: "A SIEM system centralizes log data and security events, allowing analysts to quickly detect and respond to threats."
            },
            {
                question: "What is the 'Human Factor' in cybersecurity?",
                options: [
                    "The number of security personnel.",
                    "The role of human behavior, errors, and social engineering in security incidents.",
                    "The physical strength of security guards.",
                    "The cost of human resources in security."
                ],
                answer: "The role of human behavior, errors, and social engineering in security incidents.",
                explanation: "The human factor is often the weakest link in the security chain, highlighting the importance of awareness training and strong processes."
            },
            {
                question: "What is 'Cybersecurity Resilience'?",
                options: [
                    "The ability to prevent all cyber attacks.",
                    "The ability of an organization to anticipate, withstand, recover from, and adapt to adverse cybersecurity events.",
                    "The speed of incident response.",
                    "The number of security tools implemented."
                ],
                answer: "The ability of an organization to anticipate, withstand, recover from, and adapt to adverse cybersecurity events.",
                explanation: "Cybersecurity resilience goes beyond just prevention; it includes the ability to survive and recover from attacks, which is crucial for IACS."
            },
            {
                question: "What is 'Threat Hunting'?",
                options: [
                    "Waiting for security alerts to trigger.",
                    "Proactively searching for cyber threats that remain undetected by existing security solutions.",
                    "Analyzing historical threat data.",
                    "Developing new security tools."
                ],
                answer: "Proactively searching for cyber threats that remain undetected by existing security solutions.",
                explanation: "Threat hunting is a proactive security activity where security analysts actively search for indicators of compromise that may not have been detected by automated systems."
            },
            {
                question: "What is the purpose of 'Security Baselines'?",
                options: [
                    "To define minimum security requirements for systems and networks.",
                    "To track changes in security policy.",
                    "To measure employee performance.",
                    "To establish security budgets."
                ],
                answer: "To define minimum security requirements for systems and networks.",
                explanation: "Security baselines are the minimum security configurations and settings that must be applied to systems to ensure a baseline level of security."
            },
            {
                question: "What is 'Industrial Control System (ICS) Security'?",
                options: [
                    "Security for office IT systems.",
                    "A subset of OT security specifically focused on control systems used in industrial processes.",
                    "Security for consumer electronics.",
                    "Security for financial transactions."
                ],
                answer: "A subset of OT security specifically focused on control systems used in industrial processes.",
                explanation: "ICS security is a specialized area within OT security, focusing on the unique challenges and risks of industrial control systems."
            },
            {
                question: "What is 'Network Access Control (NAC)' in IACS?",
                options: [
                    "Controlling physical access to network devices.",
                    "Restricting network access based on user identity, device compliance, and security posture.",
                    "Managing network bandwidth.",
                    "Monitoring network traffic for performance."
                ],
                answer: "Restricting network access based on user identity, device compliance, and security posture.",
                explanation: "NAC (Network Access Control) ensures that only authorized and compliant devices and users gain access to the IACS network, which is crucial for maintaining network segmentation and security."
            },
            {
                question: "What is 'Data Integrity' in cybersecurity?",
                options: [
                    "Ensuring data remains secret.",
                    "Ensuring data is accurate, complete, and has not been modified without authorization.",
                    "Ensuring data is always available.",
                    "Ensuring data is stored efficiently."
                ],
                answer: "Ensuring data is accurate, complete, and has not been modified without authorization.",
                explanation: "Data integrity is one of the three pillars of cybersecurity (CIA triad) and ensures that data is trustworthy and unaltered."
            },
            {
                question: "What is 'Data Confidentiality'?",
                options: [
                    "Ensuring data is always available.",
                    "Ensuring data is accurate and complete.",
                    "Ensuring data is accessible only to authorized individuals.",
                    "Ensuring data can be easily recovered."
                ],
                answer: "Ensuring data is accessible only to authorized individuals.",
                explanation: "Data confidentiality is one of the three pillars of cybersecurity (CIA triad) and focuses on protecting sensitive information from unauthorized disclosure."
            },
            {
                question: "What is 'Data Availability'?",
                options: [
                    "Ensuring data remains secret.",
                    "Ensuring data is accurate and complete.",
                    "Ensuring data is accessible only to authorized individuals.",
                    "Ensuring data is accessible and usable when needed by authorized entities."
                ],
                answer: "Ensuring data is accessible and usable when needed by authorized entities.",
                explanation: "Data availability is one of the three pillars of cybersecurity (CIA triad) and is critically important in IACS, where continuous operations are essential."
            },
            {
                question: "What is the 'CIA Triad' in cybersecurity?",
                options: [
                    "Cost, Impact, Availability.",
                    "Confidentiality, Integrity, Availability.",
                    "Control, Incident, Audit.",
                    "Compliance, Implementation, Assessment."
                ],
                answer: "Confidentiality, Integrity, Availability.",
                explanation: "The CIA triad is a fundamental model in cybersecurity representing the three main goals of information security: Confidentiality, Integrity, and Availability."
            },
            {
                question: "What is 'Cybersecurity Governance'?",
                options: [
                    "Managing daily security operations.",
                    "The framework of policies, processes, and responsibilities to direct and control an organization's cybersecurity efforts.",
                    "Implementing technical security controls.",
                    "Performing security audits."
                ],
                answer: "The framework of policies, processes, and responsibilities to direct and control an organization's cybersecurity efforts.",
                explanation: "Cybersecurity governance ensures that cybersecurity is an integral part of the business strategy and that clear responsibilities are in place at all levels of the organization."
            },
            {
                question: "What is 'Security Awareness'?",
                options: [
                    "Knowledge of security tools.",
                    "Understanding of cybersecurity risks and best practices by all personnel.",
                    "Awareness only of physical security.",
                    "Awareness only of IT systems."
                ],
                answer: "Understanding of cybersecurity risks and best practices by all personnel.",
                explanation: "Security awareness is essential to reduce human error and foster a culture of security within the organization."
            },
            {
                question: "What is 'Vulnerability Scanning'?",
                options: [
                    "Manually checking for security flaws.",
                    "Using automated tools to identify known vulnerabilities in systems and applications.",
                    "Performing penetration testing.",
                    "Analyzing security logs."
                ],
                answer: "Using automated tools to identify known vulnerabilities in systems and applications.",
                explanation: "Vulnerability scanning is an automated process to quickly and efficiently identify known security flaws in systems and and networks."
            },
            {
                question: "What is 'Security Incident Response'?",
                options: [
                    "Preventing all security incidents.",
                    "The process of detecting, analyzing, containing, eradicating, and recovering from cybersecurity incidents.",
                    "Reporting security incidents to management.",
                    "Performing security audits."
                ],
                answer: "The process of detecting, analyzing, containing, eradicating, and recovering from cybersecurity incidents.",
                explanation: "Incident response is the organized approach to effectively react to security incidents, minimize impact, and restore normal operations."
            },
            {
                question: "What is 'Threat Modeling' in the context of system design?",
                options: [
                    "Creating physical models of threats.",
                    "A structured approach to identify potential threats, vulnerabilities, and countermeasures for a system.",
                    "Analyzing historical threat data.",
                    "Predicting future cyber attacks."
                ],
                answer: "A structured approach to identify potential threats, vulnerabilities, and countermeasures for a system.",
                explanation: "Threat modeling is a systematic method to identify and analyze security risks in a system from the perspective of a potential attacker, and to design appropriate security controls."
            }
        ];

        let questions = []; // Questions for the current mode
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let quizMode = ''; // Set by the mode selection screen
        let examQuestions = []; // Subset of questions for exam mode
        let examTimer;
        let timeLeft = 0; // in seconds
        const EXAM_DURATION_MINUTES = 120; // 2 hours
        const EXAM_QUESTION_COUNT = 50;

        // For practice mode to prevent immediate repetition
        let recentlyAskedQuestions = [];
        const RECENTLY_ASKED_LIMIT = 10; // Number of questions to remember

        // DOM Elements
        const modeSelectionScreen = document.getElementById('mode-selection-screen');
        const quizContainer = document.getElementById('quiz-container');
        const quizEndScreen = document.getElementById('quiz-end-screen');

        const selectPracticeModeBtn = document.getElementById('select-practice-mode-btn');
        const selectExamModeBtn = document.getElementById('select-exam-mode-btn');

        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackMessage = document.getElementById('feedback-message');
        const explanationText = document.getElementById('explanation-text'); // New element for explanation
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentQNumSpan = document.getElementById('current-q-num');
        const totalQNumSpan = document.getElementById('total-q-num');
        const scoreSpan = document.getElementById('score');
        const timerDisplay = document.getElementById('timer-display');
        const abortBtn = document.getElementById('abort-btn'); // New abort button
        const finalScoreSpan = document.getElementById('final-score'); // Added
        const finalTotalSpan = document.getElementById('final-total'); // Added
        const currentModeDisplay = document.getElementById('current-mode-display'); // New element
        const restartBtn = document.getElementById('restart-btn'); // Ensure this is also defined


        /**
         * Shuffles an array in place using the Fisher-Yates (Knuth) algorithm.
         * @param {Array} array The array to shuffle.
         * @returns {Array} The shuffled array.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Initializes the quiz based on the selected mode.
         */
        function initializeQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = null;
            feedbackMessage.textContent = '';
            explanationText.textContent = ''; // Clear explanation
            feedbackMessage.className = 'feedback-message'; // Reset classes
            timerDisplay.classList.add('hidden');
            clearInterval(examTimer); // Cancel any running timer

            // Hide mode selection screen and show quiz container
            modeSelectionScreen.style.display = 'none';
            quizContainer.style.display = 'flex';
            quizEndScreen.style.display = 'none'; // Ensure end screen is hidden

            // Update active mode display and buttons
            if (quizMode === 'practice') {
                questions = shuffleArray([...allQuestions]); // Start with a new shuffled set
                recentlyAskedQuestions = [];
                totalQNumSpan.textContent = ""; // Infinite number of questions
                submitBtn.classList.add('hidden'); // Hide submit button in practice mode
                nextBtn.classList.remove('hidden'); // Ensure next button is visible
                currentModeDisplay.textContent = "You are in: Practice Mode";
                loadQuestion();
            } else if (quizMode === 'exam') {
                // Select 50 unique questions for the exam
                examQuestions = shuffleArray([...allQuestions]).slice(0, EXAM_QUESTION_COUNT);
                questions = examQuestions; // Set questions for exam mode
                totalQNumSpan.textContent = EXAM_QUESTION_COUNT;
                submitBtn.classList.remove('hidden'); // Show submit button in exam mode
                nextBtn.classList.add('hidden'); // Hide next button in exam mode (automatic progression)
                currentModeDisplay.textContent = "You are in: Exam Mode";
                startExamTimer();
                loadQuestion();
            }
        }

        /**
         * Starts the exam timer.
         */
        function startExamTimer() {
            timeLeft = EXAM_DURATION_MINUTES * 60; // Convert minutes to seconds
            timerDisplay.classList.remove('hidden');
            updateTimerDisplay();

            examTimer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(examTimer);
                    endQuiz();
                }
            }, 1000);
        }

        /**
         * Updates the timer display.
         */
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `Time Remaining: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        /**
         * Loads the current question and options into the quiz interface.
         */
        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endQuiz();
                return;
            }

            // Reset feedback and enable buttons for new question
            feedbackMessage.textContent = '';
            explanationText.textContent = ''; // Clear explanation on new question
            feedbackMessage.className = 'feedback-message'; // Reset classes
            selectedAnswer = null;

            // Clear previous options
            optionsContainer.innerHTML = '';

            // Update question progress
            currentQNumSpan.textContent = currentQuestionIndex + 1;
            scoreSpan.textContent = score;

            // Get the current question object
            const currentQuestion = questions[currentQuestionIndex];
            questionText.textContent = currentQuestion.question;

            // Create radio buttons for each option
            shuffleArray([...currentQuestion.options]).forEach((option, index) => { // Also shuffle options
                const label = document.createElement('label');
                label.className = 'option-label';
                label.innerHTML = `
                    <input type="radio" name="answer" value="${option}" data-index="${index}">
                    <span>${option}</span>
                `;
                label.addEventListener('click', () => {
                    // Remove highlight from previously selected option
                    document.querySelectorAll('.option-label').forEach(lbl => {
                        lbl.classList.remove('selected-option');
                    });
                    // Add highlight to the currently selected option
                    label.classList.add('selected-option');
                    selectedAnswer = option;

                    // Auto-submit in practice mode
                    if (quizMode === 'practice') {
                        checkAnswer();
                    }
                });
                optionsContainer.appendChild(label);
            });

            if (quizMode === 'practice') {
                submitBtn.disabled = false; // Ensure submit button is enabled for practice mode
                nextBtn.disabled = true; // Disable until answer is submitted
            } else if (quizMode === 'exam') {
                submitBtn.disabled = false; // Ensure submit button is enabled for exam mode
            }
        }

        /**
         * Checks the user's selected answer against the correct answer.
         * Provides feedback and updates the score.
         */
        function checkAnswer() {
            const radioButtons = document.querySelectorAll('input[name="answer"]');
            let userAnswer = null;

            radioButtons.forEach(radio => {
                if (radio.checked) {
                    userAnswer = radio.value;
                }
            });

            if (userAnswer === null) {
                feedbackMessage.textContent = "Please select an answer!";
                feedbackMessage.className = 'feedback-message incorrect';
                explanationText.textContent = ''; // No explanation if no answer
                return;
            }

            const currentQuestion = questions[currentQuestionIndex];
            const correctAnswer = currentQuestion.answer;
            const explanation = currentQuestion.explanation;

            // Disable buttons and radios after submitting the answer
            submitBtn.disabled = true; // Disable the submit button
            radioButtons.forEach(radio => radio.disabled = true); // Disable all radio buttons

            if (userAnswer === correctAnswer) {
                score++;
                feedbackMessage.textContent = "Correct!";
                feedbackMessage.className = 'feedback-message correct';
                explanationText.textContent = explanation; // Show explanation
            } else {
                feedbackMessage.textContent = `Incorrect. The correct answer was: ${correctAnswer}`;
                feedbackMessage.className = 'feedback-message incorrect';
                explanationText.textContent = explanation; // Show explanation
            }
            scoreSpan.textContent = score;

            // Highlight correct/incorrect options
            radioButtons.forEach(radio => {
                const parentLabel = radio.closest('.option-label');
                if (radio.value === correctAnswer) {
                    parentLabel.classList.add('correct');
                } else if (radio.value === userAnswer && radio.value !== correctAnswer) { // Highlight the incorrectly chosen option
                    parentLabel.classList.add('incorrect');
                }
            });


            if (quizMode === 'practice') {
                nextBtn.disabled = false; // Enable next button in practice mode
            } else if (quizMode === 'exam') {
                // In exam mode, automatically proceed to the next question after a short delay
                setTimeout(nextQuestion, 1500); // Give user some time to see feedback
            }
        }

        /**
         * Proceeds to the next question or ends the quiz if all questions have been answered.
         */
        function nextQuestion() {
            if (quizMode === 'practice') {
                // Add current question to recently asked questions
                recentlyAskedQuestions.push(questions[currentQuestionIndex]);
                if (recentlyAskedQuestions.length > RECENTLY_ASKED_LIMIT) {
                    recentlyAskedQuestions.shift(); // Remove the oldest
                }

                // Find a new question that hasn't been asked recently
                let nextQ;
                let attempts = 0;
                do {
                    currentQuestionIndex = Math.floor(Math.random() * allQuestions.length);
                    nextQ = allQuestions[currentQuestionIndex];
                    attempts++;
                } while (recentlyAskedQuestions.includes(nextQ) && attempts < allQuestions.length * 2); // Prevent infinite loop if all are recent

                // If we've cycled through most questions, reshuffle the entire pool
                if (attempts >= allQuestions.length * 2) { // Arbitrary threshold for reshuffling
                    questions = shuffleArray([...allQuestions]);
                    recentlyAskedQuestions = []; // Reset recent history
                    currentQuestionIndex = 0; // Start from the beginning of the new shuffled list
                }
                loadQuestion();

            } else if (quizMode === 'exam') {
                currentQuestionIndex++;
                if (currentQuestionIndex < questions.length) {
                    loadQuestion();
                } else {
                    endQuiz();
                }
            }
        }

        /**
         * Ends the quiz, displays the final score, and resets for restart.
         */
        function endQuiz() {
            clearInterval(examTimer);
            quizContainer.style.display = 'none';
            quizEndScreen.style.display = 'flex';
            finalScoreSpan.textContent = score;
            finalTotalSpan.textContent = quizMode === 'exam' ? EXAM_QUESTION_COUNT : questions.length; // Show total for exam
        }

        /**
         * Resets the quiz to the initial state (mode selection).
         */
        function restartQuiz() {
            console.log("Restarting quiz and returning to mode selection screen."); // Log for debugging
            clearInterval(examTimer); // Ensure the timer is stopped
            quizEndScreen.style.display = 'none';
            modeSelectionScreen.style.display = 'flex'; // Go back to mode selection
            quizContainer.style.display = 'none';
            quizMode = ''; // Clear quiz mode
            currentModeDisplay.textContent = ""; // Clear the mode display
            timerDisplay.classList.add('hidden'); // Hide the timer display
        }

        // Event listeners for initial mode selection
        selectPracticeModeBtn.addEventListener('click', () => {
            quizMode = 'practice';
            initializeQuiz();
        });

        selectExamModeBtn.addEventListener('click', () => {
            quizMode = 'exam';
            initializeQuiz();
        });

        // Event listeners for quiz actions
        submitBtn.addEventListener('click', checkAnswer);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', restartQuiz);
        abortBtn.addEventListener('click', restartQuiz); // Abort button also goes to mode selection

        // Initial state: show mode selection screen
        window.onload = () => {
            modeSelectionScreen.style.display = 'flex';
            quizContainer.style.display = 'none';
            quizEndScreen.style.display = 'none';

            // Service Worker registration for PWA functionality
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('service-worker.js')
                        .then(registration => {
                            console.log('Service Worker registered:', registration);
                        })
                        .catch(error => {
                            console.error('Service Worker registration failed:', error);
                        });
                });
            }
        };
    </script>
</body>
</html>
